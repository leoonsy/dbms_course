function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,t){"object"==("undefined"==typeof module?"undefined":_typeof(module))&&module.exports?module.exports=e.document?t(e):t:e.Fancy=t(e)}("undefined"!=typeof window?window:this,function(win){var _Fancy$Element$protot,Fancy={global:window,version:"1.7.85",site:"fancygrid.com",COLORS:["#9DB160","#B26668","#4091BA","#8E658E","#3B8D8B","#ff0066","#eeaaee","#55BF3B","#DF5353","#7798BF","#aaeeee"]},LU,MU,NU,lU,nU,oU,NT,PT,QT,aT,IO,JO,KO,LO,MO,NO,OO,PO,QO,RO,ON,PN,QN,RN,SN,TN,tH,uH,vH,wH,xH,yH,zH,AH,BH,CH,DH,EH,FH,GH,HH,IH,JH,KH,LH,EG,FG,GG,HG,IG,JG,KG,LG,XF,YF,ZF,$F,_F,aG,bG,cG,PE,QE,RE,SE,TE,UE,VE,WE,XE,RB,SB,TB,UB,VB,WB,XB,YB,ty,uy,vy,wy,xy,yy,zy,Ay,By,Cy,Dy,Ey,Fy,Gy,Hy,Iy,Jy,Ky,Ly,fx,gx,hx,ix,jx,kx,lx,mx,nx,Rw,Sw,wv,xv,yv,zv,Av,Bv,Cv,Dv,Ev,Fv,Gv,Hv,Iv,Jv,Kv,Lv,Mv,Nv,Ov,Pv,eu,fu,gu,hu,iu,Tr,Ur,Vr,Wr,Xr,Yr,Zr,$r,_r,as,bs,cs,tf,uf,rd,sd,ud,Qa,Ea,Fa,Ha,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba;return window.Fancy=Fancy,Fancy.apply=function(e,t){if(void 0!==t)for(var n in t)e[n]=t[n]},Fancy.applyIf=function(e,t){for(var n in t)void 0===e[n]&&(e[n]=t[n])},Fancy.namespace=function(){for(var e=0,t=arguments.length;e<t;e++){var n=arguments[e].split("."),i=1,a=n.length;Fancy.global[n[0]]=Fancy.global[n[0]]||{};for(var o=Fancy.global[n[0]];i<a;i++)o[n[i]]=o[n[i]]||{},o=o[n[i]]}},Fancy.ns=Fancy.namespace,Fancy.typeOf=function(e){if(null===e)return"null";var t=_typeof(e);if("undefined"===t||"string"===t||"number"===t||"boolean"===t)return t;var n=Object.prototype.toString.call(e);if(void 0!==e.length&&"function"!=typeof e)return"array";switch(n){case"[object Array]":return"array";case"[object Date]":return"date";case"[object Boolean]":return"boolean";case"[object Number]":return"number";case"[object RegExp]":return"regexp"}return"function"===t?"function":"object"===t?"object":void 0},Fancy.isArray="isArray"in Array?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},Fancy.isObject=function(e){return"[object Object]"===Object.prototype.toString.call(e)},Fancy.isFunction=function(e){return"[object Function]"===Object.prototype.toString.apply(e)},Fancy.isString=function(e){return"string"==typeof e},Fancy.isNumber=function(e){return"number"==typeof e&&isFinite(e)},Fancy.isDom=function(t){try{return t instanceof HTMLElement}catch(e){return"object"==_typeof(t)&&1===t.nodeType&&"object"==_typeof(t.style)&&"object"==_typeof(t.ownerDocument)}},Fancy.isBoolean=function(e){return"boolean"==typeof e},Fancy.isDate=function(e){return"date"===Fancy.typeOf(e)},Fancy.each=function(e,t){switch(Fancy.typeOf(e)){case"array":case"string":for(var n=0,i=e.length;n<i&&!0!==t(e[n],n,e);n++);break;case"object":for(var a in e)if(!0===t(e[a],a,e))break}},Fancy.mixin=function(e,t){var n,i=0,a=t.length;if("object"===Fancy.typeOf(t[0]))for(;i<a;i++)for(var o=(n=t[i])._class,s=n.methods,r=0,l=s.length;r<l;r++){var c=s[r];e[c]=o.prototype[c]}else for(;i<a;i++)if(n=t[i],Fancy.isString(n)){var d=Fancy.ClassManager.getMixin(n);d?Fancy.apply(e,d.prototype):Fancy.ClassManager.waitMixin(n,e)}else Fancy.apply(e,n.prototype)},Fancy.Mixin=function(e,t){var n=e.split("."),i=1,a=n.length-1;Fancy.ns(e);for(var o=Fancy.global[n[0]];i<a;i++)o=o[n[i]];1<n.length?(o[n[n.length-1]]=function(){},o[n[n.length-1]].prototype=t):(Fancy.global[n[0]]=function(){},Fancy.global[n[0]].prototype=t);var s=Fancy.ClassManager.waitMixins[e];if(s)for(i=0,a=(s=s.waiters).length;i<a;i++)Fancy.apply(s[i],t)},Fancy.applyConfig=function(e,t){var n;if(t=t||{},e.plugins&&t.plugins&&(e.plugins=e.plugins.concat(t.plugins),delete t.plugins),!0===e._isConfigApplied)return e;for(n in t)e[n]=t[n];return e._isConfigApplied=!0,e},Fancy.styleToString=function(e){var t="";for(var n in e=e||{})t+=n+": "+e[n]+";";return t},Fancy.apply(Fancy,{prefix:"fancy-gen-",idSeed:0,zIndex:1,id:function(e,t){return e?((e=e.dom||{}).id||(e.id=(t||Fancy.prefix)+ ++Fancy.idSeed),e.id):(t||Fancy.prefix)+ ++Fancy.idSeed}}),Fancy.apply(Fancy,{cls:"fancy",TOUCH_CLS:"fancy-touch",HIDDEN_CLS:"fancy-display-none",CLEARFIX_CLS:"fancy-clearfix",MODAL_CLS:"fancy-modal",PANEL_CLS:"fancy-panel",PANEL_BODY_CLS:"fancy-panel-body",PANEL_BODY_INNER_CLS:"fancy-panel-body-inner",PANEL_GRID_INSIDE_CLS:"fancy-panel-grid-inside",PANEL_SHADOW_CLS:"fancy-panel-shadow",PANEL_SUB_HEADER_CLS:"fancy-panel-sub-header",PANEL_SUB_HEADER_TEXT_CLS:"fancy-panel-sub-header-text",PANEL_HEADER_CLS:"fancy-panel-header",PANEL_HEADER_IMG_CLS:"fancy-panel-header-img",PANEL_HEADER_TEXT_CLS:"fancy-panel-header-text",PANEL_HEADER_TOOLS_CLS:"fancy-panel-header-tools",PANEL_TBAR_CLS:"fancy-panel-tbar",PANEL_BBAR_CLS:"fancy-panel-bbar",PANEL_SUB_TBAR_CLS:"fancy-panel-sub-tbar",PANEL_BUTTONS_CLS:"fancy-panel-buttons",PANEL_NOFRAME_CLS:"fancy-panel-noframe",PANEL_FOOTER_CLS:"fancy-panel-footer",PANEL_TAB_CLS:"fancy-panel-tab",PANEL_DRAGGABLE_CLS:"fancy-panel-draggable",BAR_CLS:"fancy-bar",BAR_TEXT_CLS:"fancy-bar-text",BAR_CONTAINER_CLS:"fancy-bar-container",BAR_BUTTON_CLS:"fancy-bar-button",BAR_SEG_BUTTON_CLS:"fancy-bar-seg-button",BAR_LEFT_SCROLLER_CLS:"fancy-bar-left-scroller",BAR_RIGHT_SCROLLER_CLS:"fancy-bar-right-scroller",FORM_CLS:"fancy-form",FORM_BODY_CLS:"fancy-form-body",FIELD_CLS:"fancy-field",FIELD_LABEL_CLS:"fancy-field-label",FIELD_EMPTY_CLS:"fancy-field-empty",FIELD_DISABLED_CLS:"fancy-field-disabled",FIELD_BLANK_ERR_CLS:"fancy-field-blank-err",FIELD_NOT_VALID_CLS:"fancy-field-not-valid",FIELD_TEXT_CLS:"fancy-field-text",FIELD_TEXT_INPUT_CLS:"fancy-field-text-input",FIELD_ERROR_CLS:"fancy-field-error",FIELD_SPIN_CLS:"fancy-field-spin",FIELD_SPIN_UP_CLS:"fancy-field-spin-up",FIELD_SPIN_DOWN_CLS:"fancy-field-spin-down",FIELD_CHECKBOX_CLS:"fancy-field-checkbox",FIELD_CHECKBOX_DISABLED_CLS:"fancy-field-checkbox-disabled",FIELD_CHECKBOX_INPUT_CLS:"fancy-field-checkbox-input",FIELD_CHECKBOX_ON_CLS:"fancy-checkbox-on",FIELD_CHECKBOX_MIDDLE_CLS:"fancy-checkbox-middle",FIELD_INPUT_LABEL_CLS:"fancy-field-input-label",FIELD_BUTTON_CLS:"fancy-field-button",FIELD_TAB_CLS:"fancy-field-tab",FIELD_COMBO_CLS:"fancy-combo",FIELD_COMBO_SELECTED_ITEM_CLS:"fancy-combo-item-selected",FIELD_COMBO_FOCUSED_ITEM_CLS:"fancy-combo-item-focused",FIELD_COMBO_DROPDOWN_BUTTON_CLS:"fancy-combo-dropdown-button",FIELD_COMBO_INPUT_CONTAINER_CLS:"fancy-combo-input-container",FIELD_COMBO_LIST_VALUE_CLS:"fancy-combo-list-value",FIELD_COMBO_LEFT_EL_CLS:"fancy-combo-left-el",FIELD_COMBO_RESULT_LIST_CLS:"fancy-combo-result-list",FIELD_SEARCH_CLS:"fancy-field-search",FIELD_SEARCH_LIST_CLS:"fancy-field-search-list",FIELD_SEARCH_PARAMS_LINK_CLS:"fancy-field-search-params-link",FIELD_SEARCH_PARAMED_CLS:"fancy-field-search-paramed",FIELD_SEARCH_PARAMED_EMPTY_CLS:"fancy-field-search-paramed-empty",FIELD_PICKER_BUTTON_CLS:"fancy-field-picker-button",FIELD_LABEL_ALIGN_TOP_CLS:"fancy-field-label-align-top",FIELD_LABEL_ALIGN_RIGHT_CLS:"fancy-field-label-align-right",FIELD_TEXTAREA_CLS:"fancy-textarea",FIELD_TEXTAREA_TEXT_CLS:"fancy-textarea-text",FIELD_TEXTAREA_TEXT_INPUT_CLS:"fancy-textarea-text-input",FIELD_RADIO_CLS:"fancy-field-radio",FIELD_RADIO_COLUMN_CLS:"fancy-field-radio-column",FIELD_RADIO_ON_CLS:"fancy-field-radio-on",FIELD_RADIO_INPUT_CLS:"fancy-field-radio-input",FIELD_TAB_ACTIVE_CLS:"fancy-field-tab-active",GRID_CLS:"fancy-grid",GRID_ANIMATION_CLS:"fancy-grid-animation",GRID_UNSELECTABLE_CLS:"fancy-grid-unselectable",GRID_EMPTY_CLS:"fancy-grid-empty-text",GRID_LEFT_EMPTY_CLS:"fancy-grid-left-empty",GRID_RIGHT_EMPTY_CLS:"fancy-grid-right-empty",GRID_CENTER_CLS:"fancy-grid-center",GRID_LEFT_CLS:"fancy-grid-left",GRID_RIGHT_CLS:"fancy-grid-right",GRID_RESIZER_LEFT_CLS:"fancy-grid-resizer-left",GRID_RESIZER_RIGHT_CLS:"fancy-grid-resizer-right",GRID_STATE_DRAG_COLUMN_CLS:"fancy-grid-state-drag-column",GRID_STATE_RESIZE_COLUMN_CLS:"fancy-grid-state-resize-column",GRID_COPY_TEXTAREA:"fancy-grid-copy-textarea",GRID_HEADER_CLS:"fancy-grid-header",GRID_HEADER_CELL_CLS:"fancy-grid-header-cell",GRID_HEADER_CELL_CONTAINER_CLS:"fancy-grid-header-cell-container",GRID_HEADER_CELL_TEXT_CLS:"fancy-grid-header-cell-text",GRID_HEADER_CELL_DOUBLE_CLS:"fancy-grid-header-cell-double",GRID_HEADER_CELL_TRIPLE_CLS:"fancy-grid-header-cell-triple",GRID_HEADER_CELL_TRIGGER_CLS:"fancy-grid-header-cell-trigger",GRID_HEADER_CELL_TRIGGER_IMAGE_CLS:"fancy-grid-header-cell-trigger-image",GRID_HEADER_CELL_TRIGGER_DISABLED_CLS:"fancy-grid-header-cell-trigger-disabled",GRID_HEADER_CELL_GROUP_LEVEL_1_CLS:"fancy-grid-header-cell-group-level-1",GRID_HEADER_CELL_GROUP_LEVEL_2_CLS:"fancy-grid-header-cell-group-level-2",GRID_HEADER_CELL_SELECT_CLS:"fancy-grid-header-cell-select",GRID_HEADER_CELL_TRIGGER_UP_CLS:"fancy-grid-header-cell-trigger-up",GRID_HEADER_CELL_TRIGGER_DOWN_CLS:"fancy-grid-header-cell-trigger-down",GRID_HEADER_COLUMN_TRIGGERED_CLS:"fancy-grid-header-column-triggered",GRID_HEADER_CELL_FILTER_CLS:"fancy-grid-header-filter-cell",GRID_HEADER_CELL_FILTER_FULL_CLS:"fancy-grid-header-filter-cell-full",GRID_HEADER_CELL_FILTER_SMALL_CLS:"fancy-grid-header-filter-cell-small",GRID_HEADER_CELL_CHECKBOX_CLS:"fancy-grid-header-cell-checkbox",GRID_HEADER_CELL_SORTABLE_CLS:"fancy-grid-header-cell-sortable",GRID_HEADER_CELL_NOT_SORTABLE_CLS:"fancy-grid-header-cell-not-sortable",GRID_CELL_CLS:"fancy-grid-cell",GRID_CELL_INNER_CLS:"fancy-grid-cell-inner",GRID_CELL_OVER_CLS:"fancy-grid-cell-over",GRID_CELL_SELECTED_CLS:"fancy-grid-cell-selected",GRID_CELL_ACTIVE_CLS:"fancy-grid-cell-active",GRID_CELL_EVEN_CLS:"fancy-grid-cell-even",GRID_CELL_WRAPPER_CLS:"fancy-grid-cell-wrapper",GRID_CELL_DIRTY_CLS:"fancy-grid-cell-dirty",GRID_CELL_DIRTY_EL_CLS:"fancy-grid-cell-dirty-el",GRID_PSEUDO_CELL_CLS:"fancy-grid-pseudo-cell",GRID_COLUMN_CLS:"fancy-grid-column",GRID_COLUMN_OVER_CLS:"fancy-grid-column-over",GRID_COLUMN_SELECT_CLS:"fancy-grid-column-select",GRID_COLUMN_SELECTED_CLS:"fancy-grid-column-selected",GRID_COLUMN_ELLIPSIS_CLS:"fancy-grid-column-ellipsis",GRID_COLUMN_ORDER_CLS:"fancy-grid-column-order",GRID_COLUMN_TEXT_CLS:"fancy-grid-column-text",GRID_COLUMN_SORT_ASC:"fancy-grid-column-sort-ASC",GRID_COLUMN_SORT_DESC:"fancy-grid-column-sort-DESC",GRID_COLUMN_COLOR_CLS:"fancy-grid-column-color",GRID_COLUMN_RESIZER_CLS:"fancy-grid-column-resizer",GRID_COLUMN_ROW_DRAG_CLS:"fancy-grid-column-row-drag",GRID_ROW_DRAG_EL_CLS:"fancy-grid-row-drag-el",GRID_COLUMN_TREE_CLS:"fancy-grid-column-tree",GRID_COLUMN_TREE_EXPANDER_CLS:"fancy-grid-tree-expander",GRID_COLUMN_SPARKLINE_CLS:"fancy-grid-column-sparkline",GRID_COLUMN_SPARKLINE_BULLET_CLS:"fancy-grid-column-sparkline-bullet",GRID_COLUMN_SPARK_PROGRESS_DONUT_CLS:"fancy-grid-column-spark-progress-donut",GRID_COLUMN_CHART_CIRCLE_CLS:"fancy-grid-column-chart-circle",GRID_COLUMN_GROSSLOSS_CLS:"fancy-grid-column-grossloss",GRID_COLUMN_PROGRESS_CLS:"fancy-grid-column-progress",GRID_COLUMN_PROGRESS_BAR_CLS:"fancy-grid-column-progress-bar",GRID_COLUMN_H_BAR_CLS:"fancy-grid-column-h-bar",GRID_COLUMN_ACTION_ITEM_CLS:"fancy-grid-column-action-item",GRID_ROW_OVER_CLS:"fancy-grid-cell-over",GRID_ROW_EDIT_CLS:"fancy-grid-row-edit",GRID_ROW_EDIT_BUTTONS_CLS:"fancy-grid-row-edit-buttons",GRID_ROW_EDIT_BUTTON_UPDATE_CLS:"fancy-edit-row-button-update",GRID_ROW_EDIT_BUTTON_CANCEL_CLS:"fancy-edit-row-button-cancel",GRID_ROW_GROUP_CLS:"fancy-grid-group-row",GRID_ROW_GROUP_INNER_CLS:"fancy-grid-group-row-inner",GRID_ROW_GROUP_COLLAPSED_CLS:"fancy-grid-group-row-collapsed",GRID_ROW_SUMMARY_CLS:"fancy-grid-summary-row",GRID_ROW_SUMMARY_CONTAINER_CLS:"fancy-grid-summary-container",GRID_ROW_SUMMARY_BOTTOM_CLS:"fancy-grid-summary-row-bottom",GRID_ROW_EXPAND_CLS:"fancy-grid-expand-row",GRID_ROW_EXPAND_OVER_CLS:"fancy-grid-expand-row-over",GRID_ROW_EXPAND_SELECTED_CLS:"fancy-grid-expand-row-selected",GRID_BODY_CLS:"fancy-grid-body",MENU_CLS:"fancy-menu",MENU_ITEM_CLS:"fancy-menu-item",MENU_ITEM_IMAGE_CLS:"fancy-menu-item-image",MENU_ITEM_TEXT_CLS:"fancy-menu-item-text",MENU_ITEM_SIDE_TEXT_CLS:"fancy-menu-item-side-text",MENU_ITEM_ACTIVE_CLS:"fancy-menu-item-active",MENU_ITEM_RIGHT_IMAGE_CLS:"fancy-menu-item-right-image",MENU_ITEM_EXPAND_CLS:"fancy-menu-item-expand",MENU_ITEM_DISABLED_CLS:"fancy-menu-item-disabled",MENU_ITEM_SEP_CLS:"fancy-menu-item-sep",MENU_ITEM_NO_IMAGE_CLS:"fancy-menu-item-no-image",MENU_ITEM_IMG_COPY_CLS:"fancy-menu-item-img-copy",MENU_ITEM_IMG_DELETE_CLS:"fancy-menu-item-img-delete",MENU_ITEM_IMG_DUPLICATE_CLS:"fancy-menu-item-img-duplicate",MENU_ITEM_IMG_EDIT_CLS:"fancy-menu-item-img-edit",TAB_WRAPPER_CLS:"fancy-tab-wrapper",TAB_ACTIVE_WRAPPER_CLS:"fancy-active-tab-wrapper",TAB_TBAR_CLS:"fancy-toolbar-tab",TAB_TBAR_ACTIVE_CLS:"fancy-toolbar-tab-active",BUTTON_CLS:"fancy-button",BUTTON_DISABLED_CLS:"fancy-button-disabled",BUTTON_PRESSED_CLS:"fancy-button-pressed",BUTTON_IMAGE_CLS:"fancy-button-image",BUTTON_IMAGE_COLOR_CLS:"fancy-button-image-color",BUTTON_TEXT_CLS:"fancy-button-text",BUTTON_DROP_CLS:"fancy-button-drop",BUTTON_MENU_CLS:"fancy-button-menu",SEG_BUTTON_CLS:"fancy-seg-button",TOOLTIP_CLS:"fancy-tooltip",TOOLTIP_INNER_CLS:"fancy-tooltip-inner",SEPARATOR_CLS:"fancy-separator",FOOTER_STATUS_CLS:"fancy-footer-status",STATUS_SOURCE_TEXT_CLS:"fancy-status-source-text",STATUS_SOURCE_LINK_CLS:"fancy-status-source-link",FOOTER_SOURCE_CLS:"fancy-footer-source",PICKER_MONTH_CELL_ACTIVE_CLS:"fancy-month-picker-cell-active",PICKER_MONTH_CLS:"fancy-month-picker",PICKER_BUTTON_BACK_CLS:"fancy-picker-button-back",PICKER_BUTTON_NEXT_CLS:"fancy-picker-button-next",PICKER_MONTH_ACTION_BUTTONS_CLS:"fancy-month-picker-action-buttons",PICKER_DATE_CLS:"fancy-date-picker",PICKER_DATE_CELL_TODAY_CLS:"fancy-date-picker-cell-today",PICKER_DATE_CELL_ACTIVE_CLS:"fancy-date-picker-cell-active",PICKER_DATE_CELL_OUT_RANGE_CLS:"fancy-date-picker-cell-out-range",PICKER_BUTTON_DATE_CLS:"fancy-picker-button-date",PICKER_BUTTON_DATE_WRAPPER_CLS:"fancy-picker-button-date-wrapper",PICKER_BUTTON_TODAY_CLS:"fancy-picker-button-today",PICKER_BUTTON_TODAY_WRAPPER_CLS:"fancy-picker-button-today-wrapper"}),Fancy.ANIMATE_DURATION=400,sa=navigator.userAgent.toLowerCase(),ta=function(e){return e.test(sa)},ua=ta(/opera/),va=!ua&&ta(/msie/),wa=window.chrome,xa=window.navigator,ya=xa.vendor,za=-1<xa.userAgent.indexOf("Edge"),Aa=xa.userAgent.match("CriOS"),Ea=-1<xa.userAgent.indexOf("OPR"),Ba=!!Aa||null!=wa&&"Google Inc."===ya&&!1===Ea&&!1===za,11===(Ha=-1,"Microsoft Internet Explorer"==navigator.appName?(Fa=navigator.userAgent,null!=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(Fa)&&(Ha=parseFloat(RegExp.$1))):"Netscape"==navigator.appName&&(Fa=navigator.userAgent,null!=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(Fa)&&(Ha=parseFloat(RegExp.$1))),Ha)&&(va=!0),!1===va&&za&&(va=!0),Fancy.apply(Fancy,{isOpera:ua,isIE:va,isChrome:Ba}),Fancy.getViewSize=function(){var e=[];return Fancy.isIE?(e[0]=document.documentElement.clientHeight,e[1]=document.documentElement.clientWidth):(e[0]=window.innerHeight,e[1]=window.innerWidth),e},Fancy.getScroll=function(){var e=document.documentElement,t=document.body;return e&&(e.scrollTop||e.scrollLeft)?[e.scrollTop,e.scrollLeft]:t?[t.scrollTop,t.scrollLeft]:[0,0]},Fancy.getMouseWheelEventName=function(){return"onmousewheel"in document.body?"mousewheel":"DOMMouseScroll"},Fancy.getWheelDelta=function(e){var t=0;return e.wheelDelta?t=e.wheelDelta/120:e.detail&&(t=-e.detail/3),t},Fancy.isTouch=void 0!==document.ontouchstart,Fancy.i18n={},Fancy.currencies={map:{EUR:"€",USD:"$",GBP:"£",RUB:"₽",CZK:"Kč",AUD:"$",JPY:"¥",PLN:"zł",TRY:"₺",DKK:"kr",KRW:"₩",BRL:"R$",CNY:"¥",SEK:"kr",CAD:"$",NOK:"kr",IDR:"Rp"}},Fancy.modules={},Fancy.getModulesList=function(){var n=[];return Fancy.each(Fancy.modules,function(e,t){n.push(t)}),n},Qa={},Fancy.loadModule=function(n,i){var e=document.getElementsByTagName("body")[0],t=document.createElement("script"),a=n,o=Fancy.DEBUG?".js":".min.js",s=Fancy.version.replace(/\./g,""),r=Fancy.MODULESDIR||FancyGrid.MODULESDIR||"https://cdn.fancygrid.com/@"+Fancy.version+"/modules/";i=i||function(){},!1!==Fancy.MODULELOAD&&!1!==Fancy.MODULESLOAD&&(n=n.replace(/ /g,"-"),Fancy.DEBUG?o+="?_dc="+ +new Date:o+="?_v="+s,Fancy.Modules.on("loaded",function(e,t){t===n&&(Fancy.modules[a]=!0,i(n))}),Qa[n]||(Qa[n]=!0,t.src=r+n+o,t.charset="utf-8",t.onload=function(){Fancy.Modules.fire("loaded",n)},t.onerror=function(){throw new Error("[FancyGrid error] - module "+n+" was not loaded")},e.appendChild(t)))},Fancy.loadLang=function(e,t){if(void 0!==Fancy.i18n[e])return!0;var n=document.getElementsByTagName("body")[0],i=document.createElement("script"),a=Fancy.MODULESDIR||FancyGrid.MODULESDIR||"https://cdn.fancygrid.com/@"+Fancy.version+"/modules/";i.src=a+"i18n/"+e+".js",i.charset="utf-8",i.async="true",i.onload=function(){t({lang:Fancy.i18n[e]})},n.appendChild(i)},Fancy.loadStyle=function(){var e=document.querySelectorAll("link");if(!Fancy.stylesLoaded&&(Fancy.each(e,function(e){/fancy\./.test(e.href)&&(Fancy.stylesLoaded=!0)}),e=document.querySelectorAll("link"),!Fancy.stylesLoaded&&(Fancy.each(e,function(e){/fancy\./.test(e.href)&&(Fancy.stylesLoaded=!0)}),!Fancy.stylesLoaded))){var t=document.getElementsByTagName("head")[0],n=document.createElement("link"),i=Fancy.DEBUG?".css":".min.css",a=Fancy.version.replace(/\./g,""),o=Fancy.MODULESDIR||FancyGrid.MODULESDIR||"https://cdn.fancygrid.com/@"+Fancy.version+"/modules/";o=(o=o.replace("modules/","")).replace("modules",""),Fancy.DEBUG?i+="?_dc="+ +new Date:i+="?_v="+a,n.href=o+"fancy"+i,n.rel="stylesheet",Fancy.loadingStyle=!0,n.onload=function(){Fancy.loadingStyle=!1},t.appendChild(n)}},Fancy.themes={},Fancy.defineTheme=function(e,t){var n={};t.extend?Fancy.apply(n,Fancy.getTheme(t.extend).config):"default"!==e&&Fancy.apply(n,Fancy.getTheme("default").config),Fancy.apply(n,t.config),t.config=n,Fancy.themes[e]=t},Fancy.getTheme=function(e){var t={config:{}};return Fancy.isObject(e)?(Fancy.applyIf(t,Fancy.themes[e.name||"default"]),Fancy.apply(t.config,Fancy.themes[e.name||"default"].config),Fancy.apply(t.config,e.config),t):Fancy.themes[e]},Fancy.defineTheme("default",{config:{cellHeaderHeight:30,cellWidth:70,minCellWidth:40,cellHeight:32,titleHeight:42,subTitleHeight:42,barHeight:38,bottomScrollHeight:12,minCenterWidth:100,panelBorderWidth:2,groupRowHeight:31,gridBorders:[1,1,1,1],gridWithoutPanelBorders:[1,1,1,1],panelBodyBorders:[0,2,2,2],knobOffSet:2,fieldHeight:37,charWidth:7,menuItemHeight:30}}),Fancy.defineTheme("blue",{config:{panelBorderWidth:1,gridBorders:[1,1,1,1],gridWithoutPanelBorders:[1,1,1,1],panelBodyBorders:[0,0,0,0],charWidth:7,menuItemHeight:30}}),Fancy.defineTheme("gray",{config:{panelBorderWidth:0,gridBorders:[0,0,1,0],gridWithoutPanelBorders:[1,1,1,1],panelBodyBorders:[0,0,0,0],charWidth:7,menuItemHeight:30}}),Fancy.defineTheme("dark",{config:{panelBorderWidth:1,gridBorders:[0,1,1,1],gridWithoutPanelBorders:[1,1,1,1],panelBodyBorders:[0,0,0,0],charWidth:7,menuItemHeight:30}}),Fancy.defineTheme("sand",{config:{panelBorderWidth:1,gridBorders:[0,1,1,1],gridWithoutPanelBorders:[1,1,1,1],panelBodyBorders:[0,0,0,0],charWidth:7,menuItemHeight:30}}),Fancy.defineTheme("bootstrap",{config:{panelBorderWidth:1,gridBorders:[1,1,1,1],gridWithoutPanelBorders:[1,1,1,1],panelBodyBorders:[0,0,0,0],charWidth:7,menuItemHeight:30}}),Fancy.defineTheme("bootstrap-no-borders",{config:{panelBorderWidth:0,gridBorders:[0,0,0,0],gridWithoutPanelBorders:[0,0,0,0],panelBodyBorders:[0,0,0,0],columnLines:!1,charWidth:8,menuItemHeight:30}}),Fancy.defineTheme("material",{config:{columnLines:!1,cellHeaderHeight:40,panelBorderWidth:0,cellHeight:40,titleHeight:48,barHeight:48,subTitleHeight:48,groupRowHeight:40,gridBorders:[0,0,1,0],gridWithoutPanelBorders:[1,1,1,1],panelBodyBorders:[0,0,0,0],charWidth:7,menuItemHeight:35}}),Fancy.String={format:function(e){var n,t,i;if("array"===Fancy.typeOf(arguments[1]))n=arguments[1];else for(i=arguments.length,n=[],t=1;t<i;t++)n[t-1]=arguments[t];return e.replace(/\[(\d+)]/g,function(e,t){return n[t]})},upFirstChar:function(e){return e[0].toLocaleUpperCase()+e.substr(1,e.length)},trim:function(e){return e.replace(/\s/g,"")}},Fancy.Array={copy:function(e,t){if(!t)return e.slice();for(var n=[],i=0,a=e.length;i<a;i++)switch(Fancy.typeOf(e[i])){case"object":n[i]=Fancy.Object.copy(e[i]);break;case"array":n[i]=Fancy.Array.copy(e[i]);break;default:n=e[i]}return n},each:function(e,t){for(var n=0,i=e.length;n<i;n++)t(e[n],n)},count:function(e){return e.length},sum:function(e){var t=0,n=e.length,i=0;if(Fancy.isArray(e[0]))for(i=[];t<n;t++)for(var a=0,o=e[t].length;a<o;a++)void 0===i[a]&&(i[a]=0),i[a]+=e[t][a];else for(;t<n;t++)!1!==Fancy.isNumber(e[t])&&(i+=e[t]);return i},min:function(e){return Math.min.apply(this,e)},max:function(e){return Math.max.apply(this,e)},average:function(e){for(var t=0,n=0,i=e.length;n<i;n++)!1!==Fancy.isNumber(e[n])&&(t+=e[n]);return Math.round(t/e.length)},insert:function(e,t,n){var i=e.splice(t,e.length-t);return e.concat(n).concat(i)},none:function(){return""}},Fancy.Object={copy:function(e){var t={};for(var n in e)t[n]=e[n];return t},isEmpty:function(e){var t=!0;for(var n in e)t=!1;return t}},Fancy.Number={isFloat:function(e){return Number(e)===e&&e%1!=0},getPrecision:function(e){return(e+"").split(".")[1].length+1},correctFloat:function(e){return parseFloat(e.toPrecision(14))},format:function(e,t,n){var i,a;void 0===t&&(t=","),Fancy.isNumber(t)&&(n=t,t=","),i=""===t?".":","===t?".":",";var o=e.toString().split(".");if(o[0]=o[0].replace(/\B(?=(\d{3})+(?!\d))/g,t),void 0===o[1]&&(o[1]=""),void 0!==n)if(0===n)a=o[0];else{var s=n-o[1].length;if(0<s)for(var r=0;r<s;r++)o[1]+="0";else s<0&&(o[1]=o[1].substring(0,n));a=o[0]+i+o[1]}else a=o[0],o[1].length&&(a+=i+o[1]);return a}},Fancy.Collection=function(e){var t=this;if(t.items=[],t.keys=[],t.map={},t.indexMap={},t.length=0,e)if(0<e.length)for(var n=0,i=e.length;n<i;n++)t.add(n,e[n]);else for(var a in e)t.add(a,e[a])},Fancy.Collection.prototype={add:function(e,t){var n=this;n.items.push(t),n.keys.push(e),n.map[e]=t,n.indexMap[e]=n.length,n.length++},remove:function(e){var t=this,n=t.indexMap[e];t.items.splice(n,1),t.keys.splice(n,1),delete t.indexMap[n],delete t.map[e],t.length--,t.updateIndexMap()},updateIndexMap:function(){var e=0,t=this.keys.length;for(this.indexMap={};e<t;e++)this.indexMap[this.keys[e]]=e},removeAll:function(){var e=this;e.items=[],e.keys=[],e.indexMap={},e.map={},e.length=0},get:function(e){return this.map[e]},each:function(e){for(var t=0,n=this.length;t<n;t++)e(this.keys[t],this.items[t],t,this.length)}},Fancy.Template=function(e){Fancy.isArray(e)?this.tpl=e.join(""):this.tpl=e,this.compile()},Fancy.Template.prototype={re:/\{([\w\-]+)\}/g,getHTML:function(e){return this.compiled(e||{})},compile:function compile(){function fn(e,t){return"'+("+(t="values['"+t+"']")+" === undefined ? '' : "+t+")+'"}var me=this;return eval("me.compiled = function(values){ return '"+me.tpl.replace(me.re,fn)+"';};"),me}},Fancy.key={BACKSPACE:8,TAB:9,ENTER:13,RETURN:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_PLUS:107,NUM_MINUS:109,NUM_DOT:110,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,DOT:190,PAGE_UP:33,PAGE_DOWN:34},Fancy.Key={isNum:function(e){var t=Fancy.key;switch(e){case t.ZERO:case t.ONE:case t.TWO:case t.THREE:case t.FOUR:case t.FIVE:case t.SIX:case t.SEVEN:case t.EIGHT:case t.NINE:case t.NUM_ZERO:case t.NUM_ONE:case t.NUM_TWO:case t.NUM_THREE:case t.NUM_FOUR:case t.NUM_FIVE:case t.NUM_SIX:case t.NUM_SEVEN:case t.NUM_EIGHT:case t.NUM_NINE:return!0;default:return!1}},isNumControl:function(e,t){var n=Fancy.key;if(Fancy.Key.isNum(e))return!0;if(t.shiftKey&&187===e)return!0;switch(e){case n.NUM_PLUS:case 189:case n.NUM_MINUS:case n.NUM_DOT:case n.BACKSPACE:case n.DELETE:case n.TAB:case n.ENTER:case n.RETURN:case n.SHIFT:case n.CTRL:case n.ALT:case n.ESC:case n.END:case n.HOME:case n.LEFT:case n.UP:case n.RIGHT:case n.DOWN:case n.INSERT:case n.DOT:return!0;default:return!1}}},rd={},sd={},ud=function(){this.waitMixins={}},ud.prototype={items:new Fancy.Collection,add:function(e,t){var n=e.split("."),i=1,a=n.length-1;Fancy.ns(e);for(var o=Fancy.global[n[0]];i<a;i++)o=o[n[i]];1<n.length?o[n[n.length-1]]=t:Fancy.global[n[0]]=t,this.items.add(e,t)},get:function(e){return this.items.get(e)},waitMixin:function(e,t){this.waitMixins[e]=this.waitMixins[e]||{waiters:[]},this.waitMixins[e].waiters.push(t)},getMixin:function(e){var t=e.split("."),n=1,i=t.length,a=Fancy.global[t[0]];if(void 0===a)return!1;for(;n<i;n++)if(void 0===(a=a[t[n]]))return!1;return a}},Fancy.ClassManager=new ud,Fancy.define=function(e,t){t=t||{};var n=[];if(Fancy.isArray(e)&&(e=(n=e)[0]),t.constructor===Object&&(void 0===t.extend?t.constructor=function(){}:t.constructor=function(){this.Super("constructor",arguments)}),void 0===t.extend)rd[e]=t.constructor;else{var i;switch(rd[e]=t.constructor,_typeof(t.extend)){case"string":i=Fancy.ClassManager.get(t.extend),rd[e].prototype.$Super=Fancy.ClassManager.get(t.extend);break;case"function":i=t.extend,rd[e].prototype.$Super=t.extend}delete t.extend,rd[e].prototype.Super=function(e,t){var n=this;switch(n.$Iam?n.$Iam=Fancy.ClassManager.get(n.$Iam.prototype.$Super.prototype.$name):n.$Iam=Fancy.ClassManager.get(n.$Super.prototype.$name),e){case"const":case"constructor":n.$Iam.apply(n,t);break;default:n.$Iam.prototype[e].apply(n,t)}delete n.$Iam},function(e,t){for(var n in t.prototype)void 0===e.prototype[n]&&(e.prototype[n]=t.prototype[n])}(rd[e],i)}for(var a in rd[e].prototype.$name=e,t.mixins&&(Fancy.mixin(rd[e].prototype,t.mixins),delete rd[e].prototype.mixins),void 0!==t.plugins&&(void 0===rd[e].prototype.$plugins&&(rd[e].prototype.$plugins=[]),rd[e].prototype.$plugins=rd[e].prototype.$plugins.concat(t.plugins),delete rd[e].prototype.plugins),t)rd[e].prototype[a]=t[a];var o=rd[e];!0===t.singleton&&(delete rd[e],o=new o(t),rd[e]=o),1<n.length?Fancy.each(n,function(e){Fancy.ClassManager.add(e,o)}):Fancy.ClassManager.add(e,o),t.type?(sd[t.type]=o,Fancy.addWidgetType(t.type,o)):t.ptype&&(sd[t.type]=o,Fancy.addPluginByType(t.ptype,o))},Fancy.getClassByType=function(e){return sd[e]},Fancy.MixinClass=function(){},Fancy.MixinClass.prototype={initId:function(){var e=this,t=e.prefix||Fancy.prefix;e.id=e.id||Fancy.id(null,t),Fancy.addWidget(e.id,e)},initPlugins:function(){var e,t,n,i=this,a=i;if(i.plugins=i.plugins||[],i._plugins&&(i.plugins=i.plugins.concat(i._plugins)),void 0!==i.plugins&&(i.$plugins=i.plugins,delete i.plugins),void 0!==i.$plugins)for(var o,s=0,r=i.$plugins,l=r.length,c={};s<l;s++){(n=r[s]).widget=a;var d=n.type||n.ptype;if(!0!==c[d]){if(c[d]=!0,void 0===(e=Fancy.getPluginByType(d)))throw new Error("[FancyGrid Error] - some of module was not loaded. Grid plugin does not exist - "+d);t=new e(n),void 0!==(o=n.inWidgetName||t.inWidgetName)&&(a[o]=t)}}}},Fancy.define("Fancy.Data",{constructor:function(e){if(this.map={},e)for(var t=0,n=e.length,i=this.map;t<n;t++)i[t]=e[t];this.length=0},add:function(e,t){this.map[e]=t,this.length++},get:function(e){return this.map[e]}}),Fancy.define("Fancy.Model",{constructor:function(e){var t=this,n={},i=t.fields||[],a=0,o=i.length;if(Fancy.isArray(e)){for(;a<o;a++){n[s=i[a]]=e[a]}void 0===n.id&&(Fancy.idSeed++,n.id=Fancy.idSeed+1e3),t.data=n,t.id=t.data.id}else{if(e.id?t.id=e.id:(Fancy.idSeed++,t.id=Fancy.idSeed+1e3,e.id=t.id),void 0===t.fields){for(var s in i=[],e)i.push(s);t.fields=i}for(o=i.length;a<o;a++){void 0===e[s=i[a]]?n[s]="":n[s]=e[s]}n.id||(t.fields.push("id"),e.id||(e.id=t.id),n.id=e.id),t.data=n}},get:function(e){return void 0===e?this.data:this.data[e]},set:function(e,t){if(void 0===t&&Fancy.isObject(e))for(var n in e)this.set(n,e[n]);else this.data[e]=t}}),Fancy.define("Fancy.PluginManager",{singleton:!0,constructor:function(){this.ptypes=new Fancy.Data},addPlugin:function(e,t){this.ptypes.add(e,t)},getPlugin:function(e){return this.ptypes.get(e)}}),Fancy.addPluginByType=function(e,t){Fancy.PluginManager.addPlugin(e,t)},Fancy.getPluginByType=function(e){return Fancy.PluginManager.getPlugin(e)},function(){var e=Fancy;e.define("Fancy.WidgetManager",{singleton:!0,constructor:function(){this.wtypes=new e.Data,this.widgets=new e.Data},addWidgetType:function(e,t){t.prototype.wtype=e,this.wtypes.add(e,t)},getWidgetClassByType:function(e){return this.wtypes.get(e)},addWidget:function(e,t){this.widgets.add(e,t)},getWidget:function(e){return this.widgets.get(e)}});var n=e.WidgetManager;e.addWidgetType=function(e,t){n.addWidgetType(e,t)},e.getWidgetClassByType=function(e){return n.getWidgetClassByType(e)},e.addWidget=function(e,t){n.addWidget(e,t)},e.getWidget=function(e){return n.getWidget(e)}}(),tf=0,uf={},Fancy.define(["Fancy.Event","Fancy.Observable"],{mixins:[Fancy.MixinClass],constructor:function(e){var t=this;if(Fancy.applyConfig(t,e||{}),t.$events={},t.listeners||t.events)for(var n=t.listeners||t.events,i=0,a=n.length;i<a;i++){var o=n[i],s=null,r=null,l=null,c=0,d=[];for(var u in o)switch(u){case"scope":l=o[u];break;case"params":d=o[u];break;case"delay":c=o[u];break;default:r=o[s=u]}if(null===s)throw new Error("Event was not set");switch(Fancy.typeOf(r)){case"string":r=t[r],o.handler=r,void 0===o.scope&&(l=t),o.scope=l;break;case"function":break;default:throw new Error("Handler has wrong type or not defined")}if(!1===Fancy.isArray(d))throw new Error("params must be array");t.addEvent(s),t.on(s,r,l,d,c)}},on:function(e,t,n,i,a){if(void 0===this.$events[e])throw new Error("Event name is not set: "+e);if(void 0===t)throw new Error("Handler is undefined. Name of event is "+e+".");t.$fancyFnSeed=tf,uf[tf]=t,tf++,this.$events[e].push({fn:t,scope:n,params:i||[],delay:a})},un:function(e,t){var n=this.$events[e];if(!n)return!1;for(var i=0,a=n.length;i<a;i++){var o=n[i];if(o.fn.$fancyFnSeed===t.$fancyFnSeed)return o.toRemove=!0}return!1},once:function(t,n,e){var i=this;i.on(t,function e(){n.apply(this,arguments),i.un(t,e)},e)},unAll:function(){this.$events={}},unAllByType:function(e){this.$events[e]=[]},fire:function(e){var t=this,n=t.$events[e];if(!n)return!1;for(var i=1,a=arguments.length,o=[t];i<a;i++)o.push(arguments[i]);for(i=0,a=n.length;i<a;i++){var s=n[i],r=[];!0!==s.toRemove?(r=r.concat(o),s.params&&(r=r.concat(s.params)),s.delay?setTimeout(function(){s.fn.apply(s.scope||t,r)},s.delay):s.fn.apply(s.scope||t,r)):(n.splice(i,1),i--,a=n.length)}},addEvent:function(e){return this.addEvents(e)},addEvents:function(e){if(1<arguments.length){for(var t=[],n=0,i=arguments.length;n<i;n++)t[n]=arguments[n];e=t}if("string"===Fancy.typeOf(e))this.$events[e]=this.$events[e]||[];else if("array"===Fancy.typeOf(e))for(n=0,i=e.length;n<i;n++)this.$events[e[n]]=this.$events[e[n]]||[]},has:function(e){var t=this.$events[e];return!!t&&0!==t.length}}),Fancy.define("Fancy.Modules",{extend:Fancy.Event,singleton:!0,constructor:function(){this.Super("const",arguments),this.init()},init:function(){this.addEvents("loaded")}}),Fancy.Mixin("Fancy.store.mixin.Edit",{remove:function(e,t){var n,i,a,o=this,s=e.id;switch(Fancy.typeOf(e)){case"string":case"number":s=e;break;default:s=e.id||e.data.id}if(o.isTree&&!0!==o.treeCollapsing){var r=o.getById(s),l=o.getById(r.get("parentId"));if(!1===r.get("leaf")&&r.get("expanded")){var c=r.data.child.length-1;Fancy.each(r.data.child,function(e,t,n){o.remove(n[c]),c--})}l&&Fancy.each(l.data.child,function(e,t){if(e.id===s)return l.data.child.splice(t,1),!0})}if("server"===o.proxyType&&o.autoSave&&o.proxy.api.destroy)!1!==t&&o.proxyCRUD("DESTROY",s);else{if(e.rowIndex)n=o.dataViewIndexes[e.rowIndex],i=e.rowIndex;else if(n=o.getDataIndex(s),i=o.getRow(s),void 0===n&&void 0===i)return;var d;if(o.isTree&&o.treeCollapsing&&o.filteredData)Fancy.each(o.data,function(e,t){if(e.data.id===s)return d=t,!0}),a=o.data.splice(d,1)[0];else a=o.data.splice(n,1)[0];o.paging&&(i+=o.showPage*o.pageSize),o.order&&o.order.splice(i,1),o.changeOrderIndexes&&o.changeOrderIndexes(n),o.paging&&(0!==o.showPage&&o.showPage*o.pageSize===o.getTotal()&&o.showPage--,o.calcPages()),delete o.map[s],o.treeCollapsing||!1===t||o.fire("remove",s,a,n),!1!==t&&o.changeDataView()}},removeAt:function(e){this.remove({rowIndex:e,id:this.getId(e)})},removeAll:function(){var e=this;e.data=[],e.dataView=[],delete e.order,e.paging&&(e.showPage=0,e.calcPages()),e.filters&&(delete e.filters,delete e.filteredData,delete e.filterOrder)},add:function(e){return this.insert(this.getTotal(),e)},insert:function(e,t,n){var i=this;if(i.grouping&&!i.bugFixGrouping&&(i.defineModel(t,!0),i.bugFixGrouping=!0),i.addIndex=e,void 0===t.id){Fancy.idSeed++;var a=Fancy.idSeed+1e3;"server"===i.proxyType?t.id="Temp-"+a:t.id=a}if(i.getById(t.id)&&i.remove(t.id),"server"!==i.proxyType||!i.autoSave||!i.proxy.api.create)return i.insertItem(t,e,n);!1!==n&&(i.once("create",i.onCreate,i),i.proxyCRUD("CREATE",t))},insertItem:function(e,t,n){var i=this,a=new i.model(e);t=i.addIndex;return i.treeExpanding||!1===n||i.fire("beforeinsert"),delete i.addIndex,i.data.splice(t,0,a),i.order&&(i.order.splice(t,0,t),i.changeOrderIndexes(t,"+"),i.order[t]--),!1!==n&&i.changeDataView(),i.map[e.id]=a,i.treeExpanding||!1===n||i.fire("insert",a),a},onCreate:function(e,t){return this.insertItem(t)}}),Fancy.Mixin("Fancy.store.mixin.Dirty",{initTrackDirty:function(){var e=this;e.changed={length:0},e.removed={length:0},e.inserted={length:0},e.undoActions=[],e.redoActions=[],e.on("remove",e.onDirtyRemove,e),e.on("set",e.onDirtySet,e),e.on("insert",e.onDirtyInsert,e)},onDirtySet:function(e,t){var n=this,i=t.id;if("$selected"!==t.key){if(void 0===n.changed[i]?(n.changed[i]={length:1},n.changed.length++):n.changed[i].length++,void 0===n.changed[i][t.key]&&(n.changed[i][t.key]={originValue:t.oldValue}),n.changed[i][t.key].value=t.value,n.changed[i][t.key].value===n.changed[i][t.key].originValue){delete n.changed[i][t.key],n.changed[i].length--;for(var a=0,o=n.undoActions.length-1;a<=o;a++){var s=o-a,r=n.undoActions[s];if(r.id===i&&t.key===r.key){var l=n.undoActions.splice(s,1);n.redoActions.push(l)}}}else n.redoing||(n.redoActions=[]),n.undoActions.push({id:i,type:"edit",key:t.key,value:t.value,oldValue:t.oldValue});0===n.changed[i].length&&(delete n.changed[i],n.changed.length--)}},onDirtyRemove:function(e,t,n,i){var a=this;a.removed[t]=n.data,a.removed.length++,!0!==a.undoStoppped&&(a.redoing||(a.redoActions=[]),a.undoActions.push({id:t,type:"remove",data:n.data,rowIndex:i}))},onDirtyInsert:function(e,t){var n=this;n.treeExpanding||(n.inserted[t.id]=t,n.inserted.length++,!0!==n.undoStoppped&&(n.redoing||(n.redoActions=[]),n.undoActions.push({id:t.id,type:"insert",data:t.data})))},clearDirty:function(){var e=this;e.changed={length:0},e.removed={length:0},e.inserted={length:0},e.undoActions=[],e.redoActions=[]}}),Fancy.define("Fancy.Store",{extend:Fancy.Event,mixins:["Fancy.store.mixin.Paging","Fancy.store.mixin.Infinite","Fancy.store.mixin.Proxy","Fancy.store.mixin.Rest","Fancy.store.mixin.Reader","Fancy.store.mixin.Writer","Fancy.store.mixin.Sort","Fancy.store.mixin.Edit","Fancy.store.mixin.Grouping","Fancy.store.mixin.Filter","Fancy.store.mixin.Search","Fancy.store.mixin.Dirty","Fancy.store.mixin.Tree"],pageSize:10,showPage:0,pages:0,dirty:!1,loading:!1,constructor:function(){var e=this;e.Super("const",arguments),e.init(),e.data=e.data||[],e.dataView=e.dataView||[],e.dataViewMap=e.dataViewMap||{},e.map={},e.setModel(),e.data&&(e.data.proxy?e.initProxy():e.widget.isTreeData||e.setData(e.data)),e.readSmartIndexes(),e.widget.grouping&&e.orderDataByGroupOnStart(),e.widget.isTreeData&&e.initTreeData()},init:function(){var e=this;e.addEvents("add","change","changepages","set","beforeupdate","update","beforeremove","remove","beforedestroy","destroy","beforecreate","create","beforesort","sort","beforeload","load","filter","beforeinsert","insert","servererror","serversuccess"),e.initId(),e.initPlugins(),e.paging&&e.initPaging(),e.infinite&&e.initInfinite(),e.initTrackDirty&&e.initTrackDirty()},setModel:function(){var e=this,t=e.model;if(t=void 0===t?Fancy.Model:Fancy.ClassManager.get(e.model),e.model=t,e.fields=t.prototype.fields,void 0===e.fields)throw new Error("needed to set fields in Model of Store")},setData:function(e){var t,a=this,n=0,i=e.length,o=a.model;if(a.data=[],a.dataView=[],a.dataViewMap={},a.dataViewIndexes={},a.map={},a.collapsed)for(;n<i;n++)t=new o(e[n]),a.data[n]=t,a.map[t.id]=t;else if(a.expanded)for(;n<i;n++)t=new o(e[n]),a.data[n]=t,a.map[t.id]=t;else if(a.paging)for(;n<i;n++)t=new o(e[n]),a.data[n]=t,n<a.pageSize&&(a.dataView[n]=t,a.dataViewMap[t.id]=n,a.dataViewIndexes[n]=n),a.map[t.id]=t;else for(;n<i;n++)t=new o(e[n]),a.data[n]=t,a.dataView[n]=t,a.dataViewMap[t.id]=n,a.dataViewIndexes[n]=n,a.map[t.id]=t;a.isTree&&Fancy.each(a.data,function(i,e){i.get("expanded")&&Fancy.each(i.data.child,function(e,t){var n=a.getById(e.id);i.data.child[t]=n})})},getItem:function(e){var t=this,n=t.dataView[e];return n||(n=t.order?t.data[t.order[e]]:t.data[e]),n},get:function(e,t,n){var i,a=this;if(void 0===e)return a.data;var o=a.dataView[e];return o?void 0===t?(void 0===(i=o.data).id&&(i.id=a.dataView[e].id),a.dataView[e].data):"none"===t?"":(o=n?a.data[e]:a.dataView[e],"id"===t?o.data[t]||o.id:o.data[t]):(o=a.order?a.data[a.order[e]]:a.data[e])?"id"===t?o.data[t]||o.id:o.data[t]:o},getId:function(e){return this.dataView[e].id},getRow:function(e){return this.dataViewMap[e]},set:function(e,n,i,t){var a,o,s=this,r=0;if(s.infiniteScrolledToRow&&(r=s.infiniteScrolledToRow),e+r===-1?a=s.getById(t):t=(a=s.dataView[e+r]).data.id||a.id,void 0!==i){if((o=e+r===-1?a.get(n):s.get(e+r,n))!=i){if(e+r===-1)a.set(n,i);else{var l=s.dataView[e+r];if(l.data.parentId){var c=s.getById(l.data.parentId);Fancy.each(c.data.child,function(e,t){e.id===l.id&&(e[n]=i)})}l.data[n]=i}"server"===s.proxyType&&s.autoSave&&s.proxyCRUD("UPDATE",t,n,i),h=-1===e?a.data:s.dataView[e+r].data,s.fire("set",{id:t,data:h,rowIndex:e,infiniteRowIndex:e+r,key:n,value:i,oldValue:o,item:a})}}else{var d=n;for(var u in d){var h;if("id"!==u)h=e+r===-1?(o=a.get(u),a.set(u,d[u]),a.data):(o=s.get(e+r,u),s.dataView[e+r].data[u]=d[u],s.dataView[e+r].data),s.fire("set",{id:t,data:h,rowIndex:e,infiniteRowIndex:e+r,key:u,value:d[u],oldValue:o,item:a})}"server"===s.proxyType&&s.autoSave&&s.proxyCRUD("UPDATE",t,d)}},setItemData:function(e,t){var n=this,i=n.get(e);if(n.infinite&&(e-=n.infiniteScrolledToRow),n.writeAllFields&&"server"===n.proxyType)n.set(e,t);else for(var a in t)i[a]!=t[a]&&n.set(e,a,t[a])},getLength:function(){var e=this.dataView.length;return this.infinite&&e>this.infiniteDisplayedRows&&(e=this.infiniteDisplayedRows),e},getTotal:function(){var e=this;return"server"===e.pageType?e.totalCount:e.filteredData?e.filteredData.length:void 0===e.data?0:Fancy.isObject(e.data)?0:e.data.length},defineModel:function(e,t){var n=this,i=n.store;if(!n.model||!n.fields||0===n.fields.length||t){e=e||n.data||i.data;var a=n.getFieldsFromData(e),o="Fancy.model."+Fancy.id();Fancy.define(o,{extend:Fancy.Model,fields:a}),n.model=o,n.fields=a,n.setModel()}},getFieldsFromData:function(e){var t=e.items||e;if(e.fields)return e.fields;if(!t)throw new Error("not set fields of data");var n=t[0],i=[];for(var a in void 0===t.length&&(n=t),n)i.push(a);return i},getColumnOriginalValues:function(e,t){var n,i=0,a=[],o=this[(t=t||{}).dataProperty||"data"],s=o.length;if(/\./.test(e)&&(n=!0),t.smartIndexFn)for(;i<s;i++)a.push(t.smartIndexFn(o[i].data));else if(t.format)if("date"===t.type)for(;i<s;i++){null===(l=o[i].data[e])||""===l?a.push(Number.NEGATIVE_INFINITY):a.push(Fancy.Date.parse(l,t.format,t.mode))}else if(n)for(;i<s;i++)a.push(this.getNestedValue(o[i].data,e));else for(;i<s;i++)a.push(o[i].data[e]);else if(t.groupMap)if(this.groupMap={},n)for(;i<s;i++){var r=o[i],l=this.getNestedValue(r.data,e);a.push(l),this.groupMap[r.id]=l}else for(;i<s;i++){l=(r=o[i]).data[e];a.push(l),this.groupMap[r.id]=l}else if(n)for(;i<s;i++)a.push(this.getNestedValue(o[i].data||o[i],e));else for(;i<s;i++){var c=o[i].data||o[i];a.push(c[e])}return a},getNestedValue:function(e,t){var n=t.split(".");return 1<n.length?this.getNestedValue(e[n.shift(0,1)],n.join(".")):e[t]},changeDataView:function(e){var t,n=this,i=(e=e||{},[]),a={},o=0,s=n.data.length,r=!!n.filters,l=!!n.searches,c=n.data;if(r){if(e.stoppedFilter||e.doNotFired){if(n.paging&&"server"===n.pageType)return}else n.filterData();n.remoteFilter||(void 0===(c=n.filteredData)&&(c=n.data),s=c.length)}l&&(n.searchData(),s=(c=n.searchedData).length),n.dataViewIndexes={},n.dataViewMap={},n.paging&&(s=(o="server"===n.pageType?0:n.showPage*n.pageSize)+n.pageSize);var d,u=n.getTotal();if(s>n.data.length&&(s=n.data.length),r&&u<s&&(s=u),Fancy.isObject(n.data)&&(s=0),n.order)if(n.grouping)for(t=n.grouping.by;o<s;o++)n.expanded[n.data[n.order[o]].data[t]]&&(d=!0===r?(n.dataViewIndexes[i.length]=n.filterOrder[o],c[o]):(n.dataViewIndexes[i.length]=n.order[o],c[n.order[o]]),i.push(d),a[d.id]=i.length-1);else for(;o<s;o++)d=!0===r?(n.dataViewIndexes[i.length]=n.filterOrder[o],c[o]):(n.dataViewIndexes[i.length]=n.order[o],c[n.order[o]]),i.push(d),a[d.id]=i.length-1;else if(n.grouping)for(t=n.grouping.by;o<s;o++)n.expanded[n.data[o].data[t]]&&(d=c[n.dataViewIndexes[i.length]=o],i.push(d),a[d.id]=i.length-1);else for(;o<s;o++)d=c[n.dataViewIndexes[i.length]=o],i.push(c[o]),a[d.id]=i.length-1;n.dataView=i,n.dataViewMap=a,e.doNotFired||n.fire("change")},getColumnData:function(e,t){var n=0,i=this.data.length,a=[];if(t)for(;n<i;n++)a.push(t(this.data[n].data));else for(;n<i;n++)a.push(this.data[n].data[e]);return a},getData:function(){for(var e=0,t=this.data.length,n=[];e<t;e++)n.push(this.data[e].data);return n},getDataView:function(){for(var e=0,t=this.dataView.length,n=[];e<t;e++)n.push(this.dataView[e].data);return n},getById:function(e){return this.map[e]},changeItemId:function(e,t){var n=this.getById(e);if(!n)return!1;n.id=t,void 0!==n.data.id&&(n.data.id=t),delete this.map[e],this.map[t]=n,this.fire("changeitemid",e,t)},find:function(e,t,n){var i=this,a=i.dataView,o=0,s=a.length,r=[];if(n)for(s=i.data.length;o<s;o++)(i.order?i.data[i.order[o]]:i.data[o]).data[e]===t&&r.push(o);else for(;o<s;o++)a[o].data[e]===t&&r.push(o);return r},findItem:function(e,t){for(var n,i=this.data,a=0,o=i.length,s=[];a<o;a++)(n=i[a]).data[e]===t&&s.push(n);return s},getDataIndex:function(e){for(var t,n=this.data,i=0,a=n.length;i<a;i++)n[i].data.id===e&&(t=i);return t},each:function(e,t){var n=this.dataView,i=0,a=n.length;if(t)for(;i<a;i++)e.apply(this,[n[i]]);else for(;i<a;i++)e(n[i])},readSmartIndexes:function(){var e=this.widget,t=0,n={};Fancy.each(e.columns,function(e){e.smartIndexFn&&(n[e.index]=e.smartIndexFn,t++)}),t&&(this.smartIndexes=n)},destroy:function(){var e=this;Fancy.each(e.data,function(e){delete e.data,delete e.id}),e.data=[],e.map={},e.dataView=[],e.dataViewIndexes={},e.dataViewMap={}},addField:function(t){var e=this.fields,n=!1;Fancy.each(e,function(e){if(e===t)return n=!0}),n||this.fields.push(t)}}),Fancy.$=window.$||window.jQuery,Fancy.nojQuery=void 0===Fancy.$,Fancy.get=function(e){switch(Fancy.typeOf(e)){case"string":return new Fancy.Element(Fancy.$("#"+e)[0]);case"array":return new Fancy.Elements(e);default:return new Fancy.Element(e)}},Fancy.Element=function(e){this.dom=e,this.$dom=Fancy.$(e),this.length=1},Fancy.Element.prototype=(_Fancy$Element$protot={last:function(){return Fancy.get(this.$dom)},closest:function(e){return Fancy.get(this.$dom.closest(e)[0])},destroy:function(){this.$dom.remove()},remove:function(){this.$dom.remove()},finish:function(){this.$dom.finish()},prev:function(){return Fancy.get(this.$dom.prev()[0])},lastChild:function(){var e=this.$dom.children();return Fancy.get(e[e.length-1])},firstChild:function(){return Fancy.get(this.$dom.children()[0])},on:function(e,t,n,i){var a=this;switch(n&&(t=Fancy.$.proxy(t,n)),i?a.$dom.on(e,i,t):a.$dom.on(e,t),e){case"mouseenter":a.onTouchEnterEvent&&a.onTouchEnterEvent(e,t,n,i);break;case"mouseleave":a.onTouchLeaveEvent&&a.onTouchLeaveEvent(e,t,n,i);break;case"mousemove":a.onTouchMove&&a.onTouchMove("touchmove",t)}},once:function(e,t,n,i){n&&(t=Fancy.$.proxy(t,n)),i?this.$dom.one(e,i,t):this.$dom.one(e,t)},prop:function(e){return this.$dom.prop(e)},un:function(e,t,n,i){n&&(t=Fancy.$.proxy(t,n)),i?this.$dom.off(e,i,t):this.$dom.off(e,t)},show:function(){this.$dom.show()},hide:function(){this.$dom.hide()},replaceClass:function(e,t){this.$dom.removeClass(e),this.$dom.addClass(t)},getByTag:function(e){return Fancy.get(this.$dom.find(e)[0])},getByClass:function(e){return this.$dom.find("."+e)[0]},addClass:function(e){this.addCls.apply(this,arguments)},addCls:function(e){if(this.$dom.addClass(e),1<arguments.length)for(var t=1,n=arguments.length;t<n;t++)this.addClass(arguments[t])},removeClass:function(e){this.$dom.removeClass(e)},removeCls:function(e){this.$dom.removeClass(e)},hasClass:function(e){return this.$dom.hasClass(e)},hasCls:function(e){return this.$dom.hasClass(e)},toggleClass:function(e){this.$dom.toggleClass(e)},toggleCls:function(e){this.$dom.toggleClass(e)},select:function(e){var t=this.$dom.find(e);return 1===t.length?Fancy.get(t[0]):1<t.length?Fancy.get(t):0===t.length?{length:0,dom:void 0,addClass:function(){},addCls:function(){},removeClass:function(){},removeCls:function(){},destroy:function(){},remove:function(){},css:function(){},each:function(){},last:function(){},attr:function(){}}:t},css:function(e,t){return void 0===t?this.$dom.css(e):this.$dom.css(e,t)},attr:function(e,t){return void 0===t?this.$dom.attr(e):this.$dom.attr(e,t)},append:function(e){return Fancy.get(this.$dom.append(e)[0])},after:function(e){return Fancy.get(this.$dom.after(e)[0])},next:function(){return Fancy.get(this.$dom.next()[0])},insertAfter:function(e){return Fancy.get(this.$dom.insertAfter(e)[0])},before:function(e){return Fancy.get(this.$dom.before(e)[0])},height:function(e){return e?(this.$dom.height(e),this):this.$dom.height()},width:function(e){return e?(this.$dom.width(e),this):this.$dom.width()},parent:function(e){return Fancy.get(this.$dom.parent(e)[0])},update:function(e){this.dom.innerHTML=e},hover:function(e,t){e&&this.$dom.on("mouseenter",e),e&&this.$dom.on("mouseleave",t)},position:function(){return this.$dom.position()},offset:function(){return this.$dom.offset()},focus:function(){this.$dom.focus()},blur:function(){this.$dom.blur()},within:function(e){var t,n=!0,i=!1;return void 0!==(t=(e=Fancy.get(e)).attr("id"))&&""!==t||(t=Fancy.id(),i=!0),e.attr("id",t),0===this.select("#"+t).length&&(n=!1),this.dom.id===e.dom.id&&(n=!0),i&&this.removeAttr(t),n},removeAttr:function(e){this.$dom.removeAttr(e)},item:function(){return this},stop:function(){this.$dom.stop&&this.$dom.stop()},animate:function(e,t,n,i){var a={},o=!1,s=e.force;for(var r in Fancy.nojQuery||(s=o=!0),Fancy.isObject(e)&&delete e.force,e){var l=e[r];Fancy.isString(l)&&(l=Number(l.replace("px","")));var c=this.css(r);Fancy.isString(c)&&(c=Number(c.replace("px",""))),l!==c&&(a[r]=e[r],o=!0)}!1!==o&&(s?this.$dom.animate(a,t,n,i):this.$dom.css(a))}},_defineProperty(_Fancy$Element$protot,"stop",function(){this.$dom.stop&&this.$dom.stop()}),_defineProperty(_Fancy$Element$protot,"index",function(){return this.$dom.index()}),_defineProperty(_Fancy$Element$protot,"onTouchEnterEvent",function(e,f,y,g){var m=this,t=Fancy.get(document.body);if(Fancy.isTouch){t.on("touchmove",function(e,t){var n=Fancy.id(),i="fancy-tempt-attr";e=e.originalEvent||e;m.attr(i,n);for(var a=e.targetTouches[0],o=[a.pageX,a.pageY],s=Fancy.get(document.elementFromPoint(o[0]-document.body.scrollLeft,o[1]-document.body.scrollTop)),r=!1,l=10,c=s;0<l&&c.dom;){if(c.attr(i)===n){r=!0;break}c=c.parent(),l--}if(!r||m.touchIn||g||(e.pageX=a.pageX,e.pageY=a.pageY,f(e,t),m.touchIn=!0),r&&g){l=10,c=s;for(var d=[],u=0;0<l&&c.dom;){var h=c.select(g);if(0!==h.length){var p=m.getDelegateTarget(g,h,d,u);p&&(e.currentTarget=p,e.delegateTarget=p,e.pageX=a.pageX,e.pageY=a.pageY,m.touchIn=!0,m.touchInDelegate=m.touchInDelegate||{},void 0===m.touchInDelegate[g]?m.touchInDelegate[g]=p:m.touchInDelegate[g]!==p&&(m.touchInDelegate[g]=[m.touchInDelegate[g],p]),f.apply(y,[e,p]));break}if(c.attr(i)===n)break;d.push(c.dom),c=c.parent(),l--,u++}}m.removeAttr(i)})}}),_defineProperty(_Fancy$Element$protot,"onTouchLeaveEvent",function(e,p,t,f){var y=this,n=Fancy.get(document.body),g=[];if(Fancy.isTouch){n.on("touchmove",function(e,t){var n=Fancy.id(),i="fancy-tempt-attr";e=e.originalEvent||e;if(y.attr(i,n),!0===y.touchIn){var a=e.targetTouches[0],o=[a.pageX,a.pageY],s=Fancy.get(document.elementFromPoint(o[0]-document.body.scrollLeft,o[1]-document.body.scrollTop));if(!f){for(var r=!1,l=10,c=s;0<l&&c.dom;){if(c.attr(i)===n){r=!0;break}c=c.parent(),l--}if(!1===r)return e.pageX=a.pageX,e.pageY=a.pageY,y.touchIn=!1,p(e,t),void y.removeAttr(i)}if(30<g.length&&(g=g.slice(g.length-5,g.length-1)),g.push(s.dom),f&&y.touchInDelegate[f]){var d,u=Fancy.id();(d=Fancy.isArray(y.touchInDelegate[f])?Fancy.get(y.touchInDelegate[f][0]):Fancy.get(y.touchInDelegate[f])).attr(i,u);var h=!(l=10);for(c=s;0<l&&c.dom;){if(c.attr(i)===u){h=!0;break}c=c.parent(),l--}d.removeAttr(i),h||(delete y.touchInDelegate[f],y.touchIn=!1,e.currentTarget=d.dom,e.delegateTarget=d.dom,e.pageX=a.pageX,e.pageY=a.pageY,p(e,d.dom))}y.removeAttr(i)}else y.removeAttr(i)})}}),_defineProperty(_Fancy$Element$protot,"getDelegateTarget",function(e,t,n,i){for(var a=n[i-e.match(/\./g).length],o=0,s=t.length;o<s;o++)if(t.item(o).dom===a)return a;return!1}),_defineProperty(_Fancy$Element$protot,"onTouchMove",function(e,c,t){var d=this,n=Fancy.get(document.body);if(Fancy.isTouch){n.on("touchmove",function(e,t){var n=Fancy.id(),i="fancy-tempt-attr";e=e.originalEvent||e;d.attr(i,n);for(var a=e.targetTouches[0],o=[a.pageX,a.pageY],s=!1,r=10,l=Fancy.get(document.elementFromPoint(o[0]-document.body.scrollLeft,o[1]-document.body.scrollTop));0<r&&l.dom;){if(l.attr(i)===n){s=!0;break}l=l.parent(),r--}d.removeAttr(i),s&&(e.pageX=a.pageX,e.pageY=a.pageY,c(e,t))})}}),_defineProperty(_Fancy$Element$protot,"each",function(e){e(this,0)}),_Fancy$Element$protot),Fancy.Elements=function(e){this.dom=e,this.$dom=e,this.length=e.length},Fancy.Elements.prototype={attr:function(e,t){var n=this.$dom;return 1<this.length&&(n=this.$dom[0]),void 0===t?n.attr(e):n.attr(e,t)},addClass:function(e){this.addCls.apply(this,arguments)},finish:function(){for(var e=0,t=this.length;e<t;e++)Fancy.get(this.$dom[e]).finish()},addCls:function(e){for(var t=0,n=this.length;t<n;t++)Fancy.get(this.$dom[t]).addClass(e);if(1<arguments.length)for(t=1,n=arguments.length;t<n;t++)this.addClass(arguments[t])},removeClass:function(e){this.removeCls.apply(this,arguments)},removeCls:function(e){for(var t=0,n=this.length;t<n;t++)Fancy.get(this.$dom[t]).removeCls(e)},hover:function(e){this.$dom.on("mouseenter",e)},on:Fancy.Element.prototype.on,once:Fancy.Element.prototype.once,item:function(e){return Fancy.get(this.$dom[e])},css:function(e,t){for(var n=0,i=this.length;n<i;n++)Fancy.get(this.$dom[n]).css(e,t)},toggleClass:function(e){for(var t=0,n=this.length;t<n;t++)Fancy.get(this.$dom[t]).toggleClass(e)},toggleCls:function(e){for(var t=0,n=this.length;t<n;t++)Fancy.get(this.$dom[t]).toggleClass(e)},destroy:function(){for(var e=0,t=this.length;e<t;e++)Fancy.get(this.$dom[e]).destroy()},remove:function(){this.destroy()},hide:function(){for(var e=0,t=this.length;e<t;e++)Fancy.get(this.$dom[e]).hide()},show:function(){for(var e=0,t=this.length;e<t;e++)Fancy.get(this.$dom[e]).show()},index:function(){return this.$dom[0].index()},each:function(e){for(var t=0,n=this.length;t<n;t++)e(new Fancy.Element(this.$dom[t]),t)},last:function(){return new Fancy.Element(this.$dom[this.length-1])}},Fancy.select=function(e){return Fancy.get(document.body).select(e)},Fancy.onReady=function(e){Fancy.$(document).ready(e)},Fancy.Ajax=function(e){var t={};e.url&&(t.url=e.url),e.success&&(t.success=e.success),e.error&&(t.error=e.error),e.method&&(t.type=e.method),e.params&&(t.data=e.params),e.dataType&&(t.dataType=e.dataType),e.sendJSON&&(t.dataType="json",t.contentType="application/json; charset=utf-8",t.data=JSON.stringify(t.data)),e.getJSON&&(t.dataType="json",t.contentType="application/json; charset=utf-8"),e.headers&&(t.headers=e.headers),Fancy.$.ajax(t)},Fancy.i18n.en={paging:{first:"First Page",last:"Last Page",prev:"Previous Page",next:"Next Page",info:"Rows [0] - [1] of [2]",page:"Page",of:"of [0]"},loadingText:"Loading...",thousandSeparator:",",decimalSeparator:".",currencySign:"$",sourceText:"Source",date:{read:"m/d/Y",write:"m/d/Y",edit:"m/d/Y",today:"Today",startDay:0,days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],am:"am",pm:"pm",AM:"AM",PM:"PM",ok:"OK",cancel:"Cancel"},yes:"Yes",no:"No",dragText:"[0] selected row[1]",update:"Update",cancel:"Cancel",columns:"Columns",sortAsc:"Sort ASC",sortDesc:"Sort DESC",lock:"Lock",unlock:"Unlock",rightLock:"Right Lock"},Fancy.i18n["en-US"]=Fancy.i18n.en,Fancy.controllers={},Fancy.defineController=function(e,t){Fancy.controllers[e]=t},Fancy.defineControl=Fancy.defineController,Fancy.getController=function(e){return Fancy.controllers[e]},Fancy.getControl=Fancy.getController,Fancy.define("Fancy.DD",{extend:Fancy.Event,singleton:!0,constructor:function(e){this.Super("const",arguments),this.init()},init:function(){this.addEvents(),this.els={}},add:function(e){var t=Fancy.id(e.overEl);(this.els[t]=e).overEl.on("mousedown",this.onMouseDown,this)},onMouseDown:function(e){var t=this,n=Fancy.get(document),i=Fancy.get(e.currentTarget),a=t.els[i.attr("id")].dragEl;e.preventDefault(),t.clientX=e.clientX,t.clientY=e.clientY,t.startX=parseInt(a.css("left")),t.startY=parseInt(a.css("top")),t.activeId=i.attr("id"),n.once("mouseup",t.onMouseUp,t),n.on("mousemove",t.onMouseMove,t)},onMouseUp:function(){Fancy.get(document).un("mousemove",this.onMouseMove,this)},onMouseMove:function(e){var t=this,n=t.els[t.activeId].dragEl,i=e.clientX,a=e.clientY,o=t.clientX-i,s=t.clientY-a,r=t.startX-o,l=t.startY-s;l<0&&(l=0),n.css({left:r,top:l})}}),Fancy.define("Fancy.Widget",{extend:Fancy.Event,constructor:function(e){var t=this;Fancy.applyConfig(t,e),t.preInitControls(),t.Super("const",arguments),t.init(),t.initControls()},init:function(){this.initId(),this.addEvents("beforerender","afterrender","render","show","beforehide","hide","destroy"),this.initPlugins()},renderItems:function(i){var a=this;Fancy.each(a.items,function(e,t){var n=Fancy.getClassByType(e.type);e.renderTo=i,a.items[t]=new n(e)})},preInitControls:function(){var e=this,t=e.controller||e.controllers;if(t)switch(Fancy.typeOf(t)){case"string":for(var n in t=Fancy.getController(t))void 0===e[n]&&(e[n]=t[n]);break;case"array":for(var i=[],a=0,o=t.length;a<o;a++){var s=Fancy.getController(t[a]);for(var n in s)"controls"!==n?void 0===e[n]&&(e[n]=s[n]):i=i.concat(s.controls)}e.controls=i}},initControls:function(){var t=this;if(void 0!==t.controls)for(var e=t.controls,n=0,i=e.length;n<i;n++){var a=e[n];if(void 0===a.event)throw new Error("[FancyGrid Error]: - not set event name for control");if(void 0===a.handler)throw new Error("[FancyGrid Error]: - not set handler for control");var o=a.event,s=a.handler,r=a.scope||t,l=a.selector;Fancy.isString(s)&&(s=t[s]),l?function(e,s,r,l){t.$events[e]?t.on(e,function(e,t){var n=t.e.target,i=Fancy.get(n).parent().select(l);if(1===i.length&&i.within(n))s.apply(r,arguments);else if(1<i.length)for(var a=0,o=i.length;a<o;a++)i.item(a).within(n)&&s.apply(r,arguments)},r):t.on("render",function(){t.el.on(e,s,r,l)})}(o,s,r,l):void 0===l&&void 0===a.widget&&t.on(o,s,r)}},css:function(e,t){return this.el.css(e,t)},addClass:function(e){this.el.addCls(e)},addCls:function(e){this.el.addCls(e)},removeClass:function(e){this.el.removeCls(e)},removeCls:function(e){this.el.removeCls(e)},hasClass:function(e){return this.el.hasCls(e)},hasCls:function(e){return this.el.hasCls(e)},toggleClass:function(e){this.el.toggleCls(e)},toggleCls:function(e){this.el.toggleCls(e)},destroy:function(){this.el&&this.el.destroy()},show:function(){this.el.show()},hide:function(){this.el.hide()},initTpl:function(){this.tpl&&(this.tpl=new Fancy.Template(this.tpl))}}),Fancy.define("Fancy.Plugin",{extend:Fancy.Event,constructor:function(){this.Super("const",arguments),this.init()},init:function(){this.initId(),this.addEvents("beforerender","afterrender","render","show","hide","destroy")},initTpl:function(){var e=this.tpl;e&&(this.tpl=new Fancy.Template(e))}}),Tr={},Ur=Fancy,Vr=Ur.GRID_CLS,Wr=Ur.PANEL_BODY_CLS,Xr=Ur.BUTTON_CLS,Yr=Ur.BUTTON_DISABLED_CLS,Zr=Ur.BUTTON_PRESSED_CLS,$r=Ur.BUTTON_IMAGE_CLS,_r=Ur.BUTTON_IMAGE_COLOR_CLS,as=Ur.BUTTON_TEXT_CLS,bs=Ur.BUTTON_DROP_CLS,cs=Ur.BUTTON_MENU_CLS,Ur.define("Fancy.Button",{extend:Ur.Widget,minWidth:30,constructor:function(e,t){var n=this;e.toggleGroup&&(Tr[e.toggleGroup]=Tr[e.toggleGroup]||{active:!1,items:[]},Tr[e.toggleGroup].items.push(n)),n.scope=t||e.scope||n.scope||n,n.Super("const",arguments)},init:function(){var e=this;e.addEvents("click","mousedown","mouseup","mouseover","mouseout","pressedchange"),e.Super("init",arguments),e.style=e.style||{},e.initTpl(),e.render(),e.setOns()},setOns:function(){var e=this,t=e.el;t.on("click",e.onClick,e),t.on("mousedown",e.onMouseDown,e),t.on("mouseup",e.onMouseUp,e),t.on("mouseover",e.onMouseOver,e),t.on("mouseout",e.onMouseOut,e),e.tip&&t.on("mousemove",e.onMouseMove,e)},widgetCls:Xr,cls:"",extraCls:"",disabledCls:Yr,pressedCls:Zr,buttonImageCls:$r,buttonImageColorCls:_r,textCls:as,dropCls:bs,text:"",height:28,paddingTextWidth:5,imageWidth:20,rightImageWidth:20,pressed:!1,theme:"default",tpl:['<div class="'+$r+'"></div>','<a class="'+as+'">{text}</a>','<div class="'+bs+'" style="{dropDisplay}"></div>'],render:function(){var e,t=this,n=Ur.get(document.createElement("div")),i=0,a=7;switch(t.theme&&Fancy.themes[t.theme]&&(a=Fancy.themes[t.theme].config.charWidth),t.i18n){case"zh-CN":case"zh-TW":case"ja":case"ko":a=10}if(t.fire("beforerender"),t.wrapper&&t.renderWrapper(),e=Ur.get(t.renderTo||document.body).dom,t.width?i=t.width:!1!==t.text&&void 0!==t.text&&(i+=t.text.length*a+2*a),t.imageColor&&(t.imageCls=_r),i<t.minWidth&&(t.text&&t.text.length,i=t.minWidth),t.imageCls&&t.text&&(i+=t.imageWidth),t.menu&&(i+=t.rightImageWidth),n.addCls(Ur.cls,t.widgetCls,t.cls,t.extraCls),t.disabled&&n.addCls(Yr),t.menu&&n.addCls(cs),n.css({width:i+"px",height:t.height+"px"}),t.hidden&&n.css("display","none"),n.css(t.style||{}),n.update(t.tpl.getHTML({text:t.text||""})),t.imageCls){var o=n.select("."+$r);t.imageColor&&o.css("background-color",t.imageColor),o.css("display","block"),Ur.isString(t.imageCls)&&o.addCls(t.imageCls)}t.id&&n.attr("id",t.id),t.el=Ur.get(e.appendChild(n.dom)),t.disabled&&t.disable(),t.pressed&&t.setPressed(t.pressed),t.initToggle(),t.width=i,t.fire("afterrender"),t.fire("render")},renderWrapper:function(){var e=this,t=e.wrapper,n=Ur.get(e.renderTo||document.body).dom,i=Ur.get(document.createElement("div"));i.css(t.style||{}),i.addCls(t.cls||""),e.wrapper=Ur.get(n.appendChild(i.dom)),e.renderTo=e.wrapper.dom},initToggle:function(){if(!this.enableToggle)return!1},setPressed:function(e,t){var n=this;if(e){if(n.addCls(Zr),n.pressed=!0,n.toggleGroup){var i=Tr[n.toggleGroup].active;i&&i.setPressed(!1),Tr[n.toggleGroup].active=n}}else n.removeCls(Zr),n.pressed=!1;!1!==t&&n.fire("pressedchange",n.pressed)},toggle:function(){var e=!this.pressed;this.setPressed(e),this.pressed=e},onClick:function(e){var t=this,n=t.handler;t.fire("click"),!0!==t.disabled&&(n&&(Ur.isString(n)&&(n=t.getHandler(n)),t.scope?n.apply(t.scope,[t]):n(t)),t.enableToggle&&(t.toggleGroup?t.setPressed(!0):t.toggle()),t.menu&&(t.toggle(),t.toggleMenuShow(e)))},getHandler:function(e){return Ur.getWidget(this.el.closest("."+Wr).select("."+Vr).attr("id"))[e]||function(){throw new Error("[FancyGrid Error] - handler does not exist")}},onMouseDown:function(){this.fire("mousedown")},onMouseUp:function(){this.fire("mouseup")},onMouseOver:function(e){this.fire("mouseover"),this.tip&&this.renderTip(e)},renderTip:function(e){var t=this;t.tooltip&&t.tooltip.destroy(),t.tooltip=new Ur.ToolTip({text:t.tip}),t.tooltip.css("display","block"),t.tooltip.show(e.pageX+15,e.pageY-25)},onMouseOut:function(){this.fire("mouseout"),this.tooltip&&(this.tooltip.destroy(),delete this.tooltip)},setText:function(e,t){var n=this,i=n.el,a=7;switch(n.text=e,n.theme&&Fancy.themes[n.theme]&&(a=Fancy.themes[n.theme].config.charWidth),n.i18n){case"zh-CN":case"zh-TW":case"ja":case"ko":a=10}t||(t=0),t||(t+=e.length*a+2*a,n.imageColor&&(n.imageCls=_r),t<n.minWidth&&(n.text&&n.text.length,t=n.minWidth),n.imageCls&&n.text&&(t+=n.imageWidth),n.menu&&(t+=n.rightImageWidth)),n.css("width",t),i.select("."+as).update(e)},disable:function(){this.disabled=!0,this.addCls(Yr)},enable:function(){this.disabled=!1,this.removeCls(Yr)},onMouseMove:function(e){this.tip&&this.tooltip&&this.tooltip.show(e.pageX+15,e.pageY-25)},toggleMenuShow:function(e){var t=this,n=t.el.$dom.offset(),i=[n.left,n.top+t.el.$dom.height()];Ur.isArray(t.menu)?t.initMenu():t.menu.type||t.initMenu(),setTimeout(function(){t.menu.showAt(i[0],i[1])},100)},initMenu:function(){var e=this,t={theme:e.theme,events:[{hide:e.onMenuHide,scope:e}]};Ur.isObject(e.menu)?Ur.apply(t,e.menu):t.items=e.menu,e.menu=new Ur.Menu(t)},onMenuHide:function(){this.setPressed(!1)}}),Fancy.define("Fancy.SegButton",{extend:Fancy.Widget,constructor:function(e,t){this.scope=t,this.Super("const",arguments)},init:function(){var e=this;e.addEvents("toggle"),e.Super("init",arguments),e.style=e.style||{},e.render()},widgetCls:Fancy.SEG_BUTTON_CLS,cls:"",extraCls:"",text:"",render:function(){var e,n=this,t=Fancy.get(document.createElement("div"));n.fire("beforerender"),e=Fancy.get(n.renderTo||document.body).dom,t.addCls(Fancy.cls,n.widgetCls,n.cls,n.extraCls),n.hidden&&t.css("display","none"),n.el=Fancy.get(e.appendChild(t.dom)),Fancy.each(n.style,function(e,t){n.el.css(t,e)}),n.renderButtons(),n.fire("afterrender"),n.fire("render")},renderButtons:function(){for(var n=this,e=n.items,t=0,i=e.length,a=Fancy.id(null,"fancy-toggle-group-");t<i;t++){var o=e[t];o.renderTo=n.el.dom,!1!==n.allowToggle&&((o.enableToggle=!0)!==n.multiToggle&&(o.toggleGroup=a)),0===t?(o.style={"border-right-width":0,"border-top-right-radius":0,"border-bottom-right-radius":0},1===i&&delete o.style["border-right-width"]):o.style=1<t?{"border-left-width":0,"border-top-left-radius":0,"border-bottom-left-radius":0}:{"border-top-left-radius":0,"border-bottom-left-radius":0},2<e.length&&0!==t&&t!==i-1&&Fancy.apply(o.style,{"border-top-right-radius":0,"border-bottom-right-radius":0,"border-top-left-radius":0,"border-bottom-left-radius":0}),n.items[t]=new Fancy.Button(o),n.items[t].on("pressedchange",function(e,t){n.fire("toggle",e,t,n.getValues())})}},getValues:function(){for(var e=[],t=this.items,n=0,i=t.length;n<i;n++)e.push(t[n].pressed);return e},clear:function(e){for(var t=this.items,n=0,i=t.length;n<i;n++)t[n].setPressed(!1,e)},setItems:function(e){this.el.update(""),this.items=e,this.renderButtons()},setActiveItem:function(e,t){this.items[e].setPressed(!0,t)}}),Fancy.define("Fancy.toolbar.Tab",{extend:Fancy.Button,constructor:function(e){this.Super("const",arguments)},init:function(){this.Super("init",arguments)},cls:Fancy.BUTTON_CLS+" "+Fancy.TAB_TBAR_CLS,render:function(){this.Super("render",arguments)}}),eu=Fancy,fu=eu.FOOTER_STATUS_CLS,gu=eu.STATUS_SOURCE_TEXT_CLS,hu=eu.STATUS_SOURCE_LINK_CLS,iu=eu.FOOTER_SOURCE_CLS,Fancy.Mixin("Fancy.panel.mixin.PrepareConfig",{prepareConfigTheme:function(e,t){var n=e.theme||t.theme,i=Fancy.getTheme(n).config;return Fancy.isObject(n)&&(e.theme=n.name),Fancy.applyIf(e,i),e.theme&&(this.theme=e.theme),e},prepareConfigFooter:function(e){var t=e.footer,n=e.lang;if(t){var i=[];if(Fancy.isString(t.status)&&i.push({type:"text",text:t.status,cls:fu}),t.status&&t.source&&i.push("side"),Fancy.isString(t.source))i.push({type:"text",text:t.source,cls:iu});else if(Fancy.isObject(t.source)){var a=t.source.text,o=t.source.sourceText||n.sourceText;if(t.source.link){var s=t.source.link;s=s.replace("http://",""),a='<span class="'+gu+'">'+o+'</span>: <a class="'+hu+'" href="'+(s="http://"+s)+'">'+a+"</a>"}else a="<span>"+o+":</span> "+a;i.push({type:"text",text:a,cls:iu})}e.footer=i}return e},prepareConfigLang:function(e,t){var n=e.i18n||t.i18n,i=Fancy.Object.copy(Fancy.i18n[n]);if(e.lang){for(var a in e.lang)!1===Fancy.isObject(e.lang[a])&&(i[a]=e.lang[a]);for(var a in i.paging={},e.lang.paging&&Fancy.apply(i.paging,e.lang.paging),e.lang.paging)"paging"!==a&&(Fancy.isObject(a)||(i[a]=e.lang.paging[a]));i.date={},e.lang.date&&Fancy.apply(i.date,e.lang.date)}return e.lang=i,e}}),Fancy.Mixin("Fancy.panel.mixin.methods",{setTitle:function(e){this.panel&&this.panel.setTitle(e)},getTitle:function(){if(this.panel)return this.panel.getTitle()},setSubTitle:function(e){this.panel&&this.panel.setSubTitle(e)},getSubTitle:function(){if(this.panel)return this.panel.getSubTitle()}}),Fancy.Mixin("Fancy.panel.mixin.DD",{ddCls:Fancy.PANEL_DRAGGABLE_CLS,initDD:function(){this.addDDCls(),this.addDD()},addDDCls:function(){this.el.addCls(this.ddCls)},addDD:function(){Fancy.DD.add({dragEl:this.el,overEl:this.el.select("."+Fancy.PANEL_HEADER_CLS).item(0)})}}),Fancy.Mixin("Fancy.panel.mixin.Resize",{cornerResizeCls:"fancy-panel-resize-corner",resizeMaskCls:"fancy-panel-resize-mask",initResize:function(){this.activeResizeEl=void 0,this.renderResizeEls(),this.onsResizeEls()},renderResizeEls:function(){var e=this.el,t=Fancy.get(document.createElement("div"));t.addCls(this.cornerResizeCls),this.cornerResizeEl=Fancy.get(e.dom.appendChild(t.dom))},onResize:function(){var e=this;e.tbar&&e._tbar.applyScrollChanges(),e.subTBar&&e._subTBar.applyScrollChanges(),e.bbar&&e._bbar.applyScrollChanges(),e.footer&&e._footer.applyScrollChanges(),e.buttons&&e._buttons.applyScrollChanges()},onsResizeEls:function(){var e=this;Fancy.isTouch?e.cornerResizeEl.on("touchstart",e.onMouseDownResizeEl,e):e.cornerResizeEl.on("mousedown",e.onMouseDownResizeEl,e),e.on("resize",e.onResize,e)},onMouseDownResizeEl:function(e){var t=this,n=Fancy.get(document);if(e.preventDefault(),Fancy.nojQuery&&t.el.select("."+Fancy.GRID_ANIMATION_CLS).removeCls(Fancy.GRID_ANIMATION_CLS),Fancy.isTouch){var i=(e=e.originalEvent||e).changedTouches[0];n.once("touchend",t.onMouseUpResize,t),n.on("touchmove",t.onMouseMoveResize,t),t.renderResizeMask(),t.startClientX=i.clientX,t.startClientY=i.clientY}else n.once("mouseup",t.onMouseUpResize,t),n.on("mousemove",t.onMouseMoveResize,t),t.renderResizeMask(),t.startClientX=e.clientX,t.startClientY=e.clientY},onMouseUpResize:function(){var e=this,t=Fancy.get(document);delete e.activeResizeEl,e.resizeMaskEl.destroy(),delete e.startClientX,delete e.startClientY,t.un("mousemove",e.onMouseMoveResize,e),e.setWidth(e.newResizeWidth),e.setHeight(e.newResizeHeight),e.fire("resize",{width:e.newResizeWidth,height:e.newResizeHeight}),Fancy.nojQuery&&e.el.select(".fancy-grid").addCls(Fancy.GRID_ANIMATION_CLS)},onMouseMoveResize:function(e){var t=this,n=e.clientX,i=e.clientY;if(Fancy.isTouch){var a=(e=e.originalEvent||e).originalEvent.changedTouches[0];n=a.clientX,i=a.clientY}var o=t.startClientX-n,s=t.startClientY-i,r=t.startResizeWidth-o,l=t.startResizeHeight-s;e.preventDefault(),e.stopPropagation(),r<t.minWidth&&(r=t.minWidth),l<t.minHeight&&(l=t.minHeight),t.newResizeWidth=r,t.newResizeHeight=l,t.resizeMaskEl.css({width:r,height:l})},renderResizeMask:function(){var e=this,t=e.el,n=Fancy.get(document.createElement("div")),i=parseInt(t.css("top")),a=parseInt(t.css("left")),o=parseInt(t.css("width"))-4,s=parseInt(t.css("height"))-4,r=parseInt(t.css("z-index"));if(e.startResizeWidth=o,e.startResizeHeight=s,!e.window&&"absolute"!==t.css("position")){var l=t.offset();i=l.top,a=l.left}n.addCls(e.resizeMaskCls),n.css({left:a,top:i,width:o,height:s,"z-index":r}),e.resizeMaskEl=Fancy.get(document.body.appendChild(n.dom))}}),wv=Fancy,xv=wv.HIDDEN_CLS,yv=wv.MODAL_CLS,zv=wv.PANEL_CLS,Av=wv.PANEL_HEADER_CLS,Bv=wv.PANEL_SUB_HEADER_TEXT_CLS,Cv=wv.PANEL_HEADER_TEXT_CLS,Dv=wv.PANEL_HEADER_TOOLS_CLS,Ev=wv.PANEL_SUB_HEADER_CLS,Fv=wv.PANEL_BODY_CLS,Gv=wv.PANEL_BODY_INNER_CLS,Hv=wv.PANEL_TBAR_CLS,Iv=wv.PANEL_SUB_TBAR_CLS,Jv=wv.PANEL_BUTTONS_CLS,Kv=wv.PANEL_BBAR_CLS,Lv=wv.PANEL_HEADER_IMG_CLS,Mv=wv.PANEL_NOFRAME_CLS,Nv=wv.PANEL_SHADOW_CLS,Ov=wv.PANEL_FOOTER_CLS,Pv=wv.FIELD_PICKER_BUTTON_CLS,wv.define("Fancy.Panel",{extend:wv.Widget,barScrollEnabled:!0,tabScrollStep:50,mixins:["Fancy.panel.mixin.DD","Fancy.panel.mixin.Resize"],constructor:function(e){wv.apply(this,e),this.Super("constructor",arguments)},init:function(){var e=this;e.Super("init",arguments),e.addEvents("resize"),e.initTpl(),e.render(),e.draggable&&e.initDD(),e.resizable&&e.initResize(),e.window&&e.setActiveWindowWatcher()},cls:"",fieldCls:zv,value:"",width:300,height:200,titleHeight:30,subTitleHeight:30,barHeight:37,title:void 0,frame:!0,shadow:!0,draggable:!1,minWidth:200,minHeight:200,barContainer:!0,theme:"default",tpl:['<div style="height:{titleHeight}px;" class="'+Av+" "+xv+'">',"{titleImg}",'<div class="'+Cv+'">{title}</div>','<div class="'+Dv+'"></div>',"</div>",'<div style="height:{subTitleHeight}px;" class="'+Ev+" "+xv+'">','<div class="'+Bv+'">{subTitle}</div>',"</div>",'<div class="'+Fv+'">','<div class="'+Hv+" "+xv+'" style="height:{tbarHeight}px;"></div>','<div class="'+Iv+" "+xv+'" style="height:{subTBarHeight}px;"></div>','<div class="'+Gv+'"></div>','<div class="'+Kv+" "+xv+'" style="height:{bbarHeight}px;"></div>','<div class="'+Jv+" "+xv+'" style="height:{buttonsHeight}px;"></div>','<div class="'+Ov+" "+xv+'" style="height:{barHeight}px;"></div>',"</div>"],render:function(){var e=this,t=wv.get(e.renderTo||document.body),n=wv.get(document.createElement("div")),i=e.titleHeight,a=e.subTitleHeight;if(e.renderOuter&&(n=t),!t.dom)throw new Error("[FancyGrid Error 1] - Could not find renderTo element: "+e.renderTo);!0===e.window&&n.css({display:"none",position:"absolute"}),!1===e.frame&&n.addCls(Mv),n.addCls(wv.cls,e.cls,e.fieldCls),"default"!==e.theme&&n.addCls("fancy-theme-"+e.theme),e.shadow&&n.addCls(Nv),n.css({width:e.width+"px",height:e.height-0+"px"}),e.style&&n.css(e.style);var o="",s="";wv.isObject(e.title)?o=e.title.text:wv.isString(e.title)&&(o=e.title),wv.isObject(e.subTitle)?s=e.subTitle.text:wv.isString(e.subTitle)&&(s=e.subTitle);var r="";wv.isObject(e.title)&&e.title.imgCls&&(r='<div class="'+Lv+" "+e.title.imgCls+'"></div>'),n.update(e.tpl.getHTML({titleImg:r,barHeight:e.barHeight,subTBarHeight:e.subTBarHeight||e.barHeight,tbarHeight:e.tbarHeight||e.barHeight,bbarHeight:e.bbarHeight||e.barHeight,buttonsHeight:e.buttonsHeight||e.barHeight,titleHeight:i,subTitleHeight:a,title:o,subTitle:s})),wv.isObject(e.title)&&(e.title.style&&n.select("."+Av).css(e.title.style),e.title.cls&&n.select("."+Av).addCls(e.title.cls),e.title.tools&&(e.tools=e.title.tools)),wv.isObject(e.subTitle)&&(e.subTitle.style&&n.select("."+Ev).css(e.subTitle.style),e.subTitle.cls&&n.select("."+Ev).addCls(e.subTitle.cls)),e.title?n.select("."+Av).removeCls(xv):n.select("."+Fv).css("border-top-width","0px"),e.subTitle&&(n.select("."+Fv).css("border-top-width","0px"),n.select("."+Ev).removeCls(xv)),e.tbar&&n.select("."+Hv).removeCls(xv),e.subTBar&&n.select("."+Iv).removeCls(xv),e.bbar&&n.select("."+Kv).removeCls(xv),e.buttons&&n.select("."+Jv).removeCls(xv),e.footer&&n.select("."+Ov).removeCls(xv),e.renderOuter?e.el=n:(e.el=t.dom.appendChild(n.dom),e.el=wv.get(e.el)),e.modal&&0===wv.select(yv).length&&wv.get(document.body).append('<div class="'+yv+'" style="display: none;"></div>'),e.id&&!e.el.attr("id")&&e.el.attr("id",e.id),e.renderTools(),e.renderBars(),e.setHardBordersWidth()},setHardBordersWidth:function(){var e=this.panelBodyBorders;this.el.select("."+Fv).css({"border-top-width":e[0],"border-right-width":e[1],"border-bottom-width":e[2],"border-left-width":e[3]})},renderTools:function(){var n=this,e=n.tools;void 0!==e&&wv.each(e,function(e,t){e.renderTo=n.el.select("."+Dv).dom,n.tools[t]=new wv.Tool(e,n.scope||n)})},renderBars:function(){var e=this,t=!1,n=e.theme,i=this;e.items&&e.items[0]&&("grid"===e.items[0].type&&(t=!0),i=e.items[0]),e.bbar&&(e._bbar=new wv.Bar({el:e.el.select("."+Kv),items:e.bbar,height:e.bbarHeight||e.barHeight,barContainer:e.barContainer,barScrollEnabled:e.barScrollEnabled,tabScrollStep:e.tabScrollStep,scope:i,theme:n}),e.bbar=e._bbar.items),e.buttons&&(e._buttons=new wv.Bar({el:e.el.select("."+Jv),items:e.buttons,height:e.buttonsHeight||e.barHeight,barScrollEnabled:e.barScrollEnabled,tabScrollStep:e.tabScrollStep,scope:i,theme:n}),e.buttons=e._buttons.items),e.tbar&&(e._tbar=new wv.Bar({el:e.el.select("."+Hv),items:e.tbar,height:e.tbarHeight||e.barHeight,tabEdit:!e.subTBar&&t,barScrollEnabled:e.barScrollEnabled,tabScrollStep:e.tabScrollStep,scope:i,theme:n}),e.tbar=e._tbar.items),e.subTBar&&(e._subTBar=new wv.Bar({el:e.el.select("."+Iv),items:e.subTBar,height:e.subTBarHeight||e.barHeight,tabEdit:t,barScrollEnabled:e.barScrollEnabled,tabScrollStep:e.tabScrollStep,scope:i,theme:n}),e.subTBar=e._subTBar.items),e.footer&&(e._footer=new wv.Bar({disableScroll:!0,el:e.el.select("."+Ov),items:e.footer,height:e.barHeight,barScrollEnabled:e.barScrollEnabled,tabScrollStep:e.tabScrollStep,scope:i,theme:n}),e.footer=e._footer.items)},showAt:function(e,t){this.css({left:e+"px",display:"","z-index":1e3+wv.zIndex++}),void 0!==t&&this.css({top:t+"px"})},show:function(){var e=this;if(e.el.show(),!0===e.window){e.buttons&&e._buttons.checkScroll(),e.tbar&&e._tbar.checkScroll(),e.bbar&&e._bbar.checkScroll(),e.subTBar&&e._subTBar.checkScroll();var t=wv.getViewSize(),n=e.el.height(),i=e.el.width(),a=[],o=wv.getScroll(),s=o[0],r=o[1];a[0]=(t[1]-i)/2,a[1]=(t[0]-n)/2,a[0]<10&&(a[0]=10),a[1]<10&&(a[1]=10),e.css({left:a[0]+r+"px",top:a[1]+s+"px",display:"","z-index":1e3+wv.zIndex++}),e.modal&&wv.select("."+yv).css({display:"","z-index":1e3+wv.zIndex-2})}},hide:function(){this.css({display:"none"}),this.modal&&wv.select("."+yv).css("display","none"),wv.each(this.items||[],function(e){"combo"===e.type&&e.hideList()})},setTitle:function(e){this.el.select("."+Cv).update(e)},getTitle:function(){return this.el.select("."+Cv).dom.innerHTML},setSubTitle:function(e){this.el.select("."+Bv).update(e)},getSubTitle:function(){return this.el.select("."+Bv).dom.innerHTML},getHeight:function(){return parseInt(this.css("height"))},setWidth:function(e){this.items[0].setWidth(e)},setHeight:function(e){this.css("height",e),this.items[0].setHeight(e,!1)},setActiveWindowWatcher:function(){var t=this;t.el.on("mousedown",function(e){wv.get(e.target).hasCls(Pv)||(1e3+wv.zIndex-1>parseInt(t.css("z-index"))&&t.css("z-index",1e3+wv.zIndex++),wv.get(document.body).select(".fancy-active-panel").removeCls("fancy-active-panel"),t.el.addCls("fancy-active-panel"))})}}),Rw=Fancy,Sw=Rw.BUTTON_CLS,Rw.define("Fancy.Tool",{extend:Rw.Widget,constructor:function(e,t){this.scope=t,this.Super("const",arguments)},init:function(){var e=this;e.addEvents("click","mousedown","mouseup","mouseover","mouseout"),e.Super("init",arguments),e.style=e.style||{},e.render(),e.ons()},ons:function(){this.el.on("click",this.onClick,this)},cls:Sw,text:"",height:28,paddingTextWidth:5,render:function(){var e=this,t=Rw.get(e.renderTo||document.body).dom,n=document.createElement("div");e.fire("beforerender"),n.className="fancy-tool-button",n.innerHTML=e.text,e.el=Rw.get(t.appendChild(n)),e.fire("afterrender"),e.fire("render")},onClick:function(){var e=this;e.fire("click"),e.handler&&(e.scope?e.handler.apply(e.scope,[e]):e.handler(e))},setText:function(e){this.el.update(e)}}),fx=Fancy,gx=fx.PANEL_BODY_INNER_CLS,hx=fx.PANEL_GRID_INSIDE_CLS,ix=fx.TAB_WRAPPER_CLS,jx=fx.TAB_ACTIVE_WRAPPER_CLS,kx=fx.TAB_TBAR_ACTIVE_CLS,lx=fx.PANEL_TAB_CLS,mx=fx.PANEL_CLS,nx=fx.GRID_CLS,fx.define(["Fancy.panel.Tab","Fancy.Tab","FancyTab"],{extend:fx.Panel,constructor:function(e){Fancy.loadStyle(),this.prepareConfigTheme(e),this.prepareConfigSize(e),this.Super("const",arguments)},init:function(){var e=this;e.prepareTabs(),e.Super("init",arguments),e.setActiveTab(e.activeTab),e.ons()},activeTab:0,theme:"default",render:function(){var e=this;e.Super("render",arguments),Fancy.loadingStyle&&(e.el.css("opacity",0),e.intervalStyleLoad=setInterval(function(){Fancy.loadingStyle||(clearInterval(e.intervalStyleLoad),e.el.animate({opacity:1,force:!0}))},100)),e.panelBodyEl=e.el.select("."+gx).item(0),e.setPanelBodySize(),e.renderTabWrappers(),e.wrapped||e.el.addCls(hx),e.el.addCls(lx),e.rendered=!0},ons:function(){var e=this;e.responsive&&fx.$(window).bind("resize",function(){e.onWindowResize(),e.intWindowResize&&clearInterval(e.intWindowResize),e.intWindowResize=setTimeout(function(){e.onWindowResize(),delete e.intWindowResize,setTimeout(function(){e.onWindowResize()},300)},30)})},onWindowResize:function(){var e,t=this,n=t.renderTo;t.panel&&(n=t.panel.renderTo),((e=t.responsive?fx.get(n):t.panel?t.panel.el:fx.get(n)).hasClass(mx)||e.hasClass(nx))&&(e=e.parent());var i=e.width();if(void 0!==e.dom&&(0===i&&(i=e.parent().width()),t.responsive?t.setWidth(i):t.fitWidth,t.responsiveHeight)){var a=parseInt(e.height());0===a&&(a=parseInt(e.parent().height())),t.setHeight(a)}},setPanelBodySize:function(){var e=this,t=e.height,n=e.panelBodyBorders;e.title&&(t-=e.titleHeight),e.subTitle&&(t-=e.subTitleHeight,t+=n[2]),e.bbar&&(t-=e.bbarHeight||e.barHeight),e.tbar&&(t-=e.tbarHeight||e.barHeight),e.subTBar&&(t-=e.subTBarHeight||e.barHeight),e.buttons&&(t-=e.buttonsHeight||e.barHeight),e.footer&&(t-=e.barHeight),t-=n[0]+n[2],e.panelBodyEl.css({height:t}),e.panelBodyHeight=t,e.panelBodyWidth=e.width-n[1]-n[3]},prepareConfigTheme:function(e){var t=e.theme||this.theme,n=fx.getTheme(t).config;(this.wrapped||e.wrapped)&&(e.panelBodyBorders=[0,0,0,0],this.panelBodyBorders=[0,0,0,0]),fx.applyIf(e,n),fx.apply(this,e)},prepareConfigSize:function(e){var t,n=e.renderTo;void 0===e.width&&n&&(e.responsive=!0,t=Fancy.get(n),e.width=parseInt(t.width()))},prepareTabs:function(){for(var t=this,e=[],n=0,i=t.items.length;n<i;n++){var a=t.items[n],o={type:"tab"};a.tabTitle?o.text=a.tabTitle:a.title&&(o.text=a.title,delete a.title),o.handler=function(e){return function(){t.setActiveTab(e)}}(n),e.push(o)}t.tbar=e,t.tabs=e},renderTabWrappers:function(){var n=this;fx.each(n.items,function(e){var t=fx.get(document.createElement("div"));t.addCls(ix),e.renderTo=n.panelBodyEl.dom.appendChild(t.dom)})},setActiveTab:function(e){var t=this,n=t.el.select("."+ix),i=t.activeTab;if(0!==t.items.length){n.item(t.activeTab).removeCls(jx),t.activeTab=e,n.item(t.activeTab).addCls(jx);var a=t.items[t.activeTab];if(a.theme=t.theme,a.wrapped=!0,a.width=t.panelBodyWidth,a.height=t.panelBodyHeight,a.rendered)t.setActiveItemWidth(),t.setActiveItemHeight();else switch(a.type){case"form":t.items[t.activeTab]=new FancyForm(a);break;case"grid":t.items[t.activeTab]=new FancyGrid(a);break;case"tab":t.items[t.activeTab]=new FancyTab(a)}t.tabs&&(t.tbar[i].removeCls(kx),t.tbar[t.activeTab].addCls(kx))}},setWidth:function(e){this.width=e,this.css("width",e),this.setPanelBodySize(),this.setActiveItemWidth()},setHeight:function(e){this.height=e,this.css("height",e),this.setPanelBodySize(),this.setActiveItemHeight()},setActiveItemWidth:function(){this.items[this.activeTab].setWidth(this.panelBodyWidth)},setActiveItemHeight:function(){this.items[this.activeTab].setHeight(this.panelBodyHeight,!1)}}),FancyTab.get=function(e){var t=fx.get(e).select("."+lx).dom.id;return fx.getWidget(t)},!fx.nojQuery&&fx.$&&(fx.$.fn.FancyTab=function(e){return this.selector?e.renderTo=fx.$(this.selector)[0].id:e.renderTo=this.attr("id"),new FancyTab(e)}),ty=Fancy,uy=ty.GRID_CLS,vy=ty.GRID_CELL_CLS,wy=ty.BAR_CLS,xy=ty.BAR_CONTAINER_CLS,yy=ty.BAR_BUTTON_CLS,zy=ty.BAR_SEG_BUTTON_CLS,Ay=ty.BAR_LEFT_SCROLLER_CLS,By=ty.BAR_RIGHT_SCROLLER_CLS,Cy=ty.FIELD_LABEL_CLS,Dy=ty.FIELD_TEXT_CLS,Ey=ty.FIELD_TEXT_INPUT_CLS,Fy=ty.FIELD_SEARCH_CLS,Gy=ty.FIELD_SEARCH_LIST_CLS,Hy=ty.FIELD_SEARCH_PARAMS_LINK_CLS,Iy=ty.FIELD_SEARCH_PARAMED_CLS,Jy=ty.FIELD_SEARCH_PARAMED_EMPTY_CLS,Ky=ty.PICKER_MONTH_ACTION_BUTTONS_CLS,Ly=ty.CLEARFIX_CLS,ty.define("Fancy.Bar",{extend:ty.Widget,widgetCls:wy,containerCls:xy,cls:"",text:"",floating:"left",sideRight:3,scrolled:0,tabOffSet:5,tabScrollStep:50,barScrollEnabled:!0,constructor:function(e){ty.apply(this,e),this.init()},init:function(){var e=this;e.roles={},e.render(),e.barScrollEnabled&&(e.initScroll(),setTimeout(function(){e.checkScroll()},150))},render:function(){this.renderEl(),this.renderItems(),this.initTabEdit()},renderEl:function(){var e=this;if(!e.el){var t=ty.get(document.createElement("div"));t.addCls(e.widgetCls,e.cls),t.update(e.text),e.el=ty.get(e.renderTo.appendChild(t.dom)),e.style&&e.el.css(e.style)}var n=ty.get(document.createElement("div"));n.addCls(e.containerCls),e.containerEl=ty.get(e.el.dom.appendChild(n.dom))},renderItems:function(){for(var e=this,t=e.containerEl,n=e.items||[],i=0,a=n.length,o=!1,s=[],r=a-1,l=0;i<a;i++){var c=n[i];switch(o&&(c=n[r],r--),c.toggleGroup&&(c.enableToggle=!0),ty.isObject(c)&&(c.type=c.type||"button"),o&&(e.floating="right",c.style=c.style||{},c.style.right=l),ty.isObject(c)&&(c.renderTo=t.dom),c){case"|":var d={float:e.floating,"margin-right":"5px","margin-top":"6px","padding-left":"0px"};"right"===e.floating&&ty.applyIf(d,{right:"1px",position:"absolute"}),s.push(new ty.Separator({renderTo:t.dom,style:d}));continue;case"side":o=!0;continue;default:o?s[r]=e.renderItem(c):s.push(e.renderItem(c))}o&&(c.text?l+=7*c.text.length+5+5+5:c.width&&(l+=c.width+5),c.imageCls&&(c.imageWidth?l+=c.imageWidth:l+=20),l+=3)}e.items=s},renderItem:function(e){var t,n=this,i=n.containerEl,v=n.theme;switch(e.style=e.style||{},e.label=!1,e.padding=!1,e.theme=n.theme,ty.applyIf(e.style,{float:n.floating}),"right"===n.floating&&ty.applyIf(e.style,{right:n.sideRight,position:"absolute"}),!e.scope&&n.scope&&(e.scope=n.scope),e.type){case"wrapper":e.cls===Ky&&(i.destroy(),i=n.el);for(var a,o=i.append('<div class="'+(e.cls||"")+'"></div>').select("div").item(0),s=0,r=e.items.length,l=0;s<r;s++){a=e.items[s],ty.isObject(a)&&(a.type=a.type||"button"),a.renderTo=o.dom;var c=(t=n.renderItem(a)).el;s===r-1?c.css("margin-right","0px"):l+=parseInt(c.css("margin-right")),ty.nojQuery?l+=parseInt(c.width()):l+=parseInt(c.$dom.outerWidth()),l+=parseInt(c.css("margin-left"))}o.css("width",l);break;case void 0:case"button":e.extraCls=yy,e.scope=e.scope||n.scope,t=new ty.Button(e);break;case"segbutton":e.extraCls=zy,ty.applyIf(e.style,{"margin-right":"6px"}),t=new ty.SegButton(e);break;case"tab":t=new ty.toolbar.Tab(e);break;case"text":ty.applyIf(e.style,{"margin-right":"10px","padding-left":"0px","padding-top":"11px"}),ty.apply(e,{renderTo:i.dom,cls:e.cls||""}),t=new ty.bar.Text(e);break;case"combo":e.inputWidth=18,ty.applyIf(e.style,{"padding-left":"0px","margin-right":"8px","margin-top":"4px"}),ty.applyIf(e,{width:70}),t=new ty.Combo(e);break;case"date":e.inputWidth=18,ty.applyIf(e.style,{"padding-left":"0px","margin-right":"8px","margin-top":"4px"}),ty.applyIf(e,{width:100}),t=new ty.DateField(e);break;case"number":e.inputWidth=18,ty.applyIf(e.style,{"padding-left":"0px","margin-right":"8px","margin-top":"4px"}),ty.applyIf(e,{width:35}),t=new ty.NumberField(e);break;case"checkbox":ty.applyIf(e.style,{"padding-left":"0px","margin-right":"8px","margin-top":"4px"}),t=new ty.CheckBox(e);break;case"switcher":ty.applyIf(e.style,{"padding-left":"0px","margin-right":"8px","margin-top":"4px"}),ty.applyIf(e,{width:35}),t=new ty.Switcher(e);break;case"string":e.inputWidth=18,ty.applyIf(e.style,{"padding-left":"0px","margin-right":"8px","margin-top":"4px"}),ty.applyIf(e,{width:100}),t=new ty.StringField(e);break;case"search":e.inputWidth=18,e.events=e.events||[],e.events=e.events.concat([{enter:function(e,t){var n=ty.getWidget(e.el.parent().parent().parent().parent().select("."+uy).item(0).attr("id"));n.search(t),n.expander&&n.expander.reSet()}},{key:function(e,t){var n=this,i=ty.getWidget(e.el.parent().parent().parent().parent().select("."+uy).item(0).attr("id"));i.filter&&!1===i.filter.autoEnterDelay||(n.autoEnterTime||(n.autoEnterTime=new Date),n.intervalAutoEnter&&clearInterval(n.intervalAutoEnter),delete n.intervalAutoEnter,n.intervalAutoEnter=setInterval(function(){500<new Date-n.autoEnterTime&&(clearInterval(n.intervalAutoEnter),delete n.intervalAutoEnter,t=e.getValue(),i.search(t),i.expander&&i.expander.reSet())},200))}},{render:function(y){var g=this,m=!1;y.el.on("mouseenter",function(){m=!0},null,"."+Hy),y.el.on("mousedown",function(e){e.preventDefault()},null,"."+Hy),y.el.on("click",function(i){var e=!1,t=ty.getWidget(y.el.parent().parent().parent().parent().select("."+uy).attr("id")),n=t.columns||[],a=t.leftColumns||[],o=t.rightColumns||[],s=n.concat(a).concat(o),r=[],l=0,c=s.length,d=1;if(t.searching.items)ty.each(t.searching.items,function(e){r.push({inputLabel:" &nbsp;&nbsp;"+e.text,value:!0,name:e.index}),d+=t.fieldHeight});else for(;l<c;l++){var u=s[l],h=u.title;if(void 0===h&&(h=""),!1!==u.searchable){switch(u.type){case"color":case"combo":case"date":case"number":case"string":case"text":case"currency":break;default:continue}d+=t.fieldHeight,r.push({inputLabel:" &nbsp;&nbsp;"+h,value:!0,name:u.index})}}if(g.list){if("none"!==g.list.el.css("display"))return void g.list.el.css("display","none");e=!0}else g.list=new FancyForm({width:150,height:d,theme:v,defaults:{type:"checkbox",label:!1,style:{padding:"8px 16px 0px"}},items:r,cls:Gy,events:[{set:function(){t.searching.setKeys(g.list.get())}},{init:function(){setTimeout(function(){var e=g.list.el;e.on("mouseenter",function(){m=!0}),e.on("mouseleave",function(){m=!1,setTimeout(function(){!1===m&&g.list&&e.css("display","none")},750)});var t=ty.get(i.target).offset(),n=parseInt(y.el.css("height"));e.css({position:"absolute",top:t.top+n+20,left:t.left}),g.list.el.css("display","block"),e.animate({duration:200,top:t.top+n-1})},50)}}]});var p=ty.get(i.target).offset(),f=parseInt(y.el.css("height"));g.list&&g.list.el&&(g.list.css({position:"absolute",top:p.top+f+20,left:p.left}),e&&g.list.css("display","block"),g.list.el.animate({duration:200,top:p.top+f-1}))},null,"."+Hy),y.el.on("mouseleave",function(){m=!1,setTimeout(function(){!1===m&&g.list&&g.list.el.css("display","none")},750)},null,"."+Hy)}}]),ty.applyIf(e.style,{float:n.floating,"padding-left":"0px","margin-right":"8px","margin-top":"4px"});var d=Fy;e.paramsMenu&&(e.tpl=['<div class="'+Cy+'" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="'+Dy+'">','<input placeholder="{emptyText}" class="'+Ey+'" style="{inputWidth}" value="{value}">','<div class="'+Hy+'" style="">'+(e.paramsText||"&nbsp;")+"</div>","</div>",'<div class="'+Ly+'"></div>'],d+=" "+Iy,e.paramsText||(d+=" "+Jy)),ty.applyIf(e,{padding:!1,width:250,cls:d,emptyText:"Search"}),t=new ty.StringField(e)}return"right"===n.floating&&(n.sideRight+=t.width,n.sideRight+=7),e.role&&(n.roles[e.role]=t),t},initScroll:function(){var e=this;e.leftScroller=new ty.Button({imageCls:!0,renderTo:e.el.dom,cls:Ay,height:e.height+2,minWidth:20,paddingTextWidth:0,imageWidth:20,width:0,text:!1,style:{position:"absolute",left:-1,top:-1,display:"none"},listeners:[{click:e.onPrevScrollClick,scope:e}]}),e.rightScroller=new ty.Button({imageCls:!0,renderTo:e.el.dom,cls:By,height:e.height+2,minWidth:20,paddingTextWidth:0,imageWidth:20,width:0,text:!1,style:{position:"absolute",right:-1,top:-1,display:"none"},listeners:[{click:e.onNextScrollClick,scope:e}]})},getBarWidth:function(){return parseInt(this.el.css("width"))},getItemsWidth:function(){var t=0;return ty.each(this.items,function(e){"none"!==e.el.css("display")&&(t+=e.el.width(),t+=parseInt(e.el.css("margin-left")),t+=parseInt(e.el.css("margin-right")),t+=parseInt(e.el.css("padding-right")),t+=parseInt(e.el.css("padding-left")))}),t},onPrevScrollClick:function(){this.scrolled+=this.tabScrollStep,this.applyScrollChanges()},onNextScrollClick:function(){this.scrolled-=this.tabScrollStep,this.applyScrollChanges()},applyScrollChanges:function(){var e=this,t=e.getItemsWidth(),n=e.getBarWidth()-parseInt(e.leftScroller.el.css("width"))-parseInt(e.rightScroller.el.css("width")),i=t-n;if(t<n)return e.scrolled=0,e.leftScroller.el.hide(),e.rightScroller.el.hide(),void e.containerEl.animate({"margin-left":"0px"},ty.ANIMATE_DURATION);0<e.scrolled?(e.scrolled=0,e.leftScroller.disable(),e.rightScroller.enable()):e.scrolled<-i&&(e.scrolled=-i,e.leftScroller.enable(),e.rightScroller.disable()),e.leftScroller.el.show(),e.rightScroller.el.show(),e.containerEl.animate({"margin-left":e.scrolled+e.leftScroller.el.width()+e.tabOffSet+"px"},ty.ANIMATE_DURATION)},onDocMouseUp:function(){this.scrollInterval&&(clearTimeout(this.scrollInterval),delete this.scrollInterval)},checkScroll:function(){var e=this,t=e.getItemsWidth(),n=e.getBarWidth();e.disableScroll||(n<t?e.enableScroll():e.barScrollEnabled&&(e.leftScroller.el.hide(),e.rightScroller.el.hide()))},enableScroll:function(){var e=this;e.barScrollEnabled&&(e.leftScroller.el.show(),e.rightScroller.el.show(),0===e.scrolled&&(e.leftScroller.disable(),e.containerEl.css("margin-left",e.leftScroller.el.width()+e.tabOffSet+"px")))},initTabEdit:function(){var e=this;if(e.tabEdit)for(var t=e.items.length-1;-1<t;t--){var n=e.items[t];switch(n.type){case"number":case"string":case"date":return void n.on("tab",e.onTabLastInput,e)}}},onTabLastInput:function(e,t){var n=ty.getWidget(this.el.parent().select("."+uy).attr("id"));t.preventDefault(),n.leftColumns.length?setTimeout(function(){n.leftBody.el.select("."+vy).item(0).dom.click()},100):setTimeout(function(){n.body.el.select("."+vy).item(0).dom.click()},100)}}),Fancy.define("Fancy.Separator",{cls:Fancy.SEPARATOR_CLS,constructor:function(e){Fancy.apply(this,e),this.init()},init:function(){this.render()},render:function(){var e=this,t=Fancy.get(document.createElement("div"));t.addCls(e.cls),t.update("<div></div>"),e.el=Fancy.get(e.renderTo.appendChild(t.dom)),e.style&&e.el.css(e.style)}}),Fancy.define("Fancy.bar.Text",{extend:Fancy.Widget,widgetCls:Fancy.BAR_TEXT_CLS,cls:"",text:"",tipTpl:"{value}",constructor:function(e){Fancy.apply(this,e),this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.render(),this.ons()},render:function(){var e=this,t=Fancy.get(document.createElement("div"));t.addCls(e.widgetCls,e.cls),t.update(e.text),e.el=Fancy.get(e.renderTo.appendChild(t.dom)),e.style&&e.el.css(e.style),e.hidden&&e.el.css("display","none"),e.id&&e.el.attr("id",e.id),e.width&&e.el.css("width",e.width)},get:function(){return this.el.dom.innerHTML},getValue:function(){return this.get()},set:function(e){this.el.dom.innerHTML=e},ons:function(){var e=this,t=e.el;t.on("mouseover",e.onMouseOver,e),t.on("mouseout",e.onMouseOut,e),e.tip&&e.el.on("mousemove",e.onMouseMove,e)},onMouseMove:function(e){this.tip&&this.tooltip&&this.tooltip.show(e.pageX+15,e.pageY-25)},onMouseOver:function(e){this.fire("mouseover"),this.tip&&this.renderTip(e)},renderTip:function(e){var t=this,n="";if(t.tooltip&&t.tooltip.destroy(),!0===t.tip)t.tip=new Fancy.Template(t.tipTpl).getHTML({value:t.get()});else switch(Fancy.typeOf(t.tip)){case"function":n=t.tip(this,t.get,t.label||"");break;case"string":n=t.tpl.getHTML({value:t.get()})}t.tooltip?t.tooltip.update(n):t.tooltip=new Fancy.ToolTip({text:n}),t.tooltip.css("display","block"),t.tooltip.show(e.pageX+15,e.pageY-25)},onMouseOut:function(){this.fire("mouseout"),this.tooltip&&(this.tooltip.destroy(),delete this.tooltip)}}),Fancy.define(["Fancy.Form","FancyForm"],{extend:Fancy.Widget,mixins:["Fancy.form.mixin.Form",Fancy.panel.mixin.PrepareConfig,Fancy.panel.mixin.methods,"Fancy.form.mixin.PrepareConfig"],type:"form",theme:"default",i18n:"en",maxLabelNumber:11,minWidth:200,minHeight:200,barScrollEnabled:!0,scrollable:!1,constructor:function(e,t){var n=this;Fancy.isDom(e)?(t=t||{}).renderTo=e:t=e,t=t||{};var i=function(e){e&&Fancy.apply(t,e),t=n.prepareConfig(t,n),Fancy.applyConfig(n,t),n.Super("const",arguments)},a=function(){var e=t.i18n||n.i18n;!0===Fancy.loadLang(e,i)&&i({})};Fancy.loadStyle(),Fancy.modules.form||Fancy.fullBuilt||!1===Fancy.MODULELOAD||!1===Fancy.MODULESLOAD||!0===n.fullBuilt||!0===n.neededModules?a():Fancy.modules.grid?Fancy.loadModule("form",function(){a()}):n.loadModules(a,t)},loadModules:function(t,e){var n=this,o={form:!0};Fancy.modules=Fancy.modules||{},Fancy.nojQuery&&(o.dom=!0),Fancy.isTouch&&(o.touch=!0),e.url&&(o.ajax=!0);var i=function(e){if(e.menu)return o.menu=!0};Fancy.each(e.tbar,i),Fancy.each(e.bbar,i),Fancy.each(e.buttons,i),Fancy.each(e.subTBar,i);for(var a in function e(t){for(var n,i=0,a=t.length;i<a;i++)"combo"===(n=t[i]).type&&n.data&&n.data.proxy&&(o.ajax=!0),"date"===n.type&&(o.grid=!0,o.date=!0,o.selection=!0),n.items&&e(n.items)}(e.items||[]),n.neededModules={length:0},o)void 0===Fancy.modules[a]&&(n.neededModules[a]=!0,n.neededModules.length++);if(0===n.neededModules.length)return n.neededModules=!0,void t();var s=function(e){delete n.neededModules[e],0==--n.neededModules.length&&(n.neededModules=!0,t())};if(n.neededModules.dom)Fancy.loadModule("dom",function(){for(var e in delete n.neededModules.dom,n.neededModules.length--,n.neededModules)"length"!==e&&Fancy.loadModule(e,s)});else for(var a in n.neededModules)"length"!==a&&Fancy.loadModule(a,s)}}),FancyForm.get=function(e){var t=Fancy.get(e);if(t.dom){var n=t.select(".fancy-form").dom.id;return Fancy.getWidget(n)}},FancyForm.defineTheme=Fancy.defineTheme,FancyForm.defineController=Fancy.defineController,FancyForm.addValid=Fancy.addValid,!Fancy.nojQuery&&Fancy.$&&(Fancy.$.fn.FancyForm=function(e){return this.selector?e.renderTo=Fancy.$(this.selector)[0].id:e.renderTo=this.attr("id"),new Fancy.Form(e)}),RB=Fancy,SB=RB.FIELD_NOT_VALID_CLS,TB=RB.FIELD_LABEL_ALIGN_TOP_CLS,UB=RB.FIELD_TEXT_CLS,VB=RB.FIELD_LABEL_CLS,WB=RB.FIELD_TEXTAREA_TEXT_CLS,XB=RB.FIELD_LABEL_ALIGN_RIGHT_CLS,YB=RB.FIELD_DISABLED_CLS,RB.ns("Fancy.form.field"),RB.form.field.Mixin=function(){},RB.form.field.Mixin.prototype={padding:"8px 8px 0px 8px",inputHeight:29,labelHeight:18,failedValidCls:SB,cls:"",checkValidOnTyping:!1,editable:!0,ons:function(){var t=this,e=t.el,n=t.el.getByTag("input");if((t.input=n).on("blur",t.onBlur,t),n.on("focus",t.onFocus,t),n.on("input",t.onInput,t),n.on("keydown",t.onKeyDown,t),e.on("mouseenter",t.onMouseOver,t),e.on("mouseleave",t.onMouseOut,t),t.on("key",t.onKey,t),t.tip&&e.on("mousemove",t.onMouseMove,t),t.format&&t.format.inputFn){switch(t.value){case"":case void 0:break;default:t.formatValue(t.value)}t.on("key",t.onKeyInputFn)}t.stopPropagation&&e.on("mousedown",function(e){e.stopPropagation()}),e.on("mousedown",function(e){t.disabled&&(e.preventDefault(),e.stopPropagation())})},onKeyInputFn:function(e,t,n){var i=n.keyCode,a=RB.key;if(!this.disabled){switch(i){case a.ENTER:case a.ESC:case a.LEFT:case a.RIGHT:return}this.formatValue(t)}},formatValue:function(e){e=this.format.inputFn(e);var t=this.input.dom.selectionStart,n=this.input.dom.value;this.input.dom.value=e,n.length<e.length&&t++,this.setCaretPosition(t)},setCaretPosition:function(e){var t=this.input.dom;if(t.createTextRange){var n=t.createTextRange();n.move("character",e),n.select()}else t.selectionStart?(t.focus(),t.setSelectionRange(e,e)):t.focus()},onMouseOver:function(e){this.disabled||(this.fire("mouseover"),this.tip&&this.renderTip(e))},onMouseOut:function(e){var t=this;t.disabled||(t.fire("mouseout"),t.tip&&t.tooltip&&(t.tooltipToDestroy=!0,t.tooltip.destroy(),delete t.tooltip))},render:function(){var e=this,t=e.renderTo||document.body,n=e.renderAfter,i=e.renderBefore,a=RB.get(document.createElement("div"));RB.isString(t)&&((t=document.getElementById(t))||(t=RB.select(t).item(0))),e.fire("beforerender"),a.addCls(RB.cls,e.cls,e.fieldCls),a.attr("id",e.id);var o="",s="";e.itemsHTML&&(s=e.itemsHTML),"top"===e.labelAlign&&e.label&&e.labelWidth<7*e.label.length&&(e.labelWidth=7*(e.label.length+2)),e.labelWidth&&(o="width:"+e.labelWidth+"px;");var r=e.label;""===e.label?r="&nbsp;":void 0===e.label?r="&nbsp;":"right"!==e.labelAlign&&(r+=":");var l="",c="",d="";if(!1===e.label&&(l="display:none;"),e.inputLabel?d=e.inputLabel:c="display:none;","recaptcha"===e.type)a.update(e.tpl.getHTML({key:e.key}));else{var u={labelWidth:o,label:r,labelDisplay:l,inputLabelDisplay:c,inputLabel:d,emptyText:e.emptyText,value:e.value,height:e.height,itemsHTML:s,errorTextStyle:"",buttonText:e.buttonText};"set"===e.type&&delete u.height,a.update(e.tpl.getHTML(u))}if(e.el=a,e.setStyle(),!0===e.renderId&&a.attr("id",e.id),n?a=(n=RB.get(n)).after(a.dom.outerHTML).next():i?a=i.before(a.dom.outerHTML).prev():t.appendChild(a.dom),e.el=a,"textarea"===e.type?e.input=e.el.getByTag("textarea"):e.input=e.el.getByTag("input"),e.name&&(e.input.name=e.name),e.setSize(),"top"===e.labelAlign)e.el.addCls(TB),e.el.select("."+UB).css("float","none");else if("right"===e.labelAlign)switch(e.el.addCls(XB),e.type){case"radio":RB.$(a.dom).find("."+VB).insertAfter(RB.$(a.dom).find("."+UB+":last")),RB.$(a.dom).find("."+VB).css("float","right");break;case"textarea":RB.$(a.dom).find("."+VB).insertAfter(RB.$(a.dom).find("."+WB));break;case"checkbox":RB.$(a.dom).find("."+VB).css("float","right");break;default:RB.$(a.dom).find("."+VB).insertAfter(RB.$(a.dom).find("."+UB))}else e.type;if(e.acceptedValue=e.value,e.fire("afterrender"),e.fire("render"),"recaptcha"!==e.type&&"chat"!==e.type&&setTimeout(function(){e.input&&e.input.dom&&0===e.input.dom.value.length&&void 0===e.prevColor&&(e.prevColor=e.input.css("color"))},1),e.disabled){switch(e.type){case"hidden":break;default:e.addCls(YB)}e.input&&e.input.attr("tabIndex",-1)}else e.input&&e.tabIndex&&e.input.attr("tabIndex",e.tabIndex)},onKeyDown:function(e){var t=this,n=e.keyCode,i=RB.key;if(t.fire("beforekey",t.input.dom.value,e),!t.disabled){switch(n){case i.BACKSPACE:case i.DELETE:switch(t.type){case"field.number":case"field.string":case"field.date":setTimeout(function(){""===t.getValue()&&t.fire("empty")},1)}break;case i.TAB:t.fire("tab",e);break;case i.ENTER:t.fire("enter",t.getValue()),"textarea"!==t.type&&(e.preventDefault(),e.stopPropagation());break;case i.UP:switch(t.type){case"number":case"field.number":this.spin&&t.spinUp()}t.fire("up",t.getValue()),"textarea"!==t.type&&(e.preventDefault(),e.stopPropagation());break;case i.DOWN:switch(t.type){case"number":case"field.number":this.spin&&t.spinDown()}t.fire("down",t.getValue()),"textarea"!==t.type&&(e.preventDefault(),e.stopPropagation());break;case i.LEFT:case i.RIGHT:e.stopPropagation();break;default:setTimeout(function(){t.input&&(0===t.input.dom.value.length?(void 0===t.prevColor&&(t.prevColor=t.input.css("color")),t.input.css("color","grey")):t.prevColor?t.input.css("color",t.prevColor):t.input.css("color"," "))},1)}setTimeout(function(){t.fire("key",t.input.dom.value,e)},1)}},onKey:function(e,t){e.disabled||e.isValid()&&!e.checkValidOnTyping||e.validate(t)},onBlur:function(){var e=this;if(e.disabled)return!0;if(e.fire("blur"),e.input){if("combo"!==e.type)return e.validate(e.input.dom.value);setTimeout(function(){e.listItemClicked||e.validate(e.input.dom.value)},100)}return!0},validate:function(e){var t=this.vtype;if(void 0===t)return!0;var n=RB.isValid(t,e);return!0!==n?(this.errorText=new RB.Template(n.text).getHTML(n),this.failedValid(),!1):(this.successValid(),!0)},isValid:function(){return!this.hasCls(this.failedValidCls)},onFocus:function(e){this.disabled||!1===this.editable?this.input.blur():this.fire("focus")},blur:function(){this.input.blur()},onInput:function(){var e=this,t=e.getValue(),n=e.acceptedValue;e.disabled||(e.acceptedValue=e.get(),e.fire("input",t),e.fire("change",t,n))},get:function(){var e=this;if(e.format)if(RB.isString(e.format));else{if(!RB.isObject(e.format))return e.value;if(e.format.inputFn&&("number"===e.type||"field.number"===e.type))return isNaN(parseFloat(e.value))?e.value:Number(e.value)}return e.input.dom.value},getValue:function(){return this.get()},set:function(e,t){var n=this;n.value=e,n.format&&n.format.inputFn?n.formatValue(e):n.input.dom.value=e,!1!==t&&n.onInput(),n.validate(e)},setLabel:function(e){this.el.select("."+VB).update(e)},setValue:function(e,t){this.set(e,t)},clear:function(){this.set(""),this.clearValid()},failedValid:function(){var t=this;t.hasCls(t.failedValidCls)?t.tooltip&&t.errorText&&t.tooltip.update(t.errorText):(!t.tooltip&&t.errorText&&(t.showErrorTip(),t.el.on("mousemove",t.onMouseMove,t),t.input.hover(function(e){t.errorText&&(t.showErrorTip(),t.tooltip.show(e.pageX+15,e.pageY-25))},function(){t.hideErrorTip()})),t.addCls(t.failedValidCls))},clearValid:function(){this.removeCls(this.failedValidCls)},successValid:function(){this.removeCls(this.failedValidCls),this.hideErrorTip(),delete this.errorText},showErrorTip:function(){this.tooltip||(this.tooltip=new RB.ToolTip({text:this.errorText}))},hideErrorTip:function(){this.tooltip&&(this.tooltip.destroy(),delete this.tooltip)},setInputSize:function(e){var t=this;"combo"===t.type&&t.inputContainer.css("width",e.width),e.width&&t.input.css("width",e.width),e.height&&"set"!==t.type&&t.input.css("height",e.height)},focus:function(){var e=this;e.input.focus(),setTimeout(function(){e.input.dom.selectionStart=e.input.dom.selectionEnd=1e4},0)},hide:function(){this.fire("beforehide"),this.css("display","none"),this.fire("hide")},show:function(){this.css("display","block")},setSize:function(e,t){var n=this;if(n.type,void 0===e&&void 0===t)e=n.width,t=n.height;else if(void 0===t){var i=e;e=i.width?i.width:n.width,t=i.height?i.height:n.height}n.size?n.size({width:e,height:t}):(void 0!==e&&n.css("width",e),"top"===n.labelAlign?n.css("height",1.5*t):("set"!==n.type&&n.css("height",t),n.label&&n.el.select("."+VB).css("height",n.inputHeight)),n.setInputSize({width:n.inputWidth,height:n.inputHeight}))},setStyle:function(){var e=this,t=e.style||{},n=e.padding;n?(RB.isNumber(n)?n+="px":RB.isString(n),void 0===t.padding&&(t.padding=n)):t.padding="0px",e.hidden&&e.css("display","none"),e.css(t)},preRender:function(){var e=this;e.tpl&&!1===RB.isObject(e.tpl)&&(e.tpl=new RB.Template(e.tpl)),e.calcSize()},calcSize:function(){var e,t,n,i,a=this,o=a.inputHeight,s=a.padding;if(RB.isString(s))switch(s=s.replace(/px/g,""),s=s.split(" "),s.length){case 1:s=[t=Number(s[0]),t,t,t];break;case 2:s=[n=Number(s[0]),i=Number(s[1]),n,i];break;case 3:s=[n=Number(s[0]),i=Number(s[1]),Number(s[2]),n];break;case 4:s=[Number(s[0]),Number(s[1]),Number(s[2]),Number(s[3])]}else RB.isNumber(s)?s=[s,s,s,s]:!1===s&&(s=[0,0,0,0]);"top"===a.labelAlign&&(a.height*=1.5),e=a.width,"top"!==a.labelAlign&&a.label&&(e-=a.labelWidth),a.height===a.inputHeight&&!1!==a.padding&&(o-=s[0]+s[2]),"radio"!==a.type||a.column||(a.calcColumns(),1!==a.rows&&(o=(o-s[0]-s[2])*a.rows)),a.inputHeight=o,a.inputWidth=e-s[1]-s[3],a.height=o+s[0]+s[2]},setWidth:function(e){var t=this;t.width=e,t.calcSize(),t.css("width",e),t.setInputSize({width:t.inputWidth})},onMouseMove:function(e){var t=this,n=t.widget;if(!t.disabled){if(delete t.tooltipToDestroy,n){if(n.startResizing&&t.tooltip)return void t.tooltip.destroy();if(n.columndrag&&"dragging"===n.columndrag.status)return void t.tooltip.destroy()}t.tooltip?t.tooltip.show(e.pageX+15,e.pageY-25):t.tip&&t.renderTip(e)}},renderTip:function(e){var t,n=this,i="",a=n.tip||n.tooltip;if(n.getValue)switch(n.type){case"button":case"field.button":i="";break;default:i=n.getValue()}switch(Fancy.typeOf(a)){case"function":t=a(this,i,n.label||"");break;case"string":t=new RB.Template(a).getHTML({value:i})}n.tooltip?n.tooltip.update(t):n.tooltip=new RB.ToolTip({text:t}),n.tooltip.show(e.pageX+15,e.pageY-25)},getInputSelection:function(){var e,t,n,i,a,o=0,s=0,r=this.input.dom;return"number"==typeof r.selectionStart&&"number"==typeof r.selectionEnd?(o=r.selectionStart,s=r.selectionEnd):(t=document.selection.createRange())&&t.parentElement()==r&&(i=r.value.length,e=r.value.replace(/\r\n/g,"\n"),(n=r.createTextRange()).moveToBookmark(t.getBookmark()),(a=r.createTextRange()).collapse(!1),-1<n.compareEndPoints("StartToEnd",a)?o=s=i:(o=-n.moveStart("character",-i),o+=e.slice(0,o).split("\n").length-1,-1<n.compareEndPoints("EndToEnd",a)?s=i:(s=-n.moveEnd("character",-i),s+=e.slice(0,s).split("\n").length-1))),{start:o,end:s}},enable:function(){var e=this;e.disabled=!1,e.removeCls(YB),e.button&&e.button.enable(),e.input&&e.input.attr("tabIndex",e.tabIndex||0)},disable:function(){var e=this;e.disabled=!0,e.addCls(YB),e.button&&e.button.disable(),e.input&&e.input.attr("tabIndex",-1)},getInputValue:function(){return this.input.dom.value},clearInput:function(){this.input&&(this.input.dom.value="")}},Fancy.define(["Fancy.form.field.String","Fancy.StringField"],{mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,type:"field.string",constructor:function(e){Fancy.apply(this,e),this.Super("const",arguments)},init:function(){var e=this;e.addEvents("focus","blur","input","enter","up","down","tab","change","key","empty"),e.Super("init",arguments),e.preRender(),e.render(),e.ons(),e.isPassword&&(e.input.attr({type:"password"}),e.showPassTip&&(e.el.select(".fancy-field-text").item(0).append('<div class="fancy-field-pass-tip">abc</div>'),e.passTipEl=e.el.select(".fancy-field-pass-tip").item(0),e.passTipEl.on("mousedown",function(e){e.preventDefault()}),e.passTipEl.on("click",function(){"password"!==e.input.attr("type")?(e.passTipEl.update("abc"),e.input.attr("type","password"),e.passTipEl.css("line-height","22px")):(e.passTipEl.update("***"),e.input.attr("type",""),e.passTipEl.css("line-height","28px"))}))),e.hidden&&e.css("display","none"),e.style&&e.css(e.style)},fieldCls:Fancy.FIELD_CLS,value:"",width:100,emptyText:"",tpl:['<div class="fancy-field-label" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="fancy-field-text">','<input placeholder="{emptyText}" class="fancy-field-text-input" style="{inputWidth}" value="{value}">','<div class="fancy-field-error" style="{errorTextStyle}"></div>',"</div>",'<div class="fancy-clearfix"></div>']}),PE=Fancy.CLEARFIX_CLS,QE=Fancy.FIELD_CLS,RE=Fancy.FIELD_LABEL_CLS,SE=Fancy.FIELD_ERROR_CLS,TE=Fancy.FIELD_TEXT_CLS,UE=Fancy.FIELD_TEXT_INPUT_CLS,VE=Fancy.FIELD_SPIN_CLS,WE=Fancy.FIELD_SPIN_UP_CLS,XE=Fancy.FIELD_SPIN_DOWN_CLS,Fancy.define(["Fancy.form.field.Number","Fancy.NumberField"],{mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,type:"field.number",allowBlank:!0,constructor:function(e){Fancy.apply(this,e),this.Super("const",arguments)},init:function(){var e=this;e.addEvents("focus","blur","input","enter","up","down","tab","change","key","empty"),e.Super("init",arguments),e.preRender(),e.render(),e.ons(),e.hidden&&e.css("display","none"),e.initSpin()},fieldCls:QE,value:"",width:100,emptyText:"",step:1,tpl:['<div class="'+RE+'" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="'+TE+'">','<input placeholder="{emptyText}" class="'+UE+'" style="{inputWidth}" value="{value}">','<div class="'+VE+'">','<div class="'+WE+'"></div>','<div class="'+XE+'"></div>',"</div>",'<div class="'+SE+'" style="{errorTextStyle}"></div>',"</div>",'<div class="'+PE+'"></div>'],onInput:function(){var e=this,t=e.input,n=e.get(),i=e.acceptedValue;if(e.isValid()){for(var a=t.dom.value,o="",s=0,r=a.length;s<r;s++)switch(a[s]){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":case"+":case".":o+=a[s]}isNaN(Number(o))||(n=e.value=o)}e.acceptedValue=Number(e.get()),e.fire("input",n),e.fire("change",Number(n),Number(i))},isNumber:function(e){return""===e||"-"===e||Fancy.isNumber(+e)},checkMinMax:function(e){return""===e||"-"===e||(e=+e)>=this.min&&e<=this.max},setMin:function(e){this.min=e},setMax:function(e){this.max=e},initSpin:function(){var e=this;!0===e.spin&&(e.el.select("."+VE).css("display","block"),e.el.select("."+WE).on("mousedown",e.onMouseDownSpinUp,e),e.el.select("."+XE).on("mousedown",e.onMouseDownSpinDown,e))},onMouseDownSpinUp:function(e){var t=this,n=Fancy.get(document),i=700,a=new Date;t.disabled||(e.preventDefault(),t.mouseDownSpinUp=!0,t.spinUp(),t.spinInterval=setInterval(function(){t.mouseDownSpinUp=!1,new Date-a>i&&(700===i&&(i=150),a=new Date,t.spinUp(),--i<20&&(i=20))},20),n.once("mouseup",function(){clearInterval(t.spinInterval)}),t.focus())},onMouseDownSpinDown:function(e){var t=this,n=Fancy.get(document),i=700,a=new Date;t.disabled||(e.preventDefault(),t.mouseDownSpinDown=!0,t.spinDown(),t.spinInterval=setInterval(function(){t.mouseDownSpinDown=!1,new Date-a>i&&(700===i&&(i=150),a=new Date,t.spinDown(),--i<20&&(i=20))},20),n.once("mouseup",function(){clearInterval(t.spinInterval)}),t.focus())},spinUp:function(){var e=this,t=+e.get()+e.step;Fancy.Number.isFloat(e.step)&&(t=Fancy.Number.correctFloat(t)),isNaN(t)&&(t=e.min||0),void 0!==e.max&&t>e.max?t=e.max:t<e.min&&(t=e.min),e.set(t)},spinDown:function(){var e=this,t=+e.get()-e.step;Fancy.Number.isFloat(e.step)&&(t=Fancy.Number.correctFloat(t)),isNaN(t)&&(t=e.min||0),void 0!==e.min&&t<e.min?t=e.min:t>e.max&&(t=e.max),e.set(t)}}),Fancy.define(["Fancy.form.field.Text","Fancy.TextField"],{mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,type:"field.text",constructor:function(e){Fancy.apply(this,e),this.Super("const",arguments)},init:function(){var e=this;e.Super("init",arguments),e.preRender(),e.render(),e.hidden&&e.css("display","none"),e.style&&e.css(e.style)},fieldCls:Fancy.FIELD_CLS+" fancy-field-field-text",value:"",width:100,emptyText:"",tpl:['<div class="fancy-field-label" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="fancy-field-text">','<div class="fancy-field-text-value">{value}</div>','<div class="fancy-field-error" style="{errorTextStyle}"></div>',"</div>",'<div class="fancy-clearfix"></div>'],set:function(e){this.el.select(".fancy-field-text-value").item(0).update(e)}}),Fancy.define(["Fancy.form.field.Empty","Fancy.EmptyField"],{mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,type:"field.empty",constructor:function(e){Fancy.apply(this,e),this.Super("const",arguments)},init:function(){var e=this;e.addEvents(),e.Super("init",arguments),e.preRender(),e.render(),e.style&&e.css(e.style)},ons:function(){},fieldCls:Fancy.FIELD_CLS+" "+Fancy.FIELD_EMPTY_CLS,width:100,tpl:['<div class="fancy-field-label" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="fancy-field-text">','<div class="fancy-field-error" style="{errorTextStyle}"></div>',"</div>",'<div class="fancy-clearfix"></div>']}),XF=Fancy,YF=XF.FIELD_CLS,ZF=XF.FIELD_TEXTAREA_CLS,$F=XF.FIELD_LABEL_CLS,_F=XF.FIELD_TEXTAREA_TEXT_CLS,aG=XF.FIELD_TEXTAREA_TEXT_INPUT_CLS,bG=XF.FIELD_ERROR_CLS,cG=XF.CLEARFIX_CLS,XF.define(["Fancy.form.field.TextArea","Fancy.TextArea"],{mixins:[XF.form.field.Mixin],extend:XF.Widget,type:"field.textarea",constructor:function(){this.Super("const",arguments)},init:function(){var e=this;e.addEvents("change","key"),e.Super("init",arguments),e.preRender(),e.render(),e.ons()},fieldCls:YF+" "+ZF,value:"",width:250,height:100,labelWidth:60,inputWidth:180,minHeight:100,maxHeight:210,lineHeight:12.5,emptyText:"",tpl:['<div class="'+$F+'" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="'+_F+'">','<textarea autocomplete="off" placeholder="{emptyText}" type="text" class="'+aG+'" style="{inputWidth}height:{inputHeight}px;">{value}</textarea>','<div class="'+bG+'" style="{errorTextStyle}"></div>',"</div>",'<div class="'+cG+'"></div>'],ons:function(){var t=this,e=t.el,n=t.el.getByTag("textarea");(t.input=n).on("blur",t.onBlur,t),n.on("focus",t.onFocus,t),n.on("input",t.onInput,t),n.on("keydown",t.onKeyDown,t),t.on("key",t.onKey,t),t.autoHeight&&n.on("input",t.onChange,t),n.on("mousedown",function(e){t.disabled&&e.preventDefault()}),e.on("mouseenter",t.onMouseOver,t),e.on("mouseleave",t.onMouseOut,t),t.tip&&e.on("mousemove",t.onMouseMove,t)},preRender:function(){var e=this;e.tpl&&(e.tpl=new XF.Template(e.tpl)),e.initHeight(),e.calcSize()},initHeight:function(){var e,t=this;if(t.height)e=t.height,t.maxHeight<t.height&&setTimeout(function(){t.input.css({"overflow-y":"scroll"})},1);else if(t.value){var n=t.value.match(/\n/g);e=(n=n?n.length:1)*t.lineHeight}else e=t.height;e<t.minHeight||e>t.maxHeight&&setTimeout(function(){t.input.css({"overflow-y":"scroll"})},1),t.height=e,t.inputHeight=e},calcSize:function(){var e,t,n,i,a=this,o=a.padding;if(XF.isString(o))switch(o=o.replace(/px/g,""),o=o.split(" "),o.length){case 1:o=[t=Number(o[0]),t,t,t];break;case 2:o=[n=Number(o[0]),i=Number(o[1]),n,i];break;case 3:o=[n=Number(o[0]),i=Number(o[1]),Number(o[2]),n];break;case 4:o=[Number(o[0]),Number(o[1]),Number(o[2]),Number(o[3])]}else XF.isNumber(o)?o=[o,o,o,o]:!1===o&&(o=[0,0,0,0]);"top"===a.labelAlign&&(a.inputHeight-=40),e=a.width,"top"!==a.labelAlign&&a.label&&(e-=a.labelWidth),a.height===a.inputHeight&&!1!==a.padding&&(a.inputHeight-=o[0]+o[2]),a.inputWidth=e-o[1]-o[3],a.height=a.inputHeight+o[0]+o[2]},onChange:function(){var e=this,t=e.input.dom.value,n=e.el.getByTag("textarea"),i=t.match(/\n/g).length*e.lineHeight;i<e.minHeight?(i=e.minHeight,n.css({"overflow-y":"hidden"})):i>e.maxHeight?(i=e.maxHeight,n.css({"overflow-y":"scroll"})):n.css({"overflow-y":"hidden"}),e.height=i}}),EG=Fancy.CLEARFIX_CLS,FG=Fancy.FIELD_CLS,GG=Fancy.FIELD_LABEL_CLS,HG=Fancy.FIELD_TEXT_CLS,IG=Fancy.FIELD_CHECKBOX_CLS,JG=Fancy.FIELD_CHECKBOX_INPUT_CLS,KG=Fancy.FIELD_INPUT_LABEL_CLS,LG=Fancy.FIELD_CHECKBOX_ON_CLS,Fancy.define(["Fancy.form.field.CheckBox","Fancy.CheckBox"],{mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,type:"field.checkbox",middle:!1,disabled:!1,constructor:function(e){Fancy.applyConfig(this,e),this.Super("const",arguments)},init:function(){var e=this;e.addEvents("focus","blur","input","up","down","beforechange","change","key"),e.Super("init",arguments),e.preRender(),e.render({labelWidth:e.labelWidth,labelDispay:e.labelText?"":"none",label:e.label}),e.expander&&e.addCls("fancy-checkbox-expander"),e.acceptedValue=e.value,e.set(e.value,!1),e.checkMiddle(),e.ons()},labelText:"",labelWidth:60,value:!1,editable:!0,stopIfCTRL:!1,checkedCls:LG,fieldCls:FG+" "+IG,tpl:['<div class="'+GG+'" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="'+HG+'">','<div class="'+JG+'"></div>',"</div>",'<div class="'+KG+'" style="{inputLabelDisplay}">',"{inputLabel}","</div>",'<div class="'+EG+'"></div>'],ons:function(){var e=this,t=e.el;t.on("click",e.onClick,e),t.on("mousedown",e.onMouseDown,e),t.on("mouseenter",e.onMouseOver,e),t.on("mouseleave",e.onMouseOut,e),e.tip&&t.on("mousemove",e.onMouseMove,e)},onClick:function(e){var t=this,n=t.el;if(!(t.disabled||(t.fire("beforechange"),e.ctrlKey&&t.stopIfCTRL||!1===t.editable))){if(!0===t.canceledChange)return void(t.canceledChange=!1);n.toggleCls(t.checkedCls);var i=t.value;t.value=n.hasCls(t.checkedCls),t.fire("change",t.value,i),!0===t.middle&&(t.middle=!1,t.checkMiddle())}},onMouseDown:function(e){e.preventDefault()},set:function(e,t){var n=this,i=n.el;if(""===e&&(e=!1),!0===e||1===e)i.addCls(n.checkedCls),e=!0;else if(!1===e||0===e)i.removeClass(n.checkedCls),e=!1;else{if(void 0!==e)throw new Error("not right value for checkbox "+e);e=!1}n.value=e,!1!==t&&n.fire("change",n.value)},setValue:function(e,t){this.set(e,t)},getValue:function(){return this.value},get:function(){return this.getValue()},clear:function(){this.set(!1)},toggle:function(){this.set(!this.value)},destroy:function(){this.Super("destroy",arguments)},checkMiddle:function(){this.middle?this.el.addCls("fancy-checkbox-middle"):this.el.removeCls("fancy-checkbox-middle")},setMiddle:function(e){this.middle=e,this.checkMiddle()}}),Fancy.define(["Fancy.form.field.Switcher","Fancy.Switcher"],{extend:Fancy.CheckBox,type:"field.switcher",constructor:function(e){Fancy.applyConfig(this,e),this.Super("const",arguments)},init:function(){this.Super("init",arguments)},checkedCls:"fancy-switcher-on",fieldCls:Fancy.FIELD_CLS+" fancy-field-switcher",tpl:['<div class="fancy-field-label" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="fancy-field-text">',"</div>",'<div class="fancy-field-input-label" style="{inputLabelDisplay}">',"{inputLabel}","</div>",'<div class="fancy-clearfix"></div>']}),tH=Fancy,uH=tH.FIELD_CLS,vH=tH.FIELD_COMBO_RESULT_LIST_CLS,wH=tH.FIELD_COMBO_CLS,xH=tH.FIELD_COMBO_SELECTED_ITEM_CLS,yH=tH.FIELD_COMBO_FOCUSED_ITEM_CLS,zH=tH.FIELD_LABEL_CLS,AH=tH.FIELD_TEXT_CLS,BH=tH.CLEARFIX_CLS,CH=tH.FIELD_ERROR_CLS,DH=tH.FIELD_TEXT_INPUT_CLS,EH=tH.FIELD_DISABLED_CLS,FH=tH.FIELD_COMBO_DROPDOWN_BUTTON_CLS,GH=tH.FIELD_COMBO_INPUT_CONTAINER_CLS,HH=tH.FIELD_COMBO_LEFT_EL_CLS,IH=tH.FIELD_LABEL_ALIGN_TOP_CLS,JH=tH.FIELD_LABEL_ALIGN_RIGHT_CLS,KH=tH.FIELD_CHECKBOX_INPUT_CLS,LH=tH.FIELD_COMBO_LIST_VALUE_CLS,tH.define("Fancy.combo.Manager",{singleton:!0,opened:[],add:function(e){this.hideLists(),this.opened.push(e)},hideLists:function(){tH.each(this.opened,function(e){e.hideList(),e.hideAheadList()}),this.opened=[]}}),tH.define(["Fancy.form.field.Combo","Fancy.Combo"],{type:"field.combo",mixins:[tH.form.field.Mixin],extend:tH.Widget,selectedItemCls:xH,focusedItemCls:yH,fieldCls:uH+" "+wH,width:250,labelWidth:60,listRowHeight:28,dropButtonWidth:27,leftWidth:20,maxListRows:9,emptyText:"",editable:!0,typeAhead:!0,readerRootProperty:"data",valueKey:"value",displayKey:"text",multiSelect:!1,itemCheckBox:!1,listCls:"",tpl:['<div class="'+zH+'" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="'+AH+'">','<div class="'+GH+'" style="{inputWidth}{inputHeight}">','<div class="'+HH+'" style="{inputHeight}cursor:default;">&nbsp;</div>','<input placeholder="{emptyText}" class="'+DH+'" style="{inputHeight}cursor:default;" value="{value}">','<div class="'+FH+'">&nbsp;</div>',"</div>","</div>",'<div class="'+CH+'" style="{errorTextStyle}"></div>','<div class="'+BH+'"></div>'],constructor:function(){this.tags=this.tags||[],this.Super("const",arguments)},init:function(){var e=this;e.addEvents("focus","blur","input","up","down","change","key","enter","esc","empty","load"),e.Super("init",arguments),e.subSearch&&(e.editable=!1),e.loadListData()||(e.data=e.configData(e.data)),e.multiSelect&&e.data.length&&e.initMultiSelect(),e.preRender(),e.render(),e.ons(),e.applyStyle(),e.applyTheme(),setTimeout(function(){e.applyTheme()},1)},loadListData:function(){var n=this;if(!tH.isObject(n.data))return!1;var e=n.data.proxy,i=n.readerRootProperty;if(!e||!e.url)throw new Error("[FancyGrid Error]: combo data url is not defined");return e.reader&&e.reader.root&&(i=e.reader.root),tH.Ajax({url:e.url,params:e.params||{},method:e.method||"GET",getJSON:!0,success:function(e){if(n.data=n.configData(e[i]),n.renderList(),n.onsList(),n.multiSelect)n.initMultiSelect(),n.value&&n.updateInput();else if(n.value){var t=n.getDisplayValue(n.value);t&&(n.input.dom.value=t)}n.fire("load")}}),!0},configData:function(e){if(tH.isObject(e)||0===e.length)return e;if(tH.isObject(e[0]))return e;for(var t=[],n=0,i=e.length;n<i;n++)t.push({text:e[n],value:n});return t},applyStyle:function(){var e=this;e.hidden&&e.css("display","none"),e.style&&e.css(e.style)},applyTheme:function(){var e=this;e.theme&&"default"!==e.theme&&(e.addCls("fancy-theme-"+e.theme),e.list.addCls("fancy-theme-"+e.theme),e.aheadList&&e.aheadList.addCls("fancy-theme-"+e.theme))},ons:function(){var e=this,t=e.el,n=e.el.select("."+FH);e.input=e.el.getByTag("input"),e.inputContainer=e.el.select("."+GH),e.drop=n,e.onsList(),e.input.on("blur",e.onBlur,e),e.input.on("mousedown",e.onInputMouseDown,e),e.input.on("click",e.onInputClick,e),n.on("mousedown",e.onDropMouseDown,e),n.on("click",e.onDropClick,e),e.on("key",e.onKey,e),e.typeAhead&&e.editable&&e.input.on("keydown",e.onKeyDown,e),e.on("esc",e.onEsc,e),e.on("enter",e.onEnter,e),e.on("up",e.onUp,e),e.on("down",e.onDown,e),t.on("mouseenter",e.onMouseOver,e),t.on("mouseleave",e.onMouseOut,e),e.tip&&t.on("mousemove",e.onMouseMove,e)},onSubSearchKeyDown:function(e){var t=e.keyCode,n=tH.key;switch(t){case n.ESC:this.fire("esc",e);break;case n.ENTER:this.fire("enter",e);break;case n.UP:this.fire("up",e);break;case n.DOWN:this.fire("down",e)}},onKeyDown:function(e){var t=this,n=e.keyCode,i=tH.key;switch(n){case i.ESC:t.fire("esc",e);break;case i.ENTER:t.fire("enter",e);break;case i.UP:t.fire("up",e);break;case i.DOWN:t.fire("down",e);break;case i.TAB:break;case i.BACKSPACE:setTimeout(function(){if(0===t.input.dom.value.length)t.value=-1,t.valueIndex=-1,t.hideAheadList(),t.multiSelect&&(t.values=[],t.clearListActive()),t.fire("empty");else{if(t.multiSelect&&t.input.dom.value.split(",").length!==t.valuesIndex.length){var e=t.getFromInput();t.set(e)}if(0===t.generateAheadData().length)return void t.hideAheadList();t.renderAheadList(),t.showAheadList()}},100);break;default:setTimeout(function(){0!==t.generateAheadData().length?(t.renderAheadList(),t.showAheadList()):t.hideAheadList()},1)}setTimeout(function(){t.fire("key",t.input.dom.value,e)},1)},onInputClick:function(e){var t=this,n=t.list;t.disabled||!0!==t.editable&&("none"===n.css("display")?t.showList():t.hideList())},onDropClick:function(e){var t=this,n=t.list;t.disabled||("none"===n.css("display")?(tH.combo.Manager.add(this),t.showList()):t.hideList(),!0===t.editable&&t.input.focus())},showList:function(){var e=this,i=e.list,t=e.input.parent().parent(),n=t.$dom.offset(),a=[n.left,n.top+t.$dom.height()],o=tH.get(document),s=e.selectedItemCls,r=e.focusedItemCls;if(e.hideAheadList(),e.list&&0!==e.data.length){if(!e.isListInsideViewBox(t)){var l=this.calcListHeight();a[1]=n.top-l}var c;i.css({display:"",left:a[0]+"px",top:a[1]+3+"px",opacity:0,width:e.getListWidth(),"z-index":2e3+tH.zIndex++}),e.listCls&&i.addCls(e.listCls),i.animate({opacity:1,top:a[1]},tH.ANIMATE_DURATION),e.clearFocused();var d=i.select("."+s);0===d.length?e.multiSelect&&e.values.length?e.valuesIndex.each(function(e,t,n){void 0===c&&(c=e),i.select("li").item(e).addCls(s)}):c=0:(e.multiSelect&&d.length!==e.valuesIndex.length&&(i.select("."+s).removeCls(s),e.valuesIndex.each(function(e,t,n){void 0===c&&(c=e),i.select("li").item(e).addCls(s)})),c=d.item(0).index()),-1===c&&(c=0),i.select("li").item(c).addCls(r),e.scrollToListItem(c),e.docSpy||(e.docSpy=!0,o.on("click",e.onDocClick,e)),!1!==e.subSearch&&e.subSearchField&&(e.subSearchField.setInputSize({width:e.getListWidth()-6,height:25}),e.subSearchField.input.focus())}},showAheadList:function(){var e=this,t=e.aheadList,n=e.input.parent().parent(),i=n.$dom.offset(),a=[i.left,i.top+n.$dom.height()],o=tH.get(document);e.hideList(),t&&0!==e.data.length&&(t.css({display:"",left:a[0]+"px",top:a[1]+"px",width:e.getListWidth(),"z-index":2e3+tH.zIndex++}),e.docSpy2||(e.docSpy2=!0,o.on("click",e.onDocClick,e)))},onDocClick:function(e){if(!1===this.input.parent().parent().within(e.target)){if(!0===this.list.within(e.target))return;this.hideList(),this.hideAheadList()}},hideList:function(){var e=this;if(e.list&&(e.list.css("display","none"),e.docSpy)){var t=tH.get(document);e.docSpy=!1,t.un("click",e.onDocClick,e)}},hideAheadList:function(){var e=this;if(e.aheadList&&(e.aheadList.css("display","none"),e.docSpy)){var t=tH.get(document);e.docSpy=!1,t.un("click",e.onDocClick,e)}},onInputMouseDown:function(e){this.disabled?e.preventDefault():!1===this.editable&&e.preventDefault()},onDropMouseDown:function(e){this.disabled&&e.stopPropagation(),e.preventDefault()},onsList:function(){var e=this;e.list.on("mousedown",e.onListItemMouseDown,e,"li"),e.list.on("click",e.onListItemClick,e,"li"),e.list.on("mouseenter",e.onListItemOver,e,"li"),e.list.on("mouseleave",e.onListItemLeave,e,"li"),e.selectAllText&&e.list.select(".fancy-combo-list-select-all").on("click",e.onSelectAllClick,e)},onsAheadList:function(){this.aheadList.on("click",this.onListItemClick,this,"li")},onListItemOver:function(e){if(!this.disabled){var t=tH.get(e.target);"li"===t.prop("tagName").toLocaleLowerCase()&&t.addCls(this.focusedItemCls)}},onListItemLeave:function(){this.disabled||this.clearFocused()},onListItemMouseDown:function(){var e=this;e.listItemClicked=!0,setTimeout(function(){delete e.listItemClicked},1e3)},onListItemClick:function(e){var t=this,n=tH.get(e.currentTarget),i=n.attr("value"),a=t.selectedItemCls,o=t.focusedItemCls;t.disabled||(tH.nojQuery&&0===i&&(i=""),t.multiSelect?(0===t.values.length&&t.clearListActive(),t.clearFocused(),n.toggleCls(a),n.hasCls(a)?(t.addValue(i),n.addCls(o)):(t.removeValue(i),t.clearFocused(),t.selectAllText&&t.list.select(".fancy-combo-list-select-all").removeCls("fancy-combo-item-selected")),t.updateInput()):(t.set(i),t.hideList()),t.editable?t.input.focus():t.onBlur())},set:function(i,e){var t,a=this,o="";if(a.multiSelect&&!tH.isArray(i)&&(i=-1===i?[]:[i]),tH.isArray(i)&&a.multiSelect){var s=[];a.valuesIndex.removeAll(),tH.each(i,function(e,t){var n=a.getIndex(e);-1!==n&&(a.valuesIndex.add(n,i[t]),s.push(a.data[n][a.displayKey]),o=s.join(", "))}),a.values=i,t=a.getIndex(i[0]),a.value=i[0],a.valueIndex=t}else-1!==(t=a.getIndex(i))?(a.valueIndex=t,o=a.data[t][a.displayKey],a.selectItem(t)):-1!==i&&i&&0<i.length?(o="",a.value=-1,a.valueIndex=-1):o="",a.value=i;a.input.dom.value=o,!1!==e&&a.onInput(),a.left&&a.updateLeft(),Fancy.isObject(a.data)||a.validate(o)},addValue:function(e){var t=this,n=t.getIndex(e);-1===n||t.valuesIndex.get(n)||(t.value=e,t.values.push(e),t.valuesIndex.add(n,e))},removeValue:function(n){var e=this,i=-1;tH.each(e.values,function(e,t){e===n&&(i=t)}),-1!==i&&(e.values.splice(i,1),e.valuesIndex.remove(e.getIndex(n))),e.values.length?e.value=e.values[e.values.length-1]:(e.value=-1,e.valueIndex=-1)},updateInput:function(e){var i=this,a=[];i.valuesIndex.each(function(e,t,n){a.push(i.data[e][i.displayKey])}),i.input.dom.value=a.join(", "),!1!==e&&i.onInput()},selectItem:function(e){var t=this;t.list&&(t.multiSelect||t.clearListActive(),t.clearFocused(),t.list.select("li").item(e).addCls(t.focusedItemCls,t.selectedItemCls))},render:function(){var n=this,e=tH.get(n.renderTo||document.body).dom,t=tH.get(document.createElement("div")),i=n.value,a=-1;t.attr("id",n.id),i=void 0===i?"":n.multiSelect&&tH.isArray(n.data)&&0<n.data.length?(i="",n.valuesIndex.each(function(e,t){-1===a&&(a=e,n.valueIndex=e),i+=n.data[e][n.displayKey]+", "}),i.replace(/, $/,"")):-1!==(a=n.getIndex(i))?(n.valueIndex=a,n.data[a][n.displayKey]):"",n.fire("beforerender"),t.addCls(tH.cls,n.cls,n.fieldCls);var o="";n.labelWidth&&(o="width:"+n.labelWidth+"px;");var s=n.label;""===n.label?s="&nbsp;":void 0===n.label?s="&nbsp;":"right"!==n.labelAlign&&(s+=":"),t.update(n.tpl.getHTML({labelWidth:o,labelDisplay:!1===n.label?"display: none;":"",label:!1===s?"":s,emptyText:n.emptyText,inputHeight:"height:"+n.inputHeight+"px;",value:i})),n.el=t,n.setStyle(),n.input=n.el.getByTag("input"),n.inputContainer=n.el.select("."+GH),n.drop=n.el.select("."+FH),n.leftTpl&&(n.left=n.el.select("."+HH),n.left.css({display:"block",width:n.leftWidth})),n.setSize(),e.appendChild(t.dom),"top"===n.labelAlign?n.el.addCls(IH):"right"===n.labelAlign&&(n.el.addCls(JH),tH.$(t.dom).find("."+zH).insertAfter(tH.$(t.dom).find("."+AH))),n.valueIndex&&(n.acceptedValue=n.value),n.editable?n.input.css("cursor","auto"):n.input&&n.input.attr("tabIndex",-1),n.disabled&&(n.addCls(EH),n.input&&n.input.attr("tabIndex",-1)),n.renderList(),n.leftTpl&&(setTimeout(function(){n.updateLeft()},1),setTimeout(function(){n.updateLeft()},500),setTimeout(function(){n.updateLeft()},1e3)),n.fire("afterrender"),n.fire("render")},renderList:function(){var o=this,e=tH.get(document.createElement("div")),s=[];o.selectAllText&&s.push('<div class="fancy-combo-list-select-all"><div class="fancy-field-checkbox-input" style=""></div><span class="fancy-combo-list-select-all-text">'+o.selectAllText+"</span></div>"),!1===o.editable&&!1!==o.subSearch&&"checkbox"!==o.type&&s.push('<div class="fancy-combo-list-sub-search-container"></div>'),o.list&&o.list.destroy(),s.push(['<ul style="position: relative;">']),tH.each(o.data,function(e,t){var n="",i=e[o.displayKey],a=e[o.valueKey];o.value===a&&(n=o.selectedItemCls),""===i||" "===i?i="&nbsp;":o.listItemTpl&&(i=new tH.Template(o.listItemTpl).getHTML(e)),o.multiSelect&&o.itemCheckBox?s.push('<li value="'+a+'" class="'+n+'"><div class="'+KH+'" style=""></div><span class="'+LH+'">'+i+"</span></li>"):s.push('<li value="'+a+'" class="'+n+'"><span class="'+LH+'">'+i+"</span></li>")}),s.push("</ul>"),e.addCls(tH.cls,vH),e.update(s.join("")),e.css({display:"none",left:"0px",top:"0px",width:o.getListWidth()}),o.data.length>o.maxListRows&&e.select("ul").item(0).css({height:o.listRowHeight*o.maxListRows+"px",overflow:"auto"}),document.body.appendChild(e.dom),o.list=e,!1===o.editable&&"checkbox"!==o.type&&!1!==o.subSearch&&(o.subSearchField=new tH.StringField({renderTo:o.list.select(".fancy-combo-list-sub-search-container").item(0).dom,label:!1,style:{padding:"2px 2px 0px 2px"},events:[{change:o.onSubSearchChange,scope:o}]}),o.subSearchField.setInputSize({width:o.getListWidth()-6,height:25}),o.subSearchField.input.on("keydown",o.onSubSearchKeyDown,o)),o.applyTheme()},getListWidth:function(){var e=this.inputWidth+14,t=this.minListWidth;return this.input&&(e=this.input.parent().parent().width()),t&&e<t&&(e=t),e},generateAheadData:function(){var t=this,n=t.input.dom.value.toLocaleLowerCase(),i=[];if(t.multiSelect){var e=n.split(", "),a=t.getInputSelection(),o=0;tH.each(n,function(e,t){if(a.start<=t)return!0;","===n[t]&&o++}),n=e[o]}return tH.each(t.data,function(e){new RegExp("^"+n).test(e[t.displayKey].toLocaleLowerCase())&&i.push(e)}),t.data.length===i.length&&(i=[]),t.aheadData=i},renderAheadList:function(){var e,o=this,s=['<ul style="position: relative;">'],t=!1;o.aheadList?(o.aheadList.firstChild().destroy(),e=o.aheadList,t=!0):e=tH.get(document.createElement("div")),tH.each(o.aheadData,function(e,t){var n="",i=e[o.displayKey],a=e[o.valueKey];0===t&&(n=o.selectedItemCls),""===i||" "===i?i="&nbsp;":o.listItemTpl&&(i=new tH.Template(o.listItemTpl).getHTML(e)),s.push('<li value="'+a+'" class="'+n+'"><span class="'+LH+'">'+i+"</span></li>")}),s.push("</ul>"),e.update(s.join("")),e.css({display:"none",left:"0px",top:"0px",width:o.getListWidth()}),e.css({"max-height":o.listRowHeight*o.maxListRows+"px",overflow:"auto"}),!1===t&&(e.addClass(tH.cls,"fancy-combo-result-list"),document.body.appendChild(e.dom),o.aheadList=e,o.onsAheadList()),o.applyTheme()},hide:function(){this.css("display","none"),this.hideList(),this.hideAheadList()},clear:function(){this.multiSelect?this.set([],!1):this.set(-1,!1)},clearListActive:function(){var e=this.selectedItemCls,t=this.focusedItemCls;this.list.select("."+t).removeCls(t),this.list.select("."+e).removeCls(e)},clearFocused:function(){var e=this,t=e.focusedItemCls;e.list&&e.list.select("."+t).removeCls(t),e.aheadList&&e.aheadList.select("."+t).removeCls(t)},onInput:function(){var e=this,t=e.getValue(),n=e.acceptedValue;e.acceptedValue=e.get(),e.fire("change",t,n),e.left&&e.updateLeft()},setValue:function(e,t){this.set(e,t)},getDisplayValue:function(e,t){var n=this.getIndex(e);return t?n:this.data[n]?this.data[n][this.displayKey]:""},getValueKey:function(e,t){for(var n=this,i=0,a=n.data.length;i<a;i++)if(n.data[i][n.displayKey]===e)return t?i:n.data[i][n.valueKey]},get:function(){return this.getValue()},getValue:function(){var e=this;return e.multiSelect?e.values:-1===e.value||void 0===e.value?-1===e.value&&e.input.dom.value?e.input.dom.value:"":(e.valueKey,e.value)},size:function(e){var t=this,n=e.width,i=e.height,a=t.input,o=t.inputContainer,s=t.drop;"top"!==t.labelAlign&&(t.inputHeight=i),void 0!==i&&(t.height=i),void 0!==n&&(t.width=n),t.calcSize(),"top"===t.labelAlign?t.css({height:1.5*t.height,width:t.width}):t.css({height:t.height,width:t.width});var r=t.inputWidth,l=2;"dark"===t.theme&&(l=0);var c=r-l;t.left&&(c-=t.leftWidth),a.css({width:c,height:t.inputHeight,"margin-left":t.left?t.leftWidth:0}),o.css({width:r,height:t.inputHeight}),s.css("height",t.inputHeight)},onEnter:function(e,t){var n,i=this,a=i.getActiveList(),o=i.focusedItemCls,s=i.selectedItemCls;if(i.multiSelect){if(!a)return;if((l=a.select("."+o))&&l.dom||(l=a.select("."+s).last()),l&&l.dom){n=l.attr("value"),i.addValue(n);var r=i.getDisplayValue(n,!0);i.selectItem(r),i.updateInput()}}else if(a){var l;(l=a.select("."+o))&&l.dom||(l=a.select("."+s)),n=l.attr("value"),i.set(n)}else i.set(i.input.dom.value);i.hideList(),i.hideAheadList()},onEsc:function(e,t){this.hideList(),this.hideAheadList()},onUp:function(e,t){var n=this,i=n.getActiveList(),a=n.focusedItemCls,o=n.selectedItemCls;if(i){i=n.getActiveList().select("ul"),t.preventDefault();var s=i.select("."+a),r=!1;s.dom||(s=i.select("."+o)),s.dom||(r=!0,s=i.lastChild()),1<s.length&&(s=s.item(0));var l=s.index(),c=i.select("li"),d=parseInt(i.css("height"));0===l||r?l=c.length-1:l--;var u=c.item(l),h=u.dom.offsetTop;h-i.dom.scrollTop>d?i.dom.scrollTop=1e4:h-i.dom.scrollTop<0&&(i.dom.scrollTop=h),n.clearFocused(),u.addClass(a)}},onDown:function(e,t){var n=this,i=n.getActiveList(),a=n.focusedItemCls,o=n.selectedItemCls;if(i){i=n.getActiveList().select("ul"),t.preventDefault();var s=i.select("."+a),r=!1;s.dom||(s=i.select("."+o)),s.dom||(r=!0,s=i.firstChild()),1<s.length&&(s=s.item(0));var l=parseInt(s.css("height")),c=s.index(),d=i.select("li"),u=parseInt(i.css("height"));c===d.length-1||r?c=0:c++;var h=d.item(c),p=h.dom.offsetTop,f=parseInt(h.css("height"));p-i.dom.scrollTop<0?i.dom.scrollTop=0:p+f+3-i.dom.scrollTop>u&&(i.dom.scrollTop=p-u+l+f),n.clearFocused(),h.addClass(a)}else n.showList()},scrollToListItem:function(e){var t=this.getActiveList().select("ul"),n=t.select("li"),i=n.item(e).dom.offsetTop;parseInt(t.css("height")),0===e?t.dom.scrollTop=0:e===n.length-1?t.dom.scrollTop=1e4:t.dom.scrollTop=i},getActiveList:function(){var e=this,t=!1;return e.list&&"none"!==e.list.css("display")?t=e.list:e.aheadList&&"none"!==e.aheadList.css("display")&&(t=e.aheadList),t},initMultiSelect:function(){var t=this,e=t.value;t.values=[],t.valuesIndex=new tH.Collection,void 0!==t.value&&null!==e&&""!==e&&(tH.isArray(e)?(t.values=e,t.value=e[0]):t.values=[t.value],tH.each(t.values,function(e){t.valuesIndex.add(t.getIndex(e),e)}))},getIndex:function(e){for(var t=this.data,n=0,i=t.length;n<i;n++)if(t[n][this.valueKey]==e)return n;return-1},getFromInput:function(){var i=this,e=i.input.dom.value.split(","),a=[];return tH.each(e,function(e){var t=e.replace(/ $/,"").replace(/^ /,""),n=i.getValueKey(t);n&&a.push(n)}),a},updateLeft:function(){var e=this,t=e.data[e.getIndex(e.getValue())];e.left.update(new tH.Template(e.leftTpl).getHTML(t))},setData:function(e){this.data=e,this.renderList(),this.onsList()},onSelectAllClick:function(e){var t=this.list.select("li"),n=this.list.select(".fancy-combo-list-select-all").item(0),i=n.hasClass("fancy-combo-item-selected");setTimeout(function(){i?n.removeCls("fancy-combo-item-selected"):n.addCls("fancy-combo-item-selected")},100),t.each(function(e,t){i?e.hasClass("fancy-combo-item-selected")&&e.dom.click():e.hasClass("fancy-combo-item-selected")||e.dom.click()})},onSubSearchChange:function(e,n){var i=this,a=i.list.select("li"),o=0,t=i.listRowHeight*i.maxListRows;n=n.toLocaleLowerCase(),tH.each(i.data,function(e,t){new RegExp("^"+n).test(e[i.displayKey].toLocaleLowerCase())?(a.item(t).css("display","block"),o+=parseInt(a.item(t).css("height"))):a.item(t).css("display","none")});var s=i.list.select("ul").item(0);t<o?s.css("height",t):s.css("height",o)},isListInsideViewBox:function(e){var t=e.$dom.offset(),n=this.calcListHeight();return!(t.top+n>tH.getViewSize()[0]+Fancy.getScroll()[0])},calcListHeight:function(){var e=this,t=e.data.length*e.listRowHeight;return e.data.length>e.maxListRows&&(t=e.maxListRows*e.listRowHeight),t}}),ON=Fancy,PN=ON.CLEARFIX_CLS,QN=ON.FIELD_CLS,RN=ON.FIELD_LABEL_CLS,SN=ON.FIELD_TEXT_CLS,TN=ON.FIELD_BUTTON_CLS,ON.define(["Fancy.form.field.Button","Fancy.ButtonField"],{mixins:[ON.form.field.Mixin],extend:ON.Widget,type:"field.button",pressed:!1,constructor:function(e){ON.apply(this,e),this.Super("const",arguments)},init:function(){var e=this;e.addEvents("click"),e.Super("init",arguments),e.preRender(),e.render(),e.renderButton(),e.ons(),e.hidden&&e.css("display","none"),e.style&&e.css(e.style)},fieldCls:QN+" "+TN,value:"",width:100,emptyText:"",tpl:['<div class="'+RN+'" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="'+SN+'">',"</div>",'<div class="'+PN+'"></div>'],renderButton:function(){var e=this;e.button=new ON.Button({renderTo:e.el.select("."+SN).item(0).dom,text:e.buttonText,disabled:e.disabled,pressed:e.pressed,enableToggle:e.enableToggle,imageCls:e.imageCls,handler:function(){e.disabled||(e.scope?e.handler.apply(e.scope,[e]):e.handler(e))}})},ons:function(){var n=this,e=n.el;n.button.on("pressedchange",function(e,t){n.fire("pressedchange",t)}),e.on("mouseenter",n.onMouseOver,n),e.on("mouseleave",n.onMouseOut,n),n.tip&&e.on("mousemove",n.onMouseMove,n)},onClick:function(){this.disabled||(this.fire("click"),this.handler&&this.handler())},setPressed:function(e){this.button.setPressed(e)}}),Fancy.define(["Fancy.form.field.SegButton","Fancy.SegButtonField"],{mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,type:"field.button",allowToggle:!0,constructor:function(e){Fancy.apply(this,e),this.Super("const",arguments)},init:function(){var e=this;e.addEvents("click","change"),e.Super("init",arguments),e.preRender(),e.render(),e.renderButton(),e.ons(),e.hidden&&e.css("display","none"),e.style&&e.css(e.style)},fieldCls:"fancy fancy-field fancy-field-button",value:"",width:100,emptyText:"",tpl:['<div class="fancy-field-label" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="fancy-field-text">',"</div>",'<div class="fancy-clearfix"></div>'],renderButton:function(){var e=this;e.button=new Fancy.SegButton({renderTo:e.el.select(".fancy-field-text").item(0).dom,items:e.items,disabled:e.disabled,multiToggle:e.multiToggle,allowToggle:e.allowToggle})},ons:function(){var e=this,t=e.el;e.button.on("toggle",function(){e.disabled||e.fire("toggle")}),t.on("mouseenter",e.onMouseOver,e),t.on("mouseleave",e.onMouseOut,e),e.tip&&t.on("mousemove",e.onMouseMove,e)},onClick:function(){this.disabled||(this.fire("click"),this.handler&&this.handler())},get:function(){var n=[];return Fancy.each(this.items,function(e,t){e.pressed&&(e.value?n.push(e.value):n.push(t))}),n.toString()},clear:function(t){this.allowToggle&&Fancy.each(this.items,function(e){e.setPressed(!1,t)})}}),Fancy.define(["Fancy.form.field.Tab","Fancy.Tab"],{mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,type:"field.tab",constructor:function(e){Fancy.apply(this,e),this.Super("const",arguments)},init:function(){var e=this;e.addEvents("collapsed","expanded"),e.Super("init",arguments);for(var t=0,n=e.items.length;t<n;t++){var i=e.items[t];"top"===i.labelAlign&&0===t&&(i.style={"padding-left":"0px"})}e.preRender(),e.render()},fieldCls:"fancy fancy-field-tab",value:"",width:100,emptyText:"",tpl:['<div class="fancy-field-tab-items">',"</div>"]}),IO=Fancy,JO=IO.CLEARFIX_CLS,KO=IO.FIELD_CLS,LO=IO.FIELD_RADIO_CLS,MO=IO.FIELD_RADIO_COLUMN_CLS,NO=IO.FIELD_TEXT_CLS,OO=IO.FIELD_RADIO_ON_CLS,PO=IO.FIELD_RADIO_INPUT_CLS,QO=IO.FIELD_LABEL_CLS,RO=IO.FIELD_ERROR_CLS,IO.define(["Fancy.form.field.Radio","Fancy.Radio"],{mixins:[IO.form.field.Mixin],extend:IO.Widget,type:"field.radio",radioRows:1,constructor:function(){this.Super("const",arguments)},init:function(){var a=this;a.addEvents("focus","blur","input","up","down","change","key"),a.Super("init",arguments);var o="";a.column&&(a.cls+=" "+MO,o+='<div style="margin-left: '+a.labelWidth+'px;">'),IO.each(a.items,function(e,t){var n="",i=NO;a.column||0===t||(n="margin-left:10px;"),e.value===a.value&&(i+=" "+OO),o+=['<div class="'+i+'" value='+e.value+">",'<div class="'+PO+'" style="float:left;'+n+'"></div>','<div style="float:left;margin:7px 0 0 0;">'+e.text+"</div>","</div>"].join("")}),a.column&&(o+="</div>"),a.itemsHTML=o,a.preRender(),a.render(),a.setColumnsStyle(),a.acceptedValue=a.value,a.set(a.value),a.ons()},labelText:"",labelWidth:60,value:!1,checkedCls:OO,fieldCls:KO+" "+LO,tpl:['<div class="'+QO+'" style="{labelWidth}{labelDisplay}">',"{label}",'<div class="'+RO+'" style="{errorTextStyle}"></div>',"</div>","{itemsHTML}",'<div class="'+JO+'"></div>'],ons:function(){var e=this,t=this.el;t.$dom.delegate("."+NO,"click",function(){e.disabled||e.set(IO.get(this).attr("value"))}),t.on("mousedown",e.onMouseDown,e),t.on("mouseenter",e.onMouseOver,e),t.on("mouseleave",e.onMouseOut,e),e.tip&&t.on("mousemove",e.onMouseMove,e)},onClick:function(){var e=this,t=e.checkedCls;e.disabled||(e.addCls(t),e.toggleCls(t),e.value=e.hasCls(t),e.fire("change",e.value))},onMouseDown:function(e){this.disabled&&e.stopPropagation(),e.preventDefault()},set:function(e,t){var n=this,i=n.el,a=n.checkedCls;i.select("."+NO).removeCls(a),i.select("[value="+e+"]").addCls(a),n.value=e,!1!==t&&n.fire("change",n.value)},setValue:function(e,t){this.set(e,t)},getValue:function(){return this.value},get:function(){return this.getValue()},clear:function(){this.set(!1)},calcColumns:function(){var e=this,t=0,n=e.width;"top"!==e.labelAlign&&e.label&&(n-=e.labelWidth,n-=20),IO.Array.each(e.items,function(e){e.text.length>t&&(t=e.text.length)});var i=Math.floor(n/(7*t+30));e.columns&&e.columns<=i?i=e.columns:e.columns=i,e.columnWidth=Math.ceil(n/i),e.rows=Math.ceil(e.items.length/i)},setColumnsStyle:function(){var n=this;if(n.columns&&1!==n.rows){var e=n.el.select("."+NO),i=n.el.select("."+NO+" ."+PO);e.each(function(e,t){t%n.columns==0&&i.item(t).css("margin-left","0px"),e.css("width",n.columnWidth)})}}}),Fancy.vtypes={},Fancy.addValid=function(e,t){Fancy.vtypes[e]=t},Fancy.isValid=function(e,t){var n;if(Fancy.isString(e)?n=Fancy.vtypes[e]:Fancy.isObject(e)&&(e.type?(n=Fancy.vtypes[e.type],Fancy.applyIf(e,n)):n=e),n.before){var i=n.before,a=[e];Fancy.isString(i)?a.push(i):Fancy.isArray(i)&&(a=a.concat(i)),a.reverse();for(var o=0,s=a.length;o<s;o++)if((n=Fancy.isObject(a[o])?a[o]:Fancy.vtypes[a[o]]).re){if(!1===n.re.test(t))return n}else if(n.fn&&!1===n.fn.apply(n,[t]))return n}else if(n.re){if(!1===n.re.test(t))return n}else if(!1===n.fn.apply(n,[t]))return n;return!0},Fancy.addValid("notempty",{text:"Must be present",fn:function(e){return null!=e&&0!==String(e).length}}),Fancy.addValid("notnan",{text:"Must be numeric",fn:function(e){return!isNaN(e)}}),Fancy.addValid("min",{before:["notempty","notnan"],text:"Must be must be at least {param}",fn:function(e){return e>=this.param}}),Fancy.addValid("max",{before:["notempty","notnan"],text:"Must be no more than {param}",fn:function(e){return e<=this.param}}),Fancy.addValid("range",{before:["notempty","notnan"],text:"Must be between {min} and {max}",fn:function(e){return e>=this.min&&e<=this.max}}),Fancy.addValid("email",{before:"notempty",re:/^(")?(?:[^\."])(?:(?:[\.])?(?:[\w\-!#$%&'*+\/=?\^_`{|}~]))*\1@(\w[\-\w]*\.){1,5}([A-Za-z]){2,6}$/,text:"Is not a valid email address"}),Fancy.Mixin("Fancy.grid.mixin.Edit",{remove:function(e,t,n){var i=this,a=i.store,o="remove";if(i.store){if(t&&(o="removeAt"),Fancy.isArray(e))for(var s=0,r=e.length;s<r;s++)a[o](e[s],n);else a[o](e);!1!==n&&i.setSidesHeight()}else setTimeout(function(){i.remove(e,t)},100)},removeAt:function(e){this.remove(e,!0)},removeRow:function(e){this.remove(e,!0)},removeRowById:function(e){this.remove(e)},removeRowByID:function(e){this.remove(e)},removeAll:function(){var e=this;e.store.removeAll(),e.update(),e.scroller.update(),e.paging&&e.paging.updateBar(),e.grouping&&e.grouping.reGroup()},add:function(e){var t=this;if(t.store)if(Fancy.isArray(e))for(var n=0,i=e.length;n<i;n++)t.add(e[n]);else t.store.add(e),t.setSidesHeight();else setTimeout(function(){t.add(e)},100)},insert:function(e,t,n){var i=this,a=i.store;if(i.store)if(Fancy.isArray(t)){for(var o=t.length-1;-1!==o;o--)i.insert(t[o],e,n);!1!==n&&i.setSidesHeight()}else if(Fancy.isArray(e)){for(o=e.length-1;-1!==o;o--)i.insert(e[o],0,n);!1!==n&&i.setSidesHeight()}else{if(Fancy.isObject(e)&&void 0===t)t=e,e=0;else if(Fancy.isObject(e)&&Fancy.isNumber(t)){var s=t;t=e,e=s}i.paging&&"server"!==a.proxyType&&(e+=a.showPage*a.pageSize),a.insert(e,t,n),!1!==n&&i.setSidesHeight()}else setTimeout(function(){i.insert(e,t,n)},100)},set:function(e,t,n){var i=this,a=i.store;i.store?Fancy.isObject(t)&&void 0===n?a.setItemData(e,t,n):a.set(e,t,n):setTimeout(function(){i.set(e,t,n)},100)},setById:function(e,t,n){var i=this,a=i.store,o=a.getRow(e);if(void 0===o){if(void 0===a.getById(e))return!1;o=-1}if(!i.store)return setTimeout(function(){-1===o?i.setById(o,t,n):i.set(o,t,n)},100),o;if(Fancy.isObject(t)&&void 0===n)for(var s in t){var r=i.getColumnByIndex(s);if(r&&"date"===r.type){var l=r.format;+Fancy.Date.parse(t[s],l.read,l.mode)==+Fancy.Date.parse(a.getById(e).get(s),l.edit,l.mode)&&delete t[s]}a.setItemData(o,t,n,e),-1===o&&a.getById(e).set(t)}else-1===o?a.getById(e).set(t,n):a.set(o,t,n,e);return o},undo:function(){var e=this,t=e.store,n=t.undoActions.splice(t.undoActions.length-1,1)[0];switch(n.type){case"edit":e.setById(n.id,n.key,n.oldValue);var i=n.value;n.value=n.oldValue,n.oldValue=i,t.redoActions.push(n),e.fire("undo");break;case"insert":t.undoStoppped=!0,e.remove(n.id),t.undoStoppped=!1,t.redoActions.push(n);break;case"remove":t.undoStoppped=!0,e.insert(n.rowIndex,n.data),t.undoStoppped=!1,t.redoActions.push(n)}},redo:function(){var e=this.store,t=e.redoActions.splice(e.redoActions.length-1,1)[0];switch(e.redoing=!0,t.type){case"edit":this.setById(t.id,t.key,t.oldValue);break;case"insert":this.insert(t.rowIndex,t.data);break;case"remove":this.remove(t.id)}delete e.redoing},undoAll:function(){for(var e=0,t=this.store.undoActions.length;e<t;e++)this.undo()},editCell:function(e){var t=this,n={side:t.getSideByCell(e),rowIndex:Number(e.attr("index")),columnIndex:Number(e.parent().attr("index"))},i=t.getColumns(n.side);if(n.column=i[n.columnIndex],!0===n.column.editable){n.cell=e.dom;var a=t.get(n.rowIndex);n.item=a,n.data=a.data,n.column.smartIndexFn?n.value=n.column.smartIndexFn(n.data):n.value=t.store.get(n.rowIndex,n.column.index),t.celledit.edit(n)}},getCell:function(e){var t=this;if(void 0!==e.id&&void 0!==e.index){var n=t.getColumnOrderByKey(e.index),i=n.order,a=n.side,o=t.getRowById(e.id);if(!(s=t.getBody(a).getCell(o,i)).dom)return;return s}if(void 0!==e.rowIndex&&void 0!==e.columnIndex){var s;a=e.side||"center";if((s=t.getBody(a).getCell(e.rowIndex,e.columnIndex)).dom||(s=t.getBody("center").getCell(e.rowIndex,e.columnIndex)),s.dom||(s=t.getBody("left").getCell(e.rowIndex,e.columnIndex)),s.dom||(s=t.getBody("right").getCell(e.rowIndex,e.columnIndex)),!s.dom)return;return s}}}),Fancy.define(["Fancy.Grid","FancyGrid"],{extend:Fancy.Widget,mixins:["Fancy.grid.mixin.Grid",Fancy.panel.mixin.PrepareConfig,Fancy.panel.mixin.methods,"Fancy.grid.mixin.PrepareConfig","Fancy.grid.mixin.ActionColumn",Fancy.grid.mixin.Edit],plugins:[{type:"grid.updater"},{type:"grid.scroller"},{type:"grid.licence"}],type:"grid",theme:"default",i18n:"en",emptyText:"",prefix:"fancy-grid-",cls:"",widgetCls:Fancy.GRID_CLS,header:!0,shadow:!0,striped:!0,columnLines:!0,rowLines:!0,textSelection:!1,width:200,height:200,minWidth:200,minHeight:200,minColumnWidth:30,defaultColumnWidth:100,emptyValue:"&nbsp;",frame:!0,draggable:!1,activated:!1,multiSort:!1,tabEdit:!0,dirtyEnabled:!0,barScrollEnabled:!0,startResizing:!1,startEditByTyping:!1,constructor:function(e,t){var n=this;Fancy.isDom(e)?(t=t||{}).renderTo=e:t=e,t=t||{};var i=function(e){e&&Fancy.apply(t,e),t.id&&(n.id=t.id),n.initId(),t=n.prepareConfig(t,n),Fancy.applyConfig(n,t),n.Super("const",arguments)},a=function(){var e=t.i18n||n.i18n;!0===Fancy.loadLang(e,i)&&i({})};Fancy.modules.grid||Fancy.fullBuilt||!1===Fancy.MODULELOAD||!1===Fancy.MODULESLOAD?a():Fancy.nojQuery?Fancy.loadModule("dom",function(){Fancy.loadModule("grid",function(){a()})}):Fancy.loadModule("grid",function(){a()})},init:function(){var e=this;e.addEvents("beforerender","afterrender","render","show","hide","destroy"),e.addEvents("headercellclick","headercellmousemove","headercellmousedown","headercellenter","headercellleave","docmouseup","docclick","docmove","beforeinit","init","columnresize","columnclick","columndblclick","columnenter","columnleave","columnmousedown","columntitlechange","cellclick","celldblclick","cellenter","cellleave","cellmousedown","beforecellmousedown","rowclick","rowdblclick","rowenter","rowleave","rowtrackenter","rowtrackleave","beforecolumndrag","columndrag","columnhide","columnshow","scroll","nativescroll","remove","insert","set","update","beforesort","sort","beforeload","load","servererror","serversuccess","select","selectrow","deselectrow","clearselect","activate","deactivate","beforeedit","startedit","changepage","changepagesize","dropitems","dragrows","collapse","expand","treecollapse","treeexpand","lockcolumn","rightlockcolumn","unlockcolumn","filter","contextmenu","statechange"),Fancy.loadStyle(),!0===Fancy.fullBuilt||!1===Fancy.MODULELOAD||!1===Fancy.MODULESLOAD||!0===e.fullBuilt||!0===e.neededModules||"datepicker"===e.wtype||"monthpicker"===e.wtype?(e.initStore(),e.initPlugins(),e.ons(),e.initDateColumn(),e.fire("beforerender"),e.preRender(),e.render(),e.initElements(),e.initActionColumnHandler(),e.fire("render"),e.fire("afterrender"),e.setSides(),e.setSidesHeight(),e.setColumnsPosition(),e.update(),e.initTextSelection(),e.initTouch(),e.fire("beforeinit"),setTimeout(function(){e.inited=!0,e.fire("init"),e.setBodysHeight()},1)):e.loadModules()},loadModules:function(){var n=this,i={},e=n.columns||[],t=n.leftColumns||[],a=n.rightColumns||[];Fancy.modules=Fancy.modules||{},Fancy.nojQuery&&(i.dom=!0),Fancy.isTouch&&(i.touch=!0),n.summary&&(i.summary=!0,n.summary.options&&(i.menu=!0)),n.exporter&&(i.exporter=!0,i.excel=!0),n.paging&&(i.paging=!0),(n.filter||n.searching)&&(i.filter=!0),n.data&&n.data.proxy&&(i.edit=!0),n.clicksToEdit&&(i.edit=!0),n.defaults&&n.defaults.editable&&(i.edit=!0),(n.stateful||n.state)&&(i.state=!0),Fancy.isObject(n.data)&&(n.data.proxy&&(i["server-data"]=!0,Fancy.nojQuery&&(i.ajax=!0)),n.data.chart&&(i["chart-integration"]=!0)),n.expander&&(i.expander=!0),n.isGroupedHeader&&(i["grouped-header"]=!0),n.grouping&&(i.grouping=!0),n.summary&&(i.summary=!0),n.exporter&&(i.exporter=!0,i.excel=!0),(n.trackOver||n.columnTrackOver||n.cellTrackOver||n.selection)&&(i.selection=!0),n.contextmenu&&(i.menu=!0),n.infinite&&(i.infinite=!0);var o=function(e){if(e.menu)return i.menu=!0};Fancy.each(n.events,function(e){for(var t in e)"contextmenu"===t&&(i.menu=!0)}),Fancy.each(n.controls,function(e){"contextmenu"===e.event&&(i.menu=!0)}),Fancy.each(n.tbar,o),Fancy.each(n.bbar,o),Fancy.each(n.buttons,o),Fancy.each(n.subTBar,o);var s=e.concat(t).concat(a);for(var r in Fancy.each(s,function(e){switch(!0===e.draggable&&(i["column-drag"]=!0),!0===e.sortable&&(i.sort=!0),!0===e.editable&&(i.edit=!0),e.menu&&(i.menu=!0),e.filter&&(i.filter=!0),e.type){case"select":n.checkboxRowSelection=!0,i.selection=!0;break;case"combo":e.data&&e.data.proxy&&(i.ajax=!0);break;case"progressbar":case"progressdonut":case"grossloss":case"hbar":i.spark=!0;break;case"tree":i.tree=!0;break;case"date":i.date=!0,i.selection=!0}}),Fancy.isArray(n.tbar)&&Fancy.each(n.tbar,function(e){switch(e.action){case"add":case"remove":i.edit=!0}}),n.gridToGrid&&(i.dd=!0),n.rowDragDrop&&(i.dd=!0),n.neededModules={length:0},i)void 0===Fancy.modules[r]&&(n.neededModules[r]=!0,n.neededModules.length++);if(0===n.neededModules.length)return n.neededModules=!0,void n.init();var l=function(e){delete n.neededModules[e],0==--n.neededModules.length&&(n.neededModules=!0,n.init())};if(n.neededModules.dom)Fancy.loadModule("dom",function(e){if(delete n.neededModules[e],0==--n.neededModules.length)n.neededModules=!0,n.init();else for(var t in n.neededModules)"length"!==t&&Fancy.loadModule(t,l)});else for(var r in n.neededModules)"length"!==r&&Fancy.loadModule(r,l)},lockColumn:function(n,e){var t=this;if(1===t.columns.length)return!1;Fancy.isString(n)&&Fancy.each(t.columns,function(e,t){if(e.index===n)return n=t,!0});var i=t.removeColumn(n,e);t.insertColumn(i,t.leftColumns.length,"left"),t.header&&t.leftHeader.reSetCheckBoxes(),t.body.reSetIndexes(),t.leftBody.reSetIndexes(),t.fire("lockcolumn",{column:i}),t.update()},rightLockColumn:function(n,e){var t=this;if(1===t.columns.length)return!1;Fancy.isString(n)&&Fancy.each(t.columns,function(e,t){if(e.index===n)return n=t,!0});var i=t.removeColumn(n,e);t.insertColumn(i,0,"right"),t.body.reSetIndexes(),t.rightBody.reSetIndexes(),t.fire("rightlockcolumn",{column:i}),t.update()},unLockColumn:function(n,i){var e,t=this;switch(void 0===i&&(Fancy.isString(n)?(Fancy.each(t.leftColumns,function(e,t){if(e.index===n)return i="left",n=t,!0}),void 0===i&&Fancy.each(t.rightColumns,function(e,t){if(e.index===n)return i="right",n=t,!0})):i="left"),i){case"left":Fancy.isString(n)&&Fancy.each(t.leftColumns,function(e,t){if(e.index===n)return n=t,!0}),e=t.removeColumn(n,i),t.insertColumn(e,0,"center","left"),0===t.leftColumns.length&&(t.leftEl.addCls(Fancy.GRID_LEFT_EMPTY_CLS),t.centerEl.css("left","0px"));break;case"right":if(Fancy.isString(n)&&Fancy.each(t.rightColumns,function(e,t){if(e.index===n)return n=t,!0}),e=t.removeColumn(n,i),t.insertColumn(e,t.columns.length,"center","right"),0===t.rightColumns.length){t.rightEl.addCls(Fancy.GRID_RIGHT_EMPTY_CLS);var a=parseInt(t.body.el.css("width"));t.body.el.css("width",a+2)}}"left"===i&&t.grouping&&0===t.leftColumns.length&&t.grouping.insertGroupEls(),t.body.reSetIndexes(),t.leftBody.reSetIndexes(),t.rightBody.reSetIndexes(),t.fire("unlockcolumn",{column:e})},moveColumn:function(e,t,n,i,a){var o,s=this;if(a){for(var r=0,l=a.end-a.start+1,c=a.cell.attr("index"),d=s.getHeader(t),u=a.cell.dom.outerHTML;r<l;r++)s.moveColumn(e,t,a.end-r,i);var h=s.getColumns(t),p=d.el.select("."+Fancy.GRID_HEADER_CELL_CLS);for(l=(r=i)+(a.end-a.start+1);r<l;r++){var f=h[r],y=p.item(r);f.grouping=c,y.attr("group-index",c)}return d.el.append(u),void d.fixGroupHeaderSizing()}if("center"===e)switch(o=s.removeColumn(n,"center"),t){case"left":s.insertColumn(o,i,"left","center");break;case"right":s.insertColumn(o,i,"right","center")}else if("left"===e)switch(o=s.removeColumn(n,"left"),t){case"center":s.insertColumn(o,i,"center","left");break;case"right":s.insertColumn(o,i,"right","left")}else if("right"===e)switch(o=s.removeColumn(n,"right"),t){case"center":s.insertColumn(o,i,"center","right");break;case"left":s.insertColumn(o,i,"left","right")}s.groupheader&&(s.header.fixGroupHeaderSizing(),s.leftColumns&&s.leftHeader.fixGroupHeaderSizing(),s.rightColumns&&s.rightHeader.fixGroupHeaderSizing()),s.getHeader(e).reSetCheckBoxes(),s.getHeader(t).reSetCheckBoxes(),s.update()},updateColumnsVisibilty:function(){var e=this;e.columns&&(e.header&&e.header.updateCellsVisibility(),e.body.updateColumnsVisibility()),e.leftColumns&&(e.leftHeader&&e.leftHeader.updateCellsVisibility(),e.leftBody.updateColumnsVisibility()),e.rightColumns&&(e.rightHeader&&e.rightHeader.updateCellsVisibility(),e.rightBody.updateColumnsVisibility())}}),FancyGrid.get=function(e){var t=Fancy.get(e);if(t.dom){var n=t.select("."+Fancy.GRID_CLS).item(0);if(n.dom){var i=n.dom.id;return Fancy.getWidget(i)}}},FancyGrid.defineTheme=Fancy.defineTheme,FancyGrid.defineController=Fancy.defineController,FancyGrid.addValid=Fancy.addValid,!Fancy.nojQuery&&Fancy.$&&(Fancy.$.fn.FancyGrid=function(e){return this.selector?e.renderTo=$(this.selector)[0].id:e.renderTo=this.attr("id"),new Fancy.Grid(e)}),aT=Fancy,aT.define("Fancy.grid.plugin.RowHeight",{extend:aT.Plugin,ptype:"grid.rowheight",inWidgetName:"rowheight",cellTip:"{value}",stopped:!0,constructor:function(){this.Super("const",arguments),this.rows={}},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var e=this,t=e.widget;t.on("init",e.onInit,e),t.on("update",e.onUpdate,e),t.on("columnresize",e.onColumnResize,e),t.on("changepage",e.onChangePage,e),t.on("sort",e.onSort,e)},onInit:function(){var e=this,t=e.widget;setTimeout(function(){t.scroller.update(e.totalHeight)},50)},onUpdate:function(){var o=this,s=o.widget,e=s.getDataView(),r=0;aT.each(e,function(e){var t=e.id,n=o.rows[t],i=s.getRowById(t),a=s.getDomRow(i);aT.each(a,function(e){aT.get(e).css("height",n)}),r+=n}),o.totalHeight=r,s.grouping&&(o.totalHeight+=s.grouping.getGroupRowsHeight()),setTimeout(function(){s.setSidesHeight(o.totalHeight),s.scroller.update(o.totalHeight)},50)},add:function(e,t){this.rows[e]&&this.rows[e]>t||(this.rows[e]=t)},getRowsHeight:function(e){var n=this,i=0;return aT.each(e,function(e){var t=e.get("id");i+=n.rows[t]}),i},onColumnResize:function(e,t){var n=this;n.rows={},"text"===t.column.type&&t.column.autoHeight&&setTimeout(function(){n.widget.update(),n.onUpdate()},400)},onChangePage:function(e,t){this.rows={}},onSort:function(e,t){this.rows={}}}),NT=Fancy,PT=NT.TOOLTIP_CLS,QT=NT.TOOLTIP_INNER_CLS,NT.define("Fancy.grid.plugin.CellTip",{extend:NT.Plugin,ptype:"grid.celltip",inWidgetName:"celltip",cellTip:"{value}",stopped:!0,constructor:function(){this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var e=this,t=e.widget,n=NT.get(document);t.on("cellenter",e.onCellEnter,e),t.on("cellleave",e.onCellLeave,e),n.on("touchend",e.onTouchEnd,e),n.on("mousemove",e.onDocMove,e)},onCellEnter:function(e,t){var n=t.column,i=this.cellTip,a=t.e;if(n.cellTip){if(NT.isString(n.cellTip))i=n.cellTip;else if(NT.isFunction(n.cellTip)&&!1===(i=n.cellTip(t)))return;var o=new NT.Template(i),s={title:n.title,value:t.value,columnIndex:0,rowIndex:0};this.stopped=!1,NT.apply(s,t.data),NT.tip.update(o.getHTML(s)),NT.tip.show(a.pageX+15,a.pageY-25)}},onCellLeave:function(){this.stopped=!0,NT.tip.hide(500)},onTouchEnd:function(){this.stopped=!0,NT.tip.hide(500)},onDocMove:function(e){if(!0!==this.stopped){var t=this.widget;if("none"===t.el.css("display")||t.panel&&t.panel.el&&"none"===t.panel.el.css("display"))return this.stopped=!0,void NT.tip.hide(500);var n=NT.get(e.target);return"body"===n.prop("tagName").toLocaleLowerCase()?(this.stopped=!0,void NT.tip.hide(500)):n.hasClass(PT)||n.hasClass(QT)||!1!==t.el.within(n)?void NT.tip.show(e.pageX+15,e.pageY-25):(this.stopped=!0,void NT.tip.hide(500))}}}),lU=Fancy,nU=lU.TOOLTIP_CLS,oU=lU.TOOLTIP_INNER_CLS,lU.define("Fancy.grid.plugin.HeaderCellTip",{extend:lU.Plugin,ptype:"grid.headercelltip",inWidgetName:"headercelltip",cellTip:"{title}",stopped:!0,constructor:function(){this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var e=this,t=e.widget,n=lU.get(document);t.on("headercellenter",e.onCellEnter,e),t.on("headercellleave",e.onCellLeave,e),n.on("touchend",e.onTouchEnd,e),n.on("mousemove",e.onDocMove,e)},onCellEnter:function(e,t){var n=t.column,i=this.cellTip,a=t.e;if(n.headerCellTip){var o={title:n.title,columnIndex:t.columnIndex,side:t.side};if(lU.isString(n.headerCellTip))i=n.headerCellTip;else if(lU.isFunction(n.headerCellTip)&&(t.data=o,!1===(i=n.headerCellTip(t))))return;var s=new lU.Template(i);this.stopped=!1,lU.apply(o,t.data),lU.tip.update(s.getHTML(o)),lU.tip.show(a.pageX+15,a.pageY-25)}},onCellLeave:function(){this.stopped=!0,lU.tip.hide(500)},onTouchEnd:function(){this.stopped=!0,lU.tip.hide(500)},onDocMove:function(e){if(!0!==this.stopped){var t=this.widget;if("none"===t.el.css("display")||t.panel&&t.panel.el&&"none"===t.panel.el.css("display"))return this.stopped=!0,void lU.tip.hide(500);var n=lU.get(e.target);return"body"===n.prop("tagName").toLocaleLowerCase()?(this.stopped=!0,void lU.tip.hide(500)):n.hasClass(nU)||n.hasClass(oU)||!1!==t.el.within(n)?void lU.tip.show(e.pageX+15,e.pageY-25):(this.stopped=!0,void lU.tip.hide(500))}}}),LU=Fancy,MU=LU.TOOLTIP_CLS,NU=LU.TOOLTIP_INNER_CLS,LU.define("Fancy.ToolTip",{extend:LU.Widget,constructor:function(){this.Super("const",arguments)},init:function(){this.initTpl(),this.render(),this.ons()},tpl:['<div class="'+NU+'">{text}</div>'],widgetCls:MU,cls:"",extraCls:"",render:function(){var e=this,t=LU.get(e.renderTo||document.body).dom,n=LU.get(document.createElement("div"));n.addCls(LU.cls,e.widgetCls,e.cls,e.extraCls),n.update(e.tpl.getHTML({text:e.text})),e.el=LU.get(t.appendChild(n.dom))},show:function(e,t){var n=this;n.timeout&&(clearInterval(n.timeout),delete n.timeout),"none"===n.css("display")&&n.css({display:"block"}),n.css({left:e,top:t})},hide:function(e){var t=this;t.timeout&&(clearInterval(t.timeout),delete t.timeout),e?t.timeout=setTimeout(function(){t.el.hide()},e):t.el.hide()},destroy:function(){this.el.destroy()},update:function(e){this.el.select("."+NU).update(e)},ons:function(){this.el.on("mouseenter",this.onMouseEnter,this)},onMouseEnter:function(e){this.hide(500)}}),LU.tip={update:function(e){LU.tip=new LU.ToolTip({text:e})},show:function(e,t){LU.tip=new LU.ToolTip({text:" "}),LU.tip.show(e,t)},hide:function(){LU.tip=new LU.ToolTip({text:" "})}},Fancy.enableCompo=function(){function e(){if(0!==v)for(var e in C){var o,s,t=C[e],n=m.querySelectorAll(e),r=t.appPreSelector?t.appPreSelector+"-":"data-",l=t.preSelector?t.preSelector+"-":"fancy-",i=0,a=n.length;if(0===n.length)return;for(;i<a;i++){var c={},d=n[i],u=d.id||"rand-id-"+ +new Date,h=d.attributes;for(o=0,s=h.length;o<s;o++){var p=h[o],f=p.name,y=p.value;new RegExp(r).test(f)&&(y=g(y),c[f.replace(r,"")]=y)}!function(){var e=d.getElementsByTagName("*");for(o=0,s=e.length;o<s;o++){var t,n,i=e[o],a=i.tagName.toLowerCase();new RegExp(l).test(a)&&(t=a.replace(l,""),n=g(i.innerHTML),c[t.replace(r,"")]=n)}}(),d.outerHTML='<div id="'+u+'"></div>',t.init(m.getElementById(u),c)}}}function g(e){return e=/\[/.test(e)||/\{/.test(e)?(e=e.replace(/\n/g,""),new Function("return "+e+";")()):isNaN(Number(e))?e.replace(/\n/g,""):Number(e)}var t,m=document,v=0,C={};Fancy.Component=function(e,t){v++,C[e]=t},Fancy.stopWatch=function(){clearInterval(t)},e(),m.addEventListener("DOMContentLoaded",function(){e()}),setTimeout(function(){e()},1),t=setInterval(function(){e()},250),Fancy.Component("fancy-grid",{preSelector:"fancy",attrPreSelector:"data",init:function(e,t){t.renderTo=e,window[e.id]=new FancyGrid(t)}}),Fancy.Component("fancy-form",{preSelector:"fancy",attrPreSelector:"data",init:function(e,t){t.renderTo=e,window[e.id]=new FancyForm(t)}}),Fancy.Component("fancy-tab",{preSelector:"fancy",attrPreSelector:"data",init:function(e,t){t.renderTo=e,window[e.id]=new FancyTab(t)}})},Fancy});
//# sourceMappingURL=fancy.min.js.map
